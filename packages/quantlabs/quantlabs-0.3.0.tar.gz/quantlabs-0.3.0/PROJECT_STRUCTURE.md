# QuantLab Project Structure

## Directory Layout

```
quantlab/
â”œâ”€â”€ README.md                           # Main project documentation
â”œâ”€â”€ .gitignore                          # Git ignore configuration
â”œâ”€â”€ PROJECT_STRUCTURE.md                # This file
â”‚
â”œâ”€â”€ config/                             # System configuration
â”‚   â””â”€â”€ system_profile.yaml             # Qlib system settings
â”‚
â”œâ”€â”€ configs/                            # Workflow configurations â­
â”‚   â”œâ”€â”€ lightgbm_external_data.yaml     # Full universe (14,310 stocks)
â”‚   â”œâ”€â”€ lightgbm_fixed_dates.yaml       # 2024 only (date filtered)
â”‚   â””â”€â”€ lightgbm_liquid_universe.yaml   # Filtered universe (13,187 stocks)
â”‚
â”œâ”€â”€ data/                               # Local data storage
â”‚   â”œâ”€â”€ parquet/                        # Raw parquet data files
â”‚   â””â”€â”€ metadata/                       # Metadata and cache
â”‚
â”œâ”€â”€ docs/                               # Documentation ğŸ“š
â”‚   â”œâ”€â”€ BACKTEST_SUMMARY.md             # Comprehensive backtest analysis
â”‚   â”œâ”€â”€ ALPHA158_SUMMARY.md             # Alpha158 features overview
â”‚   â”œâ”€â”€ ALPHA158_CORRECTED.md           # Alpha158 corrections guide
â”‚   â”œâ”€â”€ USE_QLIB_ALPHA158.md            # How to use Alpha158
â”‚   â””â”€â”€ QUANTMINI_README.md             # QuantMini data setup
â”‚
â”œâ”€â”€ notebooks/                          # Jupyter notebooks ğŸ““
â”‚   â””â”€â”€ workflow_by_code.ipynb          # Qlib workflow examples
â”‚
â”œâ”€â”€ results/                            # Experiment outputs ğŸ“Š
â”‚   â”œâ”€â”€ mlruns/                         # MLflow experiment tracking
â”‚   â”‚   â””â”€â”€ 489214785307856385/         # Experiment ID
â”‚   â”‚       â”œâ”€â”€ 2b374fe2956c4161a1bd2dcef7299bd2/  # Liquid universe run
â”‚   â”‚       â”œâ”€â”€ 44c320f998cf4c97a8be68ed15857f66/  # Fixed dates run
â”‚   â”‚       â””â”€â”€ dc38cbc355104d67a1917a3f358ceb1f/  # Original run
â”‚   â””â”€â”€ visualizations/                 # Charts and plots
â”‚       â””â”€â”€ backtest_visualization.png  # Latest backtest chart
â”‚
â”œâ”€â”€ scripts/                            # Utility scripts ğŸ”§
â”‚   â”œâ”€â”€ analysis/                       # Analysis tools
â”‚   â”‚   â””â”€â”€ visualize_results.py        # Backtest visualization script
â”‚   â”œâ”€â”€ data/                           # Data processing
â”‚   â”‚   â”œâ”€â”€ convert_to_qlib.py          # Convert data to qlib format
â”‚   â”‚   â”œâ”€â”€ quantmini_setup.py          # Setup QuantMini data
â”‚   â”‚   â””â”€â”€ refresh_today_data.py       # Update latest data
â”‚   â””â”€â”€ tests/                          # Test scripts
â”‚       â”œâ”€â”€ test_qlib_alpha158.py       # Test Alpha158 features
â”‚       â”œâ”€â”€ test_stocks_minute_fix.py   # Test data fixes
â”‚       â””â”€â”€ enable_alpha158.py          # Enable Alpha158 handler
â”‚
â”œâ”€â”€ qlib_repo/                          # Microsoft Qlib source (828MB)
â”‚   â””â”€â”€ (Full qlib repository clone)
â”‚
â””â”€â”€ .venv/                              # Virtual environment (uv)
    â””â”€â”€ (Python packages)
```

## Key Directories

### ğŸ“ configs/
Workflow configuration files for different backtesting scenarios.

**Usage:**
```bash
cd qlib_repo/examples
uv run qrun ../../configs/lightgbm_liquid_universe.yaml
```

### ğŸ“Š results/
All experiment outputs including MLflow tracking and visualizations.

**MLflow runs:**
- Each run has a unique ID
- Contains: model, predictions, portfolio analysis, metrics

**Visualizations:**
- Generated by `scripts/analysis/visualize_results.py`
- Charts showing IC, returns, drawdown

### ğŸ”§ scripts/
Organized utility scripts by function.

**data/** - Data processing and setup
**analysis/** - Result visualization and analysis
**tests/** - Testing and validation scripts

### ğŸ“š docs/
Comprehensive documentation of findings and guides.

**Key documents:**
- `BACKTEST_SUMMARY.md` - Most important - full analysis
- `ALPHA158_SUMMARY.md` - Feature documentation
- `USE_QLIB_ALPHA158.md` - Implementation guide

## External Data Location

```
/Volumes/sandisk/quantmini-data/data/qlib/stocks_daily/
â”œâ”€â”€ calendars/
â”‚   â””â”€â”€ day.txt                         # 442 trading days (2024-2025)
â”œâ”€â”€ instruments/
â”‚   â”œâ”€â”€ all.txt                         # 14,310 total instruments
â”‚   â””â”€â”€ liquid_stocks.txt               # 13,187 filtered instruments
â””â”€â”€ features/                           # OHLCV price data
    â””â”€â”€ [stock symbols]/
```

## File Sizes

| Component | Size | Notes |
|-----------|------|-------|
| qlib_repo/ | 828MB | Full Microsoft Qlib clone |
| .venv/ | ~500MB | Python virtual environment |
| results/mlruns/ | ~150MB | All experiment runs |
| External data | ~2GB | On /Volumes/sandisk |

## Ignored Files (.gitignore)

- `qlib_repo/` - Large clone, can be re-downloaded
- `.venv/` - Virtual environment
- `data/parquet/` - Raw data files
- `__pycache__/`, `*.pyc` - Python cache
- `*.log` - Log files

## Quick Commands

### Run a backtest
```bash
cd qlib_repo/examples
uv run qrun ../../configs/lightgbm_liquid_universe.yaml
```

### Visualize results
```bash
# Update experiment ID in scripts/analysis/visualize_results.py
cd /path/to/quantlab
uv run python scripts/analysis/visualize_results.py
```

### Test Alpha158
```bash
python scripts/tests/test_qlib_alpha158.py
```

### Refresh data
```bash
python scripts/data/refresh_today_data.py
```

## Configuration Files

### configs/lightgbm_liquid_universe.yaml
```yaml
qlib_init:
    provider_uri: "/Volumes/sandisk/quantmini-data/data/qlib/stocks_daily"
    region: cn

market: &market liquid_stocks  # Uses filtered universe
benchmark: &benchmark SPY

task:
    model:
        class: LGBModel
        # ... LightGBM parameters
    dataset:
        class: DatasetH
        # ... dataset configuration
```

## Notes

- All scripts should be run from project root
- Paths are relative to project root
- External data must be mounted at `/Volumes/sandisk`
- MLflow tracks all experiments automatically

## Recent Changes

âœ… Reorganized from flat structure to organized directories
âœ… Moved all docs to `docs/`
âœ… Separated scripts by function
âœ… Centralized configs in `configs/`
âœ… Moved MLflow results to `results/`
âœ… Added comprehensive README.md
âœ… Created .gitignore for large files
