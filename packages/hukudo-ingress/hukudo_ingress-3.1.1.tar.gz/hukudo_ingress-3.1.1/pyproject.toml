[build-system]
requires = ["uv_build"]
build-backend = "uv_build"

[project]
name = "hukudo-ingress"
version = "3.1.1"
requires-python = ">= 3.11"
authors = [{ name = "hukudo GmbH", email = "hukudo-ingress@hukudo.de" }]
classifiers = ["Programming Language :: Python :: 3"]
urls = { Homepage = "https://gitlab.com/hukudo/ingress" }
dependencies = [
    "backoff",
    "click",
    "docker",
    "httpx",
    "ipython",
    "jinja2",
    "logfmter",
]
readme = "README.md"
license-files = ["LICENSE"]

[dependency-groups]
dev = [
    "uv-build>=0.8.4",
    "bump-my-version>=1.2.1",
    "pytest-cov>=5.0.0",
    "pytest>=8.3.3",
    "ruff>=0.7.1",
    "twine>=5.1.1",
    "ty>=0.0.1a16",
]

[project.entry-points]

[project.scripts]
ingress = "ingress.cli:root"

[tool.uv.build-backend]
module-name = "ingress"

[tool.mypy]
exclude = "build"
# ignore missing types in docker

[[tool.mypy.overrides]]
module = ["docker.*"]
ignore_missing_imports = true

[tool.ruff]
# see also .editorconfig
line-length = 120

[tool.ruff.format]
quote-style = "single"

[tool.pyright]
typeCheckingMode = "basic" # basedpyright less strict

[tool.bumpversion]
current_version = "3.1.1"
parse = "(?P<major>\\d+)\\.(?P<minor>\\d+)\\.(?P<patch>\\d+)"
serialize = ["{major}.{minor}.{patch}"]
search = "{current_version}"
replace = "{new_version}"
regex = false
ignore_missing_version = false
ignore_missing_files = false
tag = true
sign_tags = true
tag_name = "v{new_version}"
tag_message = "Bump version: {current_version} → {new_version}"
allow_dirty = false
commit = true
message = "Bump version: {current_version} → {new_version}"
moveable_tags = []
commit_args = ""
setup_hooks = []
# https://www.andrlik.org/dispatches/til-bump-my-version-uv/
pre_commit_hooks = ["uv sync", "git add uv.lock"]
post_commit_hooks = []
