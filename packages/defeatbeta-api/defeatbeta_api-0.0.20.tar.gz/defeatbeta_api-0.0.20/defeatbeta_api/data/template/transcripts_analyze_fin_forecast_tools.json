[
  {
    "type": "function",
    "function": {
      "name": "extract_metrics",
      "description": "Return a JSON object containing an array of extracted financial metrics and their qualitative change descriptions.",
      "parameters": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "original_metrics": {
            "type": "array",
            "additionalProperties": false,
            "description": "Based on the transcript of this earnings call, perform an extraction of the original metrics.",
            "items": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Metric name"
                },
                "outlook": {
                  "type": "string",
                  "description": "The outlook field should reflect the wording from management’s statement, along with the specific numerical figures (e.g., percentages, basis points, or monetary amounts) describing future projections, guidance, outlook or forecasts."
                },
                "speaker": {
                  "type": "string",
                  "description": "Name of the speaker who mentioned the metric."
                },
                "paragraph_number": {
                  "type": ["integer"],
                  "description": "Paragraph number in the transcript where the metric is discussed."
                }
              },
              "required": ["name", "outlook", "speaker", "paragraph_number"]
            }
          },
          "processed_metrics": {
            "type": "array",
            "additionalProperties": false,
            "description": "Infer the `attitude`, and `reason` based on the `original_metrics`. `processed_metrics` array **must ensure a strict one-to-one correspondence** with the `original_metrics` array",
            "items": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Copy the `name` field from the corresponding `original_metrics` item exactly (this ensures matching)."
                },
                "attitude": {
                  "type": "string",
                  "enum": ["optimistic", "pessimistic", "neutral"],
                  "description": "Based on the extracted `outlook` from the `original_metrics`, infer the management’s `attitude` of this forecast (\"optimistic\", \"pessimistic\", or \"neutral\")."
                },
                "reason": {
                  "type": "string",
                  "description": "Based on the extracted `outlook` from the `original_metrics`, infer the `reason` behind this outlook. The reason should be derived from the full transcript and use management’s own wording. If management does not mention any reason, return an empty string."
                }
              },
              "required": ["name", "attitude", "reason"]
            }
          }
        },
        "required": ["original_metrics", "processed_metrics"]
      }
    }
  }
]
