<form id='search_form' class='form-search form-inline' method='GET' accept-charset="utf-8" i18n:domain="deform">

    <input type="hidden" name="_charset_" />
    <input type="hidden" name="__formid__" value="${field.formid}"/>

    <tal:for tal:repeat="item field.children" tal:define="rndr field.renderer; tmpl field.widget.item_template;">
        <tal:code 
          tal:define="not_wrapped item.widget.template not in ('textinput', 'dateinput', 'deform_extensions:templates/datetimeinput',);
                      item_css item_css|string: ${getattr(item.schema, 'is_range', False) and 'range' or ''};
                      is_checkbox item.widget.template == 'checkbox';
                      is_daterange item.name == 'date_range'" >       
            <div tal:condition="item.title and not item.widget.hidden and not is_checkbox and not is_daterange" class='form-group ${item_css}'>
                <label tal:condition="item.title and not item.widget.hidden" tal:content="item.title" for="${item.oid}" />
                <div tal:replace="structure item.serialize()" />
                <span tal:condition="item.description and not item.widget.hidden" tal:content="item.description" class='help-block' />
            </div>
            <div tal:condition="not item.title and not item.widget.hidden and not is_checkbox and not is_daterange" class='form-group ${item_css}'>
                <label tal:condition="item.title and not item.widget.hidden" tal:content="item.title" for="${item.oid}" />
                <div tal:replace="structure item.serialize()" />
                <span tal:condition="item.description and not item.widget.hidden" tal:content="item.description" class='help-block' />
            </div>
            <div tal:condition="is_checkbox" class='form-group ${item_css}'>
                <div class="wrapped">
                    <div tal:replace="structure item.serialize()" />
                    <span tal:condition="item.description and not item.widget.hidden" tal:content="item.description" class='help-block' />
                </div>
            </div>
            <tal:code tal:condition="is_daterange">
                <div tal:replace="structure item.serialize()" />
            </tal:code>
        </tal:code>
    </tal:for>

    <div>
      <tal:loop tal:repeat="button field.buttons">
        <button
              tal:define="btn_disposition repeat.button.start and 'btn-primary' or 'btn-default';
              btn_icon button.icon|None"
              tal:attributes="disabled button.disabled if button.disabled else None"
              id="${field.formid+button.name}"
              name="${button.name}"
              type="${button.type}"
              class="btn ${button.css_class or btn_disposition}"
              value="${button.value}"
              title="${button.title}">
            <svg tal:condition="btn_icon"><use href="${request.static_url('caerp:static/icons/icones.svg')}#${btn_icon}"></use></svg>
            <span tal:condition="btn_icon" class="screen-reader-text">${button.title}</span>
            <span tal:condition="not btn_icon">${button.title}</span>
        </button>
      </tal:loop>
    </div>

</form>
