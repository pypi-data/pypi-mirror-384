<div tal:define="error_class ('has-error-grid' and field.typ.__class__.__name__=='Sequence') or 'has-error';
                 description description|field.description;
                 title title|field.title;
                 oid oid|field.oid;
                 hidden hidden|field.widget.hidden;
                 category category|field.widget.category;
                 structural hidden or category == 'structural';
                 required required|field.required;
                 template_type template_type|field.typ.__class__.__name__;
                 "
    class="form-group ${template_type} mapping_item ${field.error and error_class or ''} ${field.widget.item_css_class or ''} ${field.default_item_css_class()}"
    id="item-${oid}"
    tal:omit-tag="structural"
    i18n:domain="deform">

    <label tal:condition="not (hidden or category == 'structural' or field.widget.template == 'checkbox' or field.widget.template == 'checkbox_readonly.pt') and not( field.typ.__class__.__name__=='Boolean') and ( field.required )"
        class="control-label ${field.required and 'required'}"
        title="Champ obligatoire"
        for="${oid}"
        >
        <svg class="error"><use href="${request.static_url('caerp:static/icons/icones.svg')}#exclamation-triangle"></use></svg>
        <span>${title}</span>
        <span tal:condition="field.description" class="screen-reader-text"> ${description}</span>
        <span
            class="icon required"
            id="req-${oid}"
            >
                <svg><use href="${request.static_url('caerp:static/icons/icones.svg')}#required"></use></svg>
                <span><span class="screen-reader-text">Champ</span> Obligatoire</span>
        </span>
    </label>

    <label tal:condition="not (hidden or category == 'structural' or field.widget.template == 'checkbox' or field.widget.template == 'checkbox_readonly.pt') and not( field.typ.__class__.__name__=='Boolean') and not ( field.required )"
        class="control-label"
        title="${description}"
        for="${oid}"
        >
        <svg class="error"><use href="${request.static_url('caerp:static/icons/icones.svg')}#exclamation-triangle"></use></svg>
        <span>${title}</span>
        <span class="screen-reader-text"> ${description}</span>
    </label>

    <div tal:define="input_prepend field.widget.input_prepend | None;
                     input_append field.widget.input_append  | None"
        tal:omit-tag="not (input_prepend or input_append)"
        class="input-group">
        <span class="input-group-addon"
            tal:condition="input_prepend">${input_prepend}</span>
        <span tal:replace="structure field.serialize(cstruct).strip()" />
        <span class="input-group-addon"
            tal:condition="input_append">${input_append}</span>
    </div>

    <p tal:condition="field.description and not field.widget.hidden"
        class="help-block" >
        ${structure:field.description}
    </p>

    <p tal:condition="field.error and not field.widget.hidden and not field.typ.__class__.__name__=='Mapping'"
        tal:define="errstr 'error-%s' % field.oid"
        tal:repeat="msg field.error.messages()"
        i18n:translate=""
        tal:attributes="id repeat.msg.index==0 and errstr or ('%s-%s' % (errstr, repeat.msg.index))"
        class="help-block error-message"
        >
        ${msg}
    </p>
</div>
