{"version":3,"file":"task_payment.js","mappings":"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ACC;AACL;;AAE7E,CAAsF;AACtF,iCAAiC,yFAAe,CAAC,oGAAM,aAAa,2FAAM;AAC1E;AACA,IAAI,KAAU,EAAE,EAYf;;;AAGD,iEAAe;;;;;;;;;;;;;;;ACtB2L;;;;;;;;;;;;;;;ACAQ;;;;;;;;;;;;;;;ACAS;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UIA3N;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;UAEA;UACA;;;;;WC5BA;WACA;WACA;WACA;WACA,+BAA+B,wCAAwC;WACvE;WACA;WACA;WACA;WACA,iBAAiB,qBAAqB;WACtC;WACA;WACA,kBAAkB,qBAAqB;WACvC;WACA;WACA,KAAK;WACL;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;;;;;WC3BA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,sDAAsD;WACtD,sCAAsC,iEAAiE;WACvG;WACA;WACA;WACA;WACA;WACA;;;;;WCzBA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;WACA;WACA;WACA;;;;;WCHA;WACA;WACA;WACA;WACA,GAAG;WACH;WACA;WACA,CAAC;;;;;WCPD;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;WCNA;WACA;WACA;WACA;WACA;;;;;WCJA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;;;;;WClBA;;WAEA;WACA;WACA;WACA;WACA;WACA;;WAEA;;WAEA;;WAEA;;WAEA;;WAEA;;WAEA;;WAEA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,MAAM,qBAAqB;WAC3B;WACA;WACA;WACA;WACA;WACA;WACA;WACA;;WAEA;WACA;WACA;;;;;WChDA;;;;;UEAA;UACA;UACA;UACA;UACA","sources":["webpack://enDI/./src/views/task/payment/App.vue","webpack://enDI/./src/views/task/payment/PaymentForm.vue","webpack://enDI/./src/views/task/payment/PaymentFormComponent.vue","webpack://enDI/./src/stores/taskPayment.js","webpack://enDI/./src/views/task/payment.js","webpack://enDI/./src/views/task/payment/App.vue?479b","webpack://enDI/./src/views/task/payment/PaymentForm.vue?5c28","webpack://enDI/./src/views/task/payment/PaymentFormComponent.vue?337d","webpack://enDI/./src/views/task/payment/App.vue?1b97","webpack://enDI/./src/views/task/payment/PaymentForm.vue?3be6","webpack://enDI/./src/views/task/payment/PaymentFormComponent.vue?85d4","webpack://enDI/./src/views/task/payment/App.vue?003a","webpack://enDI/./src/views/task/payment/PaymentForm.vue?ceee","webpack://enDI/./src/views/task/payment/PaymentFormComponent.vue?66d8","webpack://enDI/webpack/bootstrap","webpack://enDI/webpack/runtime/chunk loaded","webpack://enDI/webpack/runtime/compat get default export","webpack://enDI/webpack/runtime/create fake namespace object","webpack://enDI/webpack/runtime/define property getters","webpack://enDI/webpack/runtime/ensure chunk","webpack://enDI/webpack/runtime/global","webpack://enDI/webpack/runtime/hasOwnProperty shorthand","webpack://enDI/webpack/runtime/make namespace object","webpack://enDI/webpack/runtime/node module decorator","webpack://enDI/webpack/runtime/publicPath","webpack://enDI/webpack/runtime/jsonp chunk loading","webpack://enDI/webpack/runtime/nonce","webpack://enDI/webpack/before-startup","webpack://enDI/webpack/startup","webpack://enDI/webpack/after-startup"],"sourcesContent":["<script setup>\n  import { ref } from 'vue'\n  import PaymentFormComponent from './PaymentFormComponent.vue'\n  import { collectOptions } from '@/helpers/context'\n\n  // Get options from the global window object, similar to other App components\n  const options = collectOptions()\n\n  // Redirect functions similar to other App components\n  const redirectOnsave = (payment) => {\n    console.log('Redirectonsave')\n    if (opener) {\n      opener.dismissPopup(window, { force_reload: true })\n    } else if (options.redirect_url) {\n      window.location.href = options.redirect_url\n    } else {\n      window.location.href = options.context_url.replace('/api/v1/', '/')\n    }\n  }\n\n  const redirectOnCancel = () => {\n    console.log('Redirectoncancel')\n    if (opener) {\n      opener.dismissPopup(window, { force_reload: true })\n    } else if (options.cancel_url) {\n      window.location.href = options.cancel_url\n    } else {\n      window.location.href = options.context_url.replace('/api/v1/', '/')\n    }\n  }\n</script>\n\n<template>\n  <Suspense>\n    <div class=\"limited_width width60\">\n      <PaymentFormComponent\n        :item-id=\"options.payment_id\"\n        :invoice-id=\"options.invoice_id\"\n        :url=\"options.context_url\"\n        :form-config-url=\"options.form_config_url\"\n        @saved=\"redirectOnsave\"\n        @cancel=\"redirectOnCancel\"\n      />\n    </div>\n    <template #fallback> Chargement... </template>\n  </Suspense>\n</template>\n","<script setup>\n    import { ref, computed } from 'vue'\n    import { useForm } from 'vee-validate'\n\n    import DebugContent from '@/components/DebugContent.vue'\n    import {\n        getDefaults,\n        buildYupSchema,\n        getFieldData,\n        getSubmitErrorCallback,\n        getSubmitModelCallback,\n    } from '@/helpers/form'\n    import {\n        usePaymentConfigStore,\n        usePaymentStore,\n    } from '@/stores/taskPayment'\n    import Input from '@/components/forms/Input.vue'\n    import Select from '@/components/forms/Select.vue'\n    import { scrollToBottom, strToAmount } from '@/helpers/utils'\n    import BooleanCheckbox from '@/components/forms/BooleanCheckbox.vue'\n\n    const props = defineProps({\n        invoice: { type: Object, required: true },\n        item: { type: [Object, null, undefined], required: false },\n        layout: { type: Object },\n    })\n    const emit = defineEmits(['saved', 'cancel', 'error'])\n\n    const debug = DEBUG\n    const configStore = usePaymentConfigStore()\n    const dataStore = usePaymentStore()\n\n    const formSchema = computed(() => {\n        const jsonSchema = configStore.getSchema('default')\n        console.log('Json Schema')\n        console.log(jsonSchema)\n        return buildYupSchema(jsonSchema)\n    })\n    const initialValues = computed(() => {\n        const result = getDefaults(formSchema.value)\n        Object.assign(result, props.item)\n        console.log('InitialValues')\n        console.log(result)\n        return result\n    })\n    const showConfirmAmount = ref(false)\n    const showConfirmRemittance = ref(false)\n\n    const modeOptions = computed(() => configStore.getOptions('payment_modes'))\n    const bankAccountOptions = computed(() =>\n        configStore.getOptions('bank_accounts')\n    )\n    const customerBankOptions = computed(() =>\n        configStore.getOptions('customer_bank_accounts')\n    )\n    const maxAmount = computed(() => configStore.getOptions('max_amount'))\n\n    // Formulaire vee-validate (se met à jour automatiquement en fonction du schéma)\n    const { values, handleSubmit, isSubmitting } = useForm({\n        validationSchema: formSchema,\n        initialValues: initialValues,\n    })\n\n    // Process standard de sauvegarde d'un élement\n    const onSubmitSuccess = getSubmitModelCallback(emit, dataStore.savePayment)\n    // On wrappe la sauvegarde de l'élément et on intercale un appel pour tester\n    // la remise en banque\n    const submitWrapper = async (values, actions) => {\n        if (\n            values.bank_remittance_id &&\n            values.bank_remittance_id.trim().length > 0 &&\n            !values.new_remittance_confirm\n        ) {\n            let validation\n            try {\n                validation = await dataStore.checkRemittanceId(values)\n            } catch (error) {\n                validation = error\n            }\n            console.log(validation)\n            if (validation.errors && validation.errors.length > 0) {\n                actions.setErrors(validation.errors)\n                return\n            } else if (validation.status == 'confirmation') {\n                if (validation.data.field == 'bank_remittance_id') {\n                    showConfirmRemittance.value = true\n                    scrollToBottom()\n                    return\n                }\n            }\n        }\n        return onSubmitSuccess(values, actions)\n    }\n\n    const onSubmitError = getSubmitErrorCallback(emit)\n    const onSubmit = handleSubmit(submitWrapper, onSubmitError)\n    const onCancel = () => emit('cancel')\n    const getData = computed(\n        () => (fieldName) => getFieldData(formSchema.value, fieldName)\n    )\n\n    const onAmountChange = (value) => {\n        const amount_value = strToAmount(value)\n        if (Math.abs(amount_value) > Math.abs(maxAmount.value)) {\n            showConfirmAmount.value = true\n        } else {\n            showConfirmAmount.value = false\n        }\n    }\n    const Layout = props.layout\n</script>\n<template>\n    <Layout @submit-form=\"onSubmit\" @close=\"onCancel\">\n        <template #title>\n            <template v-if=\"item.id\"> Modifier un encaissement </template>\n            <template v-else> Ajouter un encaissement </template>\n        </template>\n\n        <template #fields>\n            <div>\n                <fieldset class=\"deformFormFieldset\">\n                    <div class=\"row form-row\">\n                        <Input\n                            v-bind=\"getData('date')\"\n                            class=\"col-md-6\"\n                            :autofocus=\"true\"\n                        />\n                    </div>\n                    <div class=\"row form-row\">\n                        <Select\n                            v-if=\"formSchema.fields.mode\"\n                            class=\"col-md-6\"\n                            v-bind=\"getData('mode')\"\n                            :add-default=\"false\"\n                            :options=\"modeOptions\"\n                        />\n                        <Input\n                            v-bind=\"getData('amount')\"\n                            class=\"col-md-6\"\n                            @change-value=\"onAmountChange\"\n                        />\n                    </div>\n                    <div v-if=\"showConfirmAmount\" class=\"row form-row\">\n                        <div class=\"col-md-12 text-center\">\n                            <div class=\"alert alert-warning\">\n                                Le montant est supérieur au montant attendu pour\n                                le règlement de cette facture. Cochez la case\n                                ci-dessous pour confirmer la saisie.\n                            </div>\n                            <BooleanCheckbox\n                                v-bind=\"getData('confirm_amount')\"\n                                class=\"col-md-6\"\n                            />\n                        </div>\n                    </div>\n                    <div\n                        v-if=\"\n                            formSchema.fields.bank_remittance_id ||\n                            formSchema.fields.bank_id\n                        \"\n                        class=\"row form-row\"\n                    >\n                        <Input\n                            v-if=\"formSchema.fields.bank_remittance_id\"\n                            class=\"col-md-6\"\n                            v-bind=\"getData('bank_remittance_id')\"\n                        />\n\n                        <Select\n                            v-if=\"formSchema.fields.bank_id\"\n                            class=\"col-md-6\"\n                            v-bind=\"getData('bank_id')\"\n                            :add-default=\"false\"\n                            :options=\"bankAccountOptions\"\n                        />\n                    </div>\n\n                    <div\n                        v-if=\"formSchema.fields.check_number\"\n                        class=\"row form-row\"\n                    >\n                        <Input\n                            v-bind=\"getData('check_number')\"\n                            class=\"col-md-6\"\n                        />\n                    </div>\n                    <div\n                        v-if=\"\n                            formSchema.fields.customer_bank_id ||\n                            formSchema.fields.issuer\n                        \"\n                        class=\"row form-row\"\n                    >\n                        <Select\n                            v-if=\"formSchema.fields.customer_bank_id\"\n                            class=\"col-md-6\"\n                            v-bind=\"getData('customer_bank_id')\"\n                            :add-default=\"false\"\n                            :options=\"customerBankOptions\"\n                        />\n\n                        <Input\n                            v-if=\"formSchema.fields.issuer\"\n                            v-bind=\"getData('issuer')\"\n                            class=\"col-md-6\"\n                        />\n                    </div>\n                    <div class=\"row form-row\">\n                        <BooleanCheckbox\n                            v-bind=\"getData('resulted')\"\n                            class=\"col-md-6\"\n                        />\n                    </div>\n                </fieldset>\n            </div>\n        </template>\n        <template #buttons>\n            <template v-if=\"showConfirmRemittance\">\n                <div\n                    ref=\"remittance-confirm-message\"\n                    class=\"alert alert-warning\"\n                >\n                    Vous vous apprêtez à créer une nouvelle remise en banque\n                    <strong>{{ values.bank_remittance_id }}</strong\n                    >.\n                </div>\n                <Input\n                    v-bind=\"getData('new_remittance_confirm')\"\n                    type=\"hidden\"\n                    value=\"true\"\n                    class=\"col-md-6\"\n                />\n                <button\n                    id=\"deformsubmit\"\n                    name=\"submit\"\n                    type=\"submit\"\n                    class=\"btn btn-primary\"\n                    value=\"submit\"\n                    :disabled=\"isSubmitting\"\n                >\n                    Confirmer\n                </button>\n            </template>\n            <template v-else>\n                <button\n                    id=\"deformsubmit\"\n                    name=\"submit\"\n                    type=\"submit\"\n                    class=\"btn btn-primary\"\n                    value=\"submit\"\n                    :disabled=\"isSubmitting\"\n                >\n                    Enregistrer\n                </button>\n            </template>\n            <button\n                id=\"deformcancel\"\n                name=\"cancel\"\n                type=\"button\"\n                class=\"btn btn-default\"\n                @click=\"onCancel\"\n            >\n                Annuler\n            </button>\n            <DebugContent v-if=\"debug\" :debug=\"values\" />\n        </template>\n    </Layout>\n</template>\n","<script setup>\n  /**\n   * Composant pour la saisie et la modification d'un encaissement\n   *\n   * @prop {Number|null} itemId - Identifiant de l'encaissement à modifier\n   * @prop {String} url - Url du contexte cible pour la saisie d'encaissement\n   * @prop {String} formConfigUrl - Url de chargement de la configuration du formulaire\n   * @prop {Object} layout - Composant Layout utilisé pour la saisie d'encaissement\n   *\n   * 1- Charge les informations via form_config\n   * 2- Configure le store de paiement et éventuellement charge l'encaissement en\n   * cours de saisie\n   *\n   */\n  import { ref } from 'vue'\n  import { storeToRefs } from 'pinia'\n\n  import { usePaymentConfigStore, usePaymentStore } from '@/stores/taskPayment'\n  //   import { useConstStore } from '@/stores/const'\n  import FormFlatLayout from '@/layouts/FormFlatLayout.vue'\n  import PaymentForm from './PaymentForm.vue'\n\n  import { formatDate, formatDatetime } from '@/helpers/date'\n  import IconSpan from '@/components/IconSpan.vue'\n\n  //   import CustomerForm from './CustomerForm.vue'\n\n  // props attendu par le composant\n  const props = defineProps({\n    invoiceId: { type: [String, Number], required: true },\n    // L'url où on va submit les données\n    url: { type: String, required: true },\n    // L'url du contexte où on va charger la configuration du formulaire\n    formConfigUrl: { type: String, required: true },\n    itemId: { type: [String, Number, null, undefined], default: null },\n    layout: { type: Object, default: FormFlatLayout },\n  })\n  const emit = defineEmits(['saved', 'cancel'])\n\n  // Préparation du chargement des données\n  const loading = ref(true)\n  const formConfigStore = usePaymentConfigStore()\n  formConfigStore.setUrl(props.formConfigUrl)\n\n  const isEdit = !!props.itemId\n  const dataStore = usePaymentStore()\n\n  async function preload() {\n    const promises = [\n      formConfigStore.loadConfig(),\n      dataStore.setInitialValues({\n        paymentId: props.itemId,\n        invoiceId: props.invoiceId,\n      }),\n    ]\n\n    Promise.all(promises).then(() => (loading.value = false))\n  }\n\n  // Initialisation des éléments utilisés pour initialiser le formulaire\n  const { currentPayment, currentInvoice } = storeToRefs(dataStore)\n\n  function onSaved(item) {\n    console.log('Payment saved')\n    emit('saved', item)\n  }\n  function onCancel() {\n    console.log('Cancel Payment add/edit')\n    emit('cancel')\n  }\n  // Chargement (await toujours en fin de setup)\n  await preload()\n  // Chargement terminé\n</script>\n<template>\n  <div v-if=\"loading\">Chargement des informations</div>\n  <div v-else>\n    <div v-if=\"currentPayment\" class=\"alert alert-info\">\n      Modification de l'encaissement de {{ currentPayment.amount }} € saisi le\n      {{ formatDatetime(currentPayment.created_at) }}\n    </div>\n    <div v-if=\"!currentPayment\" class=\"alert alert-info\">\n      Enregistrer un paiement pour la facture\n      {{ currentInvoice.official_number }}\n      <template v-if=\"currentInvoice.paid_status != 'resulted'\"\n        >dont le montant ttc restant à payer est de\n        {{ currentInvoice.topay_amount }}&nbsp;€</template\n      >\n    </div>\n    <div v-if=\"currentInvoice.topay_amount === 0\" class=\"alert alert-warning\">\n      <IconSpan name=\"warning\" /> La facture\n      {{ currentInvoice.official_number }} est déjà soldée\n    </div>\n    <PaymentForm\n      :item=\"currentPayment\"\n      :invoice=\"currentInvoice\"\n      @saved=\"onSaved\"\n      @cancel=\"onCancel\"\n      :layout=\"layout\"\n    />\n  </div>\n</template>\n","import { ref } from 'vue'\nimport { defineStore } from 'pinia'\nimport api from '@/api'\nimport getFormConfigStore from './formConfig'\n\nexport const usePaymentConfigStore = getFormConfigStore('payment')\n\n\nexport const usePaymentStore = defineStore('payment', () => {\n    const currentPayment = ref(null)\n    const currentPaymentId = ref(null)\n\n    const currentInvoice = ref(null)\n    const currentInvoiceId = ref(null)\n\n    async function setInitialValues({ paymentId, invoiceId }){\n        currentPaymentId.value = paymentId\n        currentInvoiceId.value = invoiceId\n        api.taskPayments.setInvoiceId(currentInvoiceId.value)\n        if (paymentId) {\n            currentPayment.value = await api.taskPayments.load(paymentId)\n        }\n        currentInvoice.value = await api.invoices.load(currentInvoiceId.value)\n\n    }\n    async function savePayment(values){\n        console.log(\"Saving payment ... \", currentPaymentId.value)\n        console.log(values)\n        if (currentPaymentId.value != null) {\n            console.log(\"Updating payment ... \", currentPaymentId.value)\n            await api.taskPayments.update(values, currentPaymentId.value)\n        } else {\n            console.log(\"Creating payment ... \")\n            console.log(api.payments)\n            await api.taskPayments.create(values)\n        }\n    }\n    async function checkRemittanceId(values){\n        console.log(\"Checking remittanceId ... \", values)\n        return await api.taskPayments.checkRemittanceId(values, currentPaymentId.value)\n    }\n    return {\n        currentPayment,\n        currentPaymentId,\n        currentInvoice,\n        currentInvoiceId,\n        setInitialValues,\n        savePayment,\n        checkRemittanceId,\n    }\n})","import { startApp } from '@/helpers/utils'\nimport App from './payment/App.vue'\n\nconst app = startApp(App)\n","import { render } from \"./App.vue?vue&type=template&id=49030608\"\nimport script from \"./App.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./App.vue?vue&type=script&setup=true&lang=js\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__file',\"src/views/task/payment/App.vue\"]])\n/* hot reload */\nif (module.hot) {\n  __exports__.__hmrId = \"49030608\"\n  const api = __VUE_HMR_RUNTIME__\n  module.hot.accept()\n  if (!api.createRecord('49030608', __exports__)) {\n    api.reload('49030608', __exports__)\n  }\n  \n  module.hot.accept(\"./App.vue?vue&type=template&id=49030608\", () => {\n    api.rerender('49030608', render)\n  })\n\n}\n\n\nexport default __exports__","import { render } from \"./PaymentForm.vue?vue&type=template&id=60c58051\"\nimport script from \"./PaymentForm.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./PaymentForm.vue?vue&type=script&setup=true&lang=js\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__file',\"src/views/task/payment/PaymentForm.vue\"]])\n/* hot reload */\nif (module.hot) {\n  __exports__.__hmrId = \"60c58051\"\n  const api = __VUE_HMR_RUNTIME__\n  module.hot.accept()\n  if (!api.createRecord('60c58051', __exports__)) {\n    api.reload('60c58051', __exports__)\n  }\n  \n  module.hot.accept(\"./PaymentForm.vue?vue&type=template&id=60c58051\", () => {\n    api.rerender('60c58051', render)\n  })\n\n}\n\n\nexport default __exports__","import { render } from \"./PaymentFormComponent.vue?vue&type=template&id=70fecb5c\"\nimport script from \"./PaymentFormComponent.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./PaymentFormComponent.vue?vue&type=script&setup=true&lang=js\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__file',\"src/views/task/payment/PaymentFormComponent.vue\"]])\n/* hot reload */\nif (module.hot) {\n  __exports__.__hmrId = \"70fecb5c\"\n  const api = __VUE_HMR_RUNTIME__\n  module.hot.accept()\n  if (!api.createRecord('70fecb5c', __exports__)) {\n    api.reload('70fecb5c', __exports__)\n  }\n  \n  module.hot.accept(\"./PaymentFormComponent.vue?vue&type=template&id=70fecb5c\", () => {\n    api.rerender('70fecb5c', render)\n  })\n\n}\n\n\nexport default __exports__","export { default } from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./App.vue?vue&type=script&setup=true&lang=js\"; export * from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./App.vue?vue&type=script&setup=true&lang=js\"","export { default } from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./PaymentForm.vue?vue&type=script&setup=true&lang=js\"; export * from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./PaymentForm.vue?vue&type=script&setup=true&lang=js\"","export { default } from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./PaymentFormComponent.vue?vue&type=script&setup=true&lang=js\"; export * from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./PaymentFormComponent.vue?vue&type=script&setup=true&lang=js\"","export * from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[2]!../../../../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./App.vue?vue&type=template&id=49030608\"","export * from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[2]!../../../../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./PaymentForm.vue?vue&type=template&id=60c58051\"","export * from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/dist/templateLoader.js??ruleSet[1].rules[2]!../../../../node_modules/vue-loader/dist/index.js??ruleSet[1].rules[6].use[0]!./PaymentFormComponent.vue?vue&type=template&id=70fecb5c\"","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","var getProto = Object.getPrototypeOf ? (obj) => (Object.getPrototypeOf(obj)) : (obj) => (obj.__proto__);\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach((key) => (def[key] = () => (value[key])));\n\t}\n\tdef['default'] = () => (value);\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","// The chunk loading function for additional chunks\n// Since all referenced chunks are already included\n// in this file, this function is empty here.\n__webpack_require__.e = () => (Promise.resolve());","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t\"task_payment\": 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkenDI\"] = self[\"webpackChunkenDI\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","__webpack_require__.nc = undefined;","","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [\"vendor-vue\"], () => (__webpack_require__(\"./src/views/task/payment.js\")))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n",""],"names":["ref","PaymentFormComponent","collectOptions","options","redirectOnsave","payment","console","log","opener","dismissPopup","window","force_reload","redirect_url","location","href","context_url","replace","redirectOnCancel","cancel_url","computed","useForm","DebugContent","getDefaults","buildYupSchema","getFieldData","getSubmitErrorCallback","getSubmitModelCallback","usePaymentConfigStore","usePaymentStore","Input","Select","scrollToBottom","strToAmount","BooleanCheckbox","props","__props","emit","__emit","debug","DEBUG","configStore","dataStore","formSchema","jsonSchema","getSchema","initialValues","result","value","Object","assign","item","showConfirmAmount","showConfirmRemittance","modeOptions","getOptions","bankAccountOptions","customerBankOptions","maxAmount","_useForm","validationSchema","values","handleSubmit","isSubmitting","onSubmitSuccess","savePayment","submitWrapper","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","actions","validation","_t","wrap","_context","prev","next","bank_remittance_id","trim","length","new_remittance_confirm","checkRemittanceId","sent","errors","setErrors","abrupt","status","data","field","stop","_x","_x2","apply","arguments","onSubmitError","onSubmit","onCancel","getData","fieldName","onAmountChange","amount_value","Math","abs","Layout","layout","storeToRefs","FormFlatLayout","PaymentForm","formatDate","formatDatetime","IconSpan","preload","_preload","_storeToRefs","currentPayment","currentInvoice","onSaved","__returned__","_t2","_t3","_t4","_t5","_t6","_t7","_t8","_t9","_t0","_t1","_t10","_t11","_t12","_t13","_context2","_onCancel","_onSaved","_preload3","promises","formConfigStore","loadConfig","setInitialValues","paymentId","itemId","invoiceId","Promise","all","then","loading","_preload2","setUrl","formConfigUrl","isEdit","_withAsyncContext2","_withAsyncContext","_withAsyncContext3","_slicedToArray","__temp","__restore","_createBlock","_Suspense","fallback","_withCtx","_toConsumableArray","_cache","_createElementVNode","_hoisted_1","_createVNode","$setup","payment_id","invoice_id","url","form_config_url","onSubmitForm","onClose","title","$props","id","_createElementBlock","_Fragment","key","fields","_hoisted_2","_mergeProps","autofocus","_hoisted_3","mode","onChangeValue","_hoisted_4","_hoisted_5","bank_id","_hoisted_6","check_number","_hoisted_7","customer_bank_id","issuer","_hoisted_8","_hoisted_9","buttons","_hoisted_10","_toDisplayString","type","name","disabled","_hoisted_11","_hoisted_12","onClick","amount","created_at","official_number","paid_status","topay_amount","invoice","defineStore","api","getFormConfigStore","currentPaymentId","currentInvoiceId","_setInitialValues","_ref","taskPayments","setInvoiceId","load","invoices","_savePayment","_callee2","update","payments","create","_x3","_checkRemittanceId","_callee3","_context3","startApp","App","app"],"sourceRoot":""}