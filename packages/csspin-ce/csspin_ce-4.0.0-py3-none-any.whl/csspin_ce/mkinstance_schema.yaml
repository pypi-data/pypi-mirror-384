# -*- mode: yaml; coding: utf-8 -*-
#
# Schema for the mkinstance plugin for csspin

mkinstance:
    type: object
    help: |
        The mkinstance plugin for csspin provides the full mkinstance
        experience - all in the context of csspin.
    properties:
        opts:
            type: list
            help: List of additional options for the mkinstance command.
        dbms:
            type: str
            help: The DBMS that mkinstance should use.
        webmake:
            type: bool
            help: If set to ``True``, webmake will be run.
        tls:
            type: object
            help: TLS configuration
            properties:
                cert:
                    type: path
                    help: The certificate file to use for SSL/TLS termination.
                cert_key:
                    type: path
                    help: The key file for ``mkinstance.tls.cert``.
                enabled:
                    type: bool
                    help: |
                        If set to ``True``, the instance will be equipped with a
                        self-signed TLS certificate that is added to the
                        instances' CA. The ``localhost.crt`` and
                        ``localhost.key`` can be obtained from the instances'
                        'certs' directory.
                dns_names:
                    type: list
                    help: DNS names for the TLS certificate
        std_calendar_profile_range:
            type: str
            help: |
                Value for CADDOK_GENERATE_STD_CALENDAR_PROFILE_RANGE to
                determine the range of dates that are being created for the
                standard calendar profile.
        base:
            type: object
            help: The base defines the base properties for an CE instance.
            properties:
                namespace:
                    type: str
                    help: |
                        The namespace that the CE instance should be assigned
                        to.
                instance_admpwd:
                    type: secret
                    help: |
                        The admin password for the CE instance to create. Use
                        ``""`` for empty password, thus the user caddok is
                        accessible.
                instance_location:
                    type: path
                    help: The location where the CE instance should be created.
        oracle:
            type: object
            help: |
                The Oracle DBMS properties are exclusively used, if
                ``mkinstance.dbms=oracle``.
            properties:
                ora_dbhost:
                    type: str
                    help: |
                        The hostname or IP address of the Oracle database
                        server.
                ora_syspwd:
                    type: secret
                    help: |
                        The password for the Oracle SYS user, used for
                        administrative tasks.
                ora_dbuser:
                    type: str
                    help: The username for connecting to the Oracle database.
                ora_dbpasswd:
                    type: secret
                    help: The password for the specified Oracle database user.
        mssql:
            type: object
            help: |
                The MSSQL DBMS properties are exclusively used, if
                ``mkinstance.dbms=mssql``.
            properties:
                mssql_dbuser:
                    type: str
                    help: The username for connecting to the MSSQL database.
                mssql_dbhost:
                    type: str
                    help: |
                        The hostname or IP address of the MSSQL database server.
                mssql_syspwd:
                    type: secret
                    help: |
                        The password for the MSSQL SYS user, used for
                        administrative tasks.
                mssql_catalog:
                    type: str
                    help: The name of the database catalog to use or create.
                mssql_dbpasswd:
                    type: secret
                    help: The password for the MSSQL database user.
                mssql_pyodbc:
                    type: str
                    help: |
                        Use the PyODBC driver: The installation will be created
                        with the PyODBC driver.
                mssql_odbc_driver:
                    type: str
                    help: |
                        ODBC driver name for the PyODBC driver: ODBC driver name
                        to use in the ODBC connection string
                mssql_odbc_encrypt:
                    type: str
                    help: Enable ODBC encryption.
        mssql_sspi:
            type: object
            help: |
                The MSSQL sspi DBMS properties are exclusively used, if
                ``mkinstance.dbms=mssql_sspi``.
            properties:
                mssql_dbhost:
                    type: str
                    help: |
                        The hostname or IP address of the MSSQL sspi database
                        server.
                mssql_catalog:
                    type: str
                    help: The name of the database catalog to use or create.
        postgres:
            type: object
            help: |
                The Postgres DBMS properties are exclusively used, if
                ``mkinstance.dbms=postgres``.
            properties:
                postgres_database:
                    type: str
                    help: The database that should be created or accessed.
                postgres_dbhost:
                    type: str
                    help: |
                        The hostname or IP address of the Postgres database
                        server.
                postgres_dbpasswd:
                    type: secret
                    help: The database password.
                postgres_dbport:
                    type: int
                    help: |
                        The port that the Postgres database is accessible via
                        postgres.host.
                postgres_dbuser:
                    type: str
                    help: The username for connecting to the Postgres database.
                postgres_system_user:
                    type: str
                    help: |
                        The system user with administrative privileges in
                        Postgres.
                postgres_syspwd:
                    type: secret
                    help: The password for the Postgres system user.
        s3_blobstore:
            type: object
            help: |
                The AWS S3 Blobstore properties are exclusively used, if
                ``mkinstance.dbms=s3_blobstore``.
            properties:
                s3_bucket:
                    type: str
                    help: |
                        The bucket name to be used in the S3 backend.
                        The bucket is not created and must already exist.
                s3_endpoint_url:
                    type: str
                    help: |
                        The URL that the client uses to connect to the MinIO server of the S3 backend.
                        When connection to Amazon S3, use the region option instead.
                s3_region:
                    type: str
                    help: |
                        The region is needed to connect to Amazon S3.
                        This option is not needed when using MinIO.
                s3_access_key_id:
                    type: str
                    help: |
                        The AWS S3 Access Key ID identifies your AWS account and the resources you are authorized to access.
                        The Access Key ID is typically used in conjunction with the ``s3_secret_access_key``.
                s3_secret_access_key:
                    type: secret
                    help: |
                        The s3_secret_access_key is a secret key that is used to sign requests made to AWS services.
                        The Secret Access Key should be kept private and should never be shared with anyone.
        azure_blobstore:
            type: object
            help: |
                The Azure Blobstore properties are exclusively used, if
                ``mkinstance.dbms=azure_blobstore``.
            properties:
                azure_container:
                    type: str
                    help: |
                        The container name to be used in the Azure backend.
                        The container is not created and must already exist.
                azure_endpoint_url:
                    type: str
                    help: |
                        The URL that the client uses to connect to the server of the Azure backend.
                        Note, that the URL schema differs for local development using Azurite and the cloud server.
                azure_account_name:
                    type: str
                    help: |
                        This parameter used to specify the identity of the Azure account that will be used to access cloud resources.
                        If not specified, the account name is extracted from the endpoint URL.
                azure_account_key:
                    type: secret
                    help: |
                        The Azure Account Key is a shared secret key that is used to sign requests made to Azure services.
                        The Secret Access Key should be kept private and should never be shared with anyone.
