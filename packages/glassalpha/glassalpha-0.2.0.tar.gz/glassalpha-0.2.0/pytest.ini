[pytest]
testpaths = tests

# Custom markers
markers =
    ci: CI-specific tests (YAML validation, dataset fetching, CLI performance)
    slow: Slow tests that can be skipped during development
    contract: Contract tests (test public APIs and boundaries)
    integration: Integration tests (test multiple components together)
    registry_removed: Tests for removed registry system (expected to fail after simplification)
    requires_serial: Tests that must run serially (no pytest-xdist)
    pdf: Tests that generate PDF files (timeout: 180 seconds per test)

# Note: Environment variables are set in tests/conftest.py (not here)
# The env= section requires pytest-env plugin which is not installed

# Determinism: Force single-process execution
# Never use pytest-xdist (-n flag) - breaks deterministic behavior
# If you need faster tests, use markers to skip slow tests: pytest -m "not slow"
addopts =
    --tb=short

# Warning filters: treat our warnings as errors, filter third-party noise
filterwarnings =
    error::UserWarning:glassalpha.*
    ignore:X does not have valid feature names.*:UserWarning:sklearn.*
    ignore:X has feature names.*:UserWarning:sklearn.*
    ignore:.*l1_reg.*deprecated.*:DeprecationWarning:shap.explainers._kernel
    ignore:Mean of empty slice.*:RuntimeWarning:numpy
    ignore:invalid value encountered in scalar divide.*:RuntimeWarning:numpy
    ignore:Precision is ill-defined.*:sklearn.metrics._classification.UndefinedMetricWarning
    ignore:PyPDF2 is deprecated.*:DeprecationWarning
    ignore:.*liblinear.*deprecated.*multiclass.*:FutureWarning:sklearn.*
    ignore:lbfgs failed to converge.*:sklearn.exceptions.ConvergenceWarning
