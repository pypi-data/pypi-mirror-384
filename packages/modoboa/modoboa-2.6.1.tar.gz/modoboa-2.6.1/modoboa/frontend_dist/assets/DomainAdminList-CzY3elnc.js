import{c as x,V as y}from"./VAvatar-Wz1UmZ2b.js";import{i as R,c as d,o as l,n as L,b as U,h as f,d as $,w as e,a as n,e as O,l as b,t as i,f as v,m as C,k as p,j as S}from"./index-D9OmnhdE.js";import{a as G}from"./accounts-DkNidbb0.js";import{d as D}from"./domains-DEEhRTFJ.js";import{c as H,V as q,b as F,a as J}from"./VCard-BrQzTMsm.js";import{V as K}from"./VDataTableVirtual-Ceu9uaGm.js";import{V as P}from"./VAutocomplete-vTx-9foZ.js";import{V as Q,a as w}from"./VRow-DGPh2Qmm.js";const re={__name:"BooleanIcon",props:{value:{type:Boolean}},setup(r){const _=r,k=R(()=>_.value?"mdi-check-circle":"mdi-close-circle"),t=R(()=>_.value?"success":"error");return(u,M)=>(l(),d(x,{icon:k.value,color:t.value},null,8,["icon","color"]))}},W={class:"headline"},X={key:0,class:"headline"},Y={key:1,class:"headline"},Z={key:0},de={__name:"DomainAdminList",props:{domain:{type:Object,default:()=>{}},dialogMode:{type:Boolean,default:!1}},emits:["close"],setup(r,{emit:_}){const k=L(),{$gettext:t}=U(),u=r,M=_,V=f([]),A=f([]),g=f(""),E=f([{title:t("Username"),value:"username"},{title:t("Name"),value:"name"},{title:"",value:"actions",align:"end",sortable:!1}]),h=f(!1),m=f(null);function I(){A.value.push({}),h.value=!0}function T(){h.value=!1,M("close")}function B(s){D.getDomainAdministrators(s.pk).then(a=>{A.value=a.data})}function N(){const s={role:[S.RESELLER,S.DOMAIN_ADMIN],page_size:50};g.value&&(s.search=g.value),G.getAll(s).then(a=>{V.value=a.data.results.filter(o=>A.value.find(c=>c.id===o.pk)===void 0)})}function j(){D.addDomainAdministrator(u.domain.pk,m.value.pk).then(()=>{B(u.domain),V.value=V.value.filter(s=>s.pk!==m.value.pk),m.value=null,h.value=!1,k.displayNotification({msg:t("Administrator added")})})}function z(s){D.removeDomainAdministrator(u.domain.pk,s.id).then(()=>{B(u.domain),N(),k.displayNotification({msg:t("Administrator removed")})})}return $(()=>{B(u.domain),N()}),(s,a)=>(l(),d(J,null,{default:e(()=>[n(H,null,{default:e(()=>[O("span",W,[r.dialogMode?(l(),b("div",X,i(v(t)("Administrators of"))+" "+i(r.domain.name),1)):(l(),b("div",Y,i(v(t)("Administrators")),1))])]),_:1}),n(q,null,{default:e(()=>[n(K,{headers:E.value,items:A.value},{"item.username":e(({item:o})=>[o.id?(l(),b("span",Z,i(o.username),1)):(l(),d(P,{key:1,modelValue:m.value,"onUpdate:modelValue":a[0]||(a[0]=c=>m.value=c),search:g.value,"onUpdate:search":[a[1]||(a[1]=c=>g.value=c),N],label:v(t)("Select an account"),items:V.value,variant:"outlined","item-title":"username",class:"mt-5","return-object":""},{append:e(()=>[m.value?(l(),d(y,{key:0,variant:"text",color:"primary",size:"x-large",onClick:j},{default:e(()=>[n(x,null,{default:e(()=>a[2]||(a[2]=[p("mdi-content-save")])),_:1,__:[2]})]),_:1})):C("",!0)]),_:1},8,["modelValue","search","label","items"]))]),"item.name":e(({item:o})=>[p(i(o.first_name)+" "+i(o.last_name),1)]),"item.actions":e(({item:o})=>[o.id?(l(),d(y,{key:0,variant:"text",color:"red",title:v(t)("Remove this administrator"),size:"x-large",onClick:c=>z(o)},{default:e(()=>[n(x,null,{default:e(()=>a[3]||(a[3]=[p("mdi-delete-outline")])),_:1,__:[3]})]),_:2},1032,["title","onClick"])):C("",!0)]),_:2},1032,["headers","items"])]),_:1}),n(F,null,{default:e(()=>[n(Q,null,{default:e(()=>[n(w,{align:r.dialogMode?"left":"right"},{default:e(()=>[h.value?C("",!0):(l(),d(y,{key:0,color:"primary",variant:"outlined",onClick:I},{default:e(()=>[n(x,{small:""},{default:e(()=>a[4]||(a[4]=[p("mdi-plus")])),_:1,__:[4]}),p(" "+i(v(t)("Add administrator")),1)]),_:1}))]),_:1},8,["align"]),r.dialogMode?(l(),d(w,{key:0,align:"right"},{default:e(()=>[n(y,{color:"grey darken-1",variant:"text",onClick:T},{default:e(()=>[p(i(v(t)("Close")),1)]),_:1})]),_:1})):C("",!0)]),_:1})]),_:1})]),_:1}))}};export{re as _,de as a};
