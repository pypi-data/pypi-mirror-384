{{- range $name, $svc := .Values.services }}
{{- if and (eq $.Values.secretProvider "internal") ($svc.secrets) }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ $.Release.Name }}-{{ $name }}-secret
type: Opaque
stringData:
  {{- range $k, $v := $svc.secrets }}
  {{ $k }}: {{ $v | quote }}
  {{- end }}
---
{{- end }}
{{- end }}
