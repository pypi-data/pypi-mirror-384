#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
自动化脚本 - 由脚本生成器自动生成
任务ID: {{ context.script_id }}
生成时间: {{ timestamp }}
生成器版本: {{ generator_version }}
"""

# 标准库导入
import os
import sys
import time
import json
import logging
from datetime import datetime
from pathlib import Path
from typing import Dict, List, Optional, Any, Tuple, Union
from loguru import logger

# 添加script_server模块路径到Python路径
current_script_path = Path(__file__).absolute()
script_server_root = None

# 从当前脚本路径向上查找script_server目录
for parent in current_script_path.parents:
    # 检查是否是script_server项目根目录
    if (parent / "src").exists() and (parent / "main.py").exists():
        script_server_root = parent
        break

if script_server_root:
    # 添加src目录到Python路径，这样可以直接导入utils模块
    src_path = script_server_root / "src"
    sys.path.insert(0, str(src_path))
    logging.info(f"已添加src路径: {src_path}")
else:
    logging.warning("未找到script_server模块，使用内置替代实现")

# 第三方库导入
import uiautomator2 as u2

# 图像处理库
try:
    import cv2
    import numpy as np
    from PIL import Image
    
    from io import BytesIO
except ImportError as e:
    logging.warning(f"图像处理库导入失败: {e}")

# CAN 相关库
try:
    import requests
    import threading
    from threading import Event
    import paho.mqtt.client as mqtt
    import ast
except ImportError as e:
    logging.warning(f"CAN 相关库导入失败: {e}")


# 全局变量 {# 基础导入模板 - 根据文档设计 #}
device = None
runner_dir = None
screenshot_count = 0
action_sequence = []

