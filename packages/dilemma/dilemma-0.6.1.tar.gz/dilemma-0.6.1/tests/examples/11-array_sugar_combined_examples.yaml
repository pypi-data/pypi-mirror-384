- name: sugar_with_string_patterns
  category: array_sugar_combined
  description: "Combine array sugar with string pattern matching"
  expression: "at least 2 of files matches |name like '*.pdf'| and any of files matches |name like '*.doc'|"
  expected: true
  context:
      files:
        - name: "report.pdf"
          size: 1024
        - name: "manual.pdf"
          size: 2048
        - name: "notes.doc"
          size: 512
        - name: "image.jpg"
          size: 256

- name: sugar_with_date_comparisons
  category: array_sugar_combined
  description: "Combine array sugar with date state checking"
  expression: "exactly 2 of events matches |date is $past| and none of events matches |date is $future|"
  expected: false
  context:
      events:
        - name: "Conference"
          date: "__YESTERDAY__"
        - name: "Meeting"
          date: "__TOMORROW__"
        - name: "Workshop"
          date: "__LAST_WEEK__"

- name: sugar_with_date_windows
  category: array_sugar_combined
  description: "Array sugar with date time windows"
  expression: "at least 1 of tasks matches | due_date upcoming within 24 hours |"
  expected: true
  context:
      tasks:
        - title: "Review PR"
          due_date: "__HOUR_AGO__"
        - title: "Write tests"
          due_date: "__TOMORROW__"
        - title: "Deploy"
          due_date: "__LAST_WEEK__"

- name: sugar_with_nested_string_operations
  category: array_sugar_combined
  description: "Array sugar with nested object string operations"
  expression: "any of users matches |profile.email like '*@company.com'| and all of users matches |status != 'inactive'|"
  expected: true
  context:
      users:
        - name: "Alice"
          profile:
            email: "alice@company.com"
          status: "active"
        - name: "Bob"
          profile:
            email: "bob@external.org"
          status: "active"
        - name: "Charlie"
          profile:
            email: "charlie@company.com"
          status: "pending"

- name: sugar_with_possessive_lookup
  category: array_sugar_combined
  description: "Array sugar with possessive syntax"
  expression: "exactly 1 of employees matches | manager's department == 'Engineering' |"
  expected: true
  context:
      employees:
        - name: "Alice"
          manager:
            name: "Sarah"
            department: "Engineering"
        - name: "Bob"
          manager:
            name: "Mike"
            department: "Marketing"
        - name: "Charlie"
          manager:
            name: "Lisa"
            department: "Sales"

- name: sugar_with_multiple_string_conditions
  category: array_sugar_combined
  description: "Complex string conditions in array sugar"
  expression: "at most 2 of products matches | name like '*Pro*' and category == 'Software' |"
  expected: true
  context:
      products:
        - name: "Video Pro"
          category: "Software"
          price: 299
        - name: "Audio Pro"
          category: "Software"
          price: 199
        - name: "Design Pro"
          category: "Hardware"
          price: 399
        - name: "Basic Editor"
          category: "Software"
          price: 99

- name: sugar_with_date_before_after
  category: array_sugar_combined
  description: "Array sugar with date before/after comparisons"
  expression: "all of projects matches |start_date before end_date| and at least 1 of projects matches |end_date after '2024-12-01'|"
  expected: true
  context:
      projects:
        - name: "Project Alpha"
          start_date: "2024-10-01"
          end_date: "2024-12-15"
        - name: "Project Beta"
          start_date: "2024-09-15"
          end_date: "2024-11-30"
        - name: "Project Gamma"
          start_date: "2024-11-01"
          end_date: "2025-01-15"

- name: sugar_with_same_day_comparisons
  category: array_sugar_combined
  description: "Array sugar with same day date comparisons"
  expression: "exactly 2 of meetings matches | start_time same_day_as end_time |"
  expected: true
  context:
      meetings:
        - title: "Standup"
          start_time: "2024-10-08T09:00:00Z"
          end_time: "2024-10-08T09:30:00Z"
        - title: "Planning"
          start_time: "2024-10-08T14:00:00Z"
          end_time: "2024-10-09T10:00:00Z"
        - title: "Review"
          start_time: "2024-10-07T15:00:00Z"
          end_time: "2024-10-07T16:00:00Z"

- name: sugar_with_time_units_older_than
  category: array_sugar_combined
  description: "Array sugar with older than time comparisons"
  expression: "none of logs matches | timestamp older than 1 hour |"
  expected: false
  context:
      logs:
        - message: "System started"
          timestamp: "__HOUR_AGO__"
        - message: "User login"
          timestamp: "__NOW__"
        - message: "Data processed"
          timestamp: "__YESTERDAY__"

- name: sugar_with_string_contains_and_dates
  category: array_sugar_combined
  description: "Combine string contains with date operations"
  expression: "any of alerts matches | 'Critical' in message and created_at is $past |"
  expected: true
  context:
      alerts:
        - id: 1
          message: "Critical system failure detected"
          created_at: "__YESTERDAY__"
        - id: 2
          message: "Warning: high memory usage"
          created_at: "__NOW__"
        - id: 3
          message: "Info: backup completed"
          created_at: "__TOMORROW__"

- name: sugar_with_pattern_not_like
  category: array_sugar_combined
  description: "Array sugar with negated pattern matching"
  expression: "all of documents matches |filename not like '*.tmp'| and at least 3 of documents matches |filename like '*.pdf'|"
  expected: true
  context:
      documents:
        - filename: "report.pdf"
          size: 1024
        - filename: "manual.pdf"
          size: 2048
        - filename: "guide.pdf"
          size: 1536
        - filename: "notes.txt"
          size: 256
        - filename: "data.csv"
          size: 512

- name: sugar_with_literal_dates
  category: array_sugar_combined
  description: "Array sugar with literal date strings"
  expression: "exactly 2 of milestones matches |target_date before '2025-01-01'| and none of milestones matches |target_date before '2024-01-01'|"
  expected: true
  context:
      milestones:
        - name: "Beta Release"
          target_date: "2024-11-15"
        - name: "GA Release"
          target_date: "2025-02-01"
        - name: "Feature Freeze"
          target_date: "2024-12-01"

- name: sugar_with_complex_nested_conditions
  category: array_sugar_combined
  description: "Complex nested conditions combining multiple features"
  expression: "at least 2 of orders matches | customer's profile.tier == 'Premium' and total > 100 and created_date is $past |"
  expected: true
  context:
      orders:
        - id: "ORD001"
          total: 150
          created_date: "__YESTERDAY__"
          customer:
            name: "Alice"
            profile:
              tier: "Premium"
        - id: "ORD002"
          total: 250
          created_date: "__YESTERDAY__"
          customer:
            name: "Bob"
            profile:
              tier: "Premium"
        - id: "ORD003"
          total: 50
          created_date: "__YESTERDAY__"
          customer:
            name: "Charlie"
            profile:
              tier: "Basic"

- name: sugar_with_string_equality_and_patterns
  category: array_sugar_combined
  description: "Mix string equality and pattern matching in array sugar"
  expression: "any of files matches |type == 'document' and name like '*.pdf'| and none of files matches |type == 'image' and name like '*.pdf'|"
  expected: true
  context:
      files:
        - name: "report.pdf"
          type: "document"
        - name: "photo.jpg"
          type: "image"
        - name: "manual.pdf"
          type: "document"
        - name: "chart.png"
          type: "image"

- name: sugar_with_date_ranges_and_strings
  category: array_sugar_combined
  description: "Combine date ranges with string operations"
  expression: "all of events matches |start_date before end_date| and exactly 1 of events matches |title like '*Workshop*'|"
  expected: true
  context:
      events:
        - title: "Team Workshop"
          start_date: "2024-10-10"
          end_date: "2024-10-11"
        - title: "Product Launch"
          start_date: "2024-11-01"
          end_date: "2024-11-02"
        - title: "Training Session"
          start_date: "2024-12-01"
          end_date: "2024-12-03"

- name: sugar_with_upcoming_within_and_strings
  category: array_sugar_combined
  description: "Combine upcoming within time windows with string matching"
  expression: "at most 1 of tasks matches | deadline upcoming within 7 days and priority == 'high' |"
  expected: true
  context:
      tasks:
        - title: "Fix critical bug"
          deadline: "__HOUR_AGO__"
          priority: "high"
        - title: "Update documentation"
          deadline: "__TOMORROW__"
          priority: "medium"
        - title: "Review code"
          deadline: "__LAST_WEEK__"
          priority: "low"

- name: sugar_with_arithmetic_and_dates
  category: array_sugar_combined
  description: "Combine arithmetic operations with date comparisons in array sugar"
  expression: "exactly 2 of products matches | price > 100 and launch_date is $past |"
  expected: true
  context:
      products:
        - name: "Premium Widget"
          price: 150
          launch_date: "__YESTERDAY__"
        - name: "Basic Widget"
          price: 50
          launch_date: "__YESTERDAY__"
        - name: "Pro Widget"
          price: 200
          launch_date: "__LAST_WEEK__"
        - name: "Future Widget"
          price: 300
          launch_date: "__TOMORROW__"

- name: sugar_with_multiple_time_comparisons
  category: array_sugar_combined
  description: "Multiple different time comparison types in one expression"
  expression: "any of events matches |start_time is $today| and all of events matches |end_time after start_time| and none of events matches |duration older than 1 year|"
  expected: true
  context:
      events:
        - name: "Daily Standup"
          start_time: "__NOW__"
          end_time: "__TOMORROW__"
          duration: "2025-09-01"
        - name: "Weekly Review"
          start_time: "__YESTERDAY__"
          end_time: "__TOMORROW__"
          duration: "2025-08-01"

- name: sugar_with_case_insensitive_patterns
  category: array_sugar_combined
  description: "Case insensitive pattern matching in array sugar"
  expression: "at least 2 of files matches |extension like '*.PDF'| and exactly 1 of files matches |name like '*REPORT*'|"
  expected: true
  context:
      files:
        - name: "annual_report.pdf"
          extension: ".pdf"
        - name: "monthly_summary.pdf"
          extension: ".pdf"
        - name: "notes.txt"
          extension: ".txt"
        - name: "data.csv"
          extension: ".csv"

- name: sugar_with_complex_boolean_logic
  category: array_sugar_combined
  description: "Complex boolean combinations with array sugar and basic operations"
  expression: "(at least 1 of users matches |status == 'active'|) and (none of users matches |last_login older than 30 days|) or (all of users matches |role != 'admin'|)"
  expected: true
  context:
      users:
        - name: "Alice"
          status: "active"
          last_login: "__YESTERDAY__"
          role: "user"
        - name: "Bob"
          status: "inactive"
          last_login: "__HOUR_AGO__"
          role: "user"
        - name: "Charlie"
          status: "active"
          last_login: "__NOW__"
          role: "moderator"
