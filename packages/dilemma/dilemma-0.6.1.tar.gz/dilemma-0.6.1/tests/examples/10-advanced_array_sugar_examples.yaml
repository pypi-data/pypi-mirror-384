- name: at_least_complex_business_logic
  category: array_sugar_advanced
  description: "Real-world business logic: at least 3 orders over $100"
  expression: "at least 3 of orders matches | total > 100 |"
  expected: true
  context:
      orders:
        - id: "ORD001"
          total: 150.50
          status: "completed"
        - id: "ORD002"
          total: 89.99
          status: "pending"
        - id: "ORD003"
          total: 200.00
          status: "completed"
        - id: "ORD004"
          total: 125.75
          status: "shipped"
        - id: "ORD005"
          total: 300.00
          status: "completed"

- name: at_most_error_monitoring
  category: array_sugar_advanced
  description: "System monitoring: at most 2 services with errors"
  expression: "at most 2 of services matches | error_count > 0 |"
  expected: true
  context:
      services:
        - name: "auth-service"
          error_count: 1
          status: "degraded"
        - name: "payment-service"
          error_count: 0
          status: "healthy"
        - name: "notification-service"
          error_count: 3
          status: "critical"
        - name: "user-service"
          error_count: 0
          status: "healthy"

- name: exactly_team_composition
  category: array_sugar_advanced
  description: "Team management: exactly 2 senior developers"
  expression: "exactly 2 of team_members matches | level == 'senior' and role == 'developer' |"
  expected: true
  context:
      team_members:
        - name: "Alice"
          role: "developer"
          level: "senior"
          years_experience: 8
        - name: "Bob"
          role: "developer"
          level: "junior"
          years_experience: 2
        - name: "Charlie"
          role: "developer"
          level: "senior"
          years_experience: 12
        - name: "Diana"
          role: "designer"
          level: "senior"
          years_experience: 10

- name: any_security_vulnerability
  category: array_sugar_advanced
  description: "Security audit: any server has critical vulnerabilities"
  expression: "any of servers matches | vulnerabilities.critical > 0 |"
  expected: true
  context:
      servers:
        - hostname: "web-01"
          vulnerabilities:
            critical: 0
            high: 2
            medium: 5
        - hostname: "db-01"
          vulnerabilities:
            critical: 1
            high: 0
            medium: 3
        - hostname: "cache-01"
          vulnerabilities:
            critical: 0
            high: 1
            medium: 2

- name: all_compliance_requirements
  category: array_sugar_advanced
  description: "Compliance check: all departments meet data retention policies"
  expression: "all of departments matches | data_retention_policy.implemented == true and audit_score >= 85 |"
  expected: false
  context:
      departments:
        - name: "Finance"
          data_retention_policy:
            implemented: true
            last_updated: "2024-01-15"
          audit_score: 92
        - name: "HR"
          data_retention_policy:
            implemented: true
            last_updated: "2024-02-10"
          audit_score: 88
        - name: "Marketing"
          data_retention_policy:
            implemented: false
            last_updated: "2023-12-01"
          audit_score: 78

- name: none_critical_alerts
  category: array_sugar_advanced
  description: "Operations: no critical alerts in the last hour"
  expression: "none of alerts matches | severity == 'critical' and age_minutes < 60 |"
  expected: false
  context:
      alerts:
        - id: "ALT001"
          severity: "warning"
          age_minutes: 15
          message: "High CPU usage"
        - id: "ALT002"
          severity: "critical"
          age_minutes: 45
          message: "Database connection failed"
        - id: "ALT003"
          severity: "info"
          age_minutes: 120
          message: "Scheduled maintenance completed"

- name: inventory_management_combined
  category: array_sugar_advanced
  description: "Inventory: at least 5 items low stock AND exactly 2 items out of stock"
  expression: "at least 5 of products matches |stock_level < 10| and exactly 2 of products matches |stock_level == 0|"
  expected: true
  context:
      products:
        - sku: "PROD001"
          name: "Widget A"
          stock_level: 5
          reorder_point: 10
        - sku: "PROD002"
          name: "Widget B"
          stock_level: 0
          reorder_point: 15
        - sku: "PROD003"
          name: "Widget C"
          stock_level: 3
          reorder_point: 8
        - sku: "PROD004"
          name: "Widget D"
          stock_level: 25
          reorder_point: 20
        - sku: "PROD005"
          name: "Widget E"
          stock_level: 0
          reorder_point: 12
        - sku: "PROD006"
          name: "Widget F"
          stock_level: 7
          reorder_point: 10
        - sku: "PROD007"
          name: "Widget G"
          stock_level: 2
          reorder_point: 5
        - sku: "PROD008"
          name: "Widget H"
          stock_level: 9
          reorder_point: 15

- name: performance_metrics_threshold
  category: array_sugar_advanced
  description: "Performance monitoring: at most 1 service below SLA"
  expression: "at most 1 of microservices matches | uptime_percentage < 99.9 |"
  expected: true
  context:
      microservices:
        - name: "user-api"
          uptime_percentage: 99.95
          response_time_ms: 45
        - name: "payment-api"
          uptime_percentage: 99.87
          response_time_ms: 120
        - name: "inventory-api"
          uptime_percentage: 99.99
          response_time_ms: 32
        - name: "shipping-api"
          uptime_percentage: 99.92
          response_time_ms: 78

- name: user_engagement_analysis
  category: array_sugar_advanced
  description: "Analytics: exactly 3 users with high engagement"
  expression: "exactly 3 of users matches | session_count > 50 and avg_session_duration > 300 |"
  expected: true
  context:
      users:
        - user_id: "USR001"
          session_count: 75
          avg_session_duration: 420
          last_login: "2024-10-08"
        - user_id: "USR002"
          session_count: 25
          avg_session_duration: 180
          last_login: "2024-10-07"
        - user_id: "USR003"
          session_count: 60
          avg_session_duration: 350
          last_login: "2024-10-08"
        - user_id: "USR004"
          session_count: 55
          avg_session_duration: 310
          last_login: "2024-10-08"
        - user_id: "USR005"
          session_count: 40
          avg_session_duration: 250
          last_login: "2024-10-06"

- name: financial_risk_assessment
  category: array_sugar_advanced
  description: "Risk management: any portfolio exceeds risk tolerance"
  expression: "any of portfolios matches | risk_score > 7.5 and exposure_percentage > 0.15 |"
  expected: false
  context:
      portfolios:
        - portfolio_id: "PF001"
          risk_score: 6.2
          exposure_percentage: 0.12
          total_value: 150000
        - portfolio_id: "PF002"
          risk_score: 8.1
          exposure_percentage: 0.08
          total_value: 250000
        - portfolio_id: "PF003"
          risk_score: 5.9
          exposure_percentage: 0.18
          total_value: 180000
        - portfolio_id: "PF004"
          risk_score: 7.3
          exposure_percentage: 0.14
          total_value: 220000

- name: content_moderation_workflow
  category: array_sugar_advanced
  description: "Content moderation: all posts reviewed and none flagged as spam"
  expression: "all of posts matches |reviewed == true| and none of posts matches |flags contains 'spam'|"
  expected: false
  context:
      posts:
        - post_id: "PST001"
          reviewed: true
          flags: ["inappropriate"]
          author: "user123"
        - post_id: "PST002"
          reviewed: true
          flags: []
          author: "user456"
        - post_id: "PST003"
          reviewed: false
          flags: ["spam"]
          author: "user789"
        - post_id: "PST004"
          reviewed: true
          flags: ["spam", "inappropriate"]
          author: "user101"

- name: infrastructure_scaling_decision
  category: array_sugar_advanced
  description: "Auto-scaling: at least 2 nodes with high CPU and exactly 1 with low memory"
  expression: "at least 2 of nodes matches |cpu_usage > 85| and exactly 1 of nodes matches |memory_usage < 20|"
  expected: true
  context:
      nodes:
        - node_id: "NODE001"
          cpu_usage: 92
          memory_usage: 45
          disk_usage: 67
        - node_id: "NODE002"
          cpu_usage: 78
          memory_usage: 15
          disk_usage: 82
        - node_id: "NODE003"
          cpu_usage: 89
          memory_usage: 56
          disk_usage: 34
        - node_id: "NODE004"
          cpu_usage: 65
          memory_usage: 78
          disk_usage: 91

- name: quality_assurance_gates
  category: array_sugar_advanced
  description: "QA pipeline: none of test suites have failing tests"
  expression: "none of test_suites matches | failed_tests > 0 or test_coverage < 80 |"
  expected: true
  context:
      test_suites:
        - name: "unit_tests"
          passed_tests: 245
          failed_tests: 0
          test_coverage: 94.5
        - name: "integration_tests"
          passed_tests: 78
          failed_tests: 0
          test_coverage: 87.2
        - name: "e2e_tests"
          passed_tests: 32
          failed_tests: 0
          test_coverage: 82.1

- name: customer_satisfaction_metrics
  category: array_sugar_advanced
  description: "Customer success: at most 3 customers with low satisfaction"
  expression: "at most 3 of customers matches | satisfaction_score < 7 and support_tickets > 5 |"
  expected: true
  context:
      customers:
        - customer_id: "CUST001"
          satisfaction_score: 8.5
          support_tickets: 2
          churn_risk: false
        - customer_id: "CUST002"
          satisfaction_score: 6.2
          support_tickets: 8
          churn_risk: true
        - customer_id: "CUST003"
          satisfaction_score: 9.1
          support_tickets: 1
          churn_risk: false
        - customer_id: "CUST004"
          satisfaction_score: 5.8
          support_tickets: 12
          churn_risk: true
        - customer_id: "CUST005"
          satisfaction_score: 7.9
          support_tickets: 3
          churn_risk: false

- name: deployment_readiness_check
  category: array_sugar_advanced
  description: "DevOps: all environments healthy and exactly 0 with pending deployments"
  expression: "all of environments matches |health_status == 'green'| and exactly 0 of environments matches |pending_deployments > 0|"
  expected: true
  context:
      environments:
        - name: "development"
          health_status: "green"
          pending_deployments: 0
          last_deployment: "2024-10-08T10:30:00Z"
        - name: "staging"
          health_status: "green"
          pending_deployments: 0
          last_deployment: "2024-10-08T09:15:00Z"
        - name: "production"
          health_status: "green"
          pending_deployments: 0
          last_deployment: "2024-10-07T14:45:00Z"
