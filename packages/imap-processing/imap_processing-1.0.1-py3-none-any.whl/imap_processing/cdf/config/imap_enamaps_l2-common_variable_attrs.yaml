# Define the non-tiling-specific variable attributes for the ENA maps.

# The tiling-specific variables are supplemented/overridden in
# both imap_enamaps_l2-healpix_variable_attrs.yaml,
# and  imap_enamaps_l2-rectangular_variable_attrs.yaml.
# An example of a completely tiling-specific variable is "longitude", which functions
# completely differently between the HEALPix and rectangular tiled maps. As such,
# "longitude" is entirely defined in the tiling-specific YAML files.
# An example of a variable that has some tiling-specific attributes is "ena_intensity",
# which has the same CATDESC, data_type, units, etc. regardless of the tiling, but
# has different pixel-level DEPEND_N attributes.
# The HEALPix-specific YAML file will supplement "ena_intensity"'s attributes
# DEPEND_1 = energy, DEPEND_2 = pixel_index,
# while the Rectangular-specific YAML file will supplement "ena_intensity"'s attributes with
# DEPEND_1 = energy, DEPEND_2 = latitude, DEPEND_3 = longitude.

default_int64_attrs: &default_int64
  # Assumed values for all variable attrs unless overwritten
  DEPEND_0: epoch
  DISPLAY_TYPE: time_series
  FILLVAL: -9223372036854775808
  VALIDMIN: -9223372036854775808
  VALIDMAX: 9223372036854775807
  VAR_TYPE: data
  UNITS: " "
  FORMAT: I20
  dtype: int64

default_float32_attrs: &default_float32
  FORMAT: F18.6
  FILLVAL: -1.0e31
  VALIDMIN: -3.4028235e+38
  VALIDMAX: 3.4028235e+38
  dtype: float32

# Define Coordinate(s) which are tiling-independent
energy:
  <<: *default_float32
  CATDESC: Geometric mean of energy bin.
  FIELDNAM: energy_bin_geometric_mean
  LABLAXIS: Energy bin geometric mean
  UNITS: KeV
  VAR_TYPE: support_data
  SCALETYP: linear
  # We might not have these set up yet
  DELTA_MINUS_VAR: energy_delta_minus
  DELTA_PLUS_VAR: energy_delta_plus
  DICT_KEY: SPASE>Particle>ParticleType:Atom,ParticleQuantity:Energy,Qualifier:Incident

energy_label:
  VAR_TYPE: metadata
  CATDESC: Label variable for energy coordinate
  FIELDNAM: energy label
  FORMAT: A16
  DEPEND_1: energy

energy_delta_minus:
  <<: *default_float32
  VAR_TYPE: support_data
  CATDESC: Difference between the energy bin center and lower edge.
  LABLAXIS: energy
  UNITS: KeV
  FIELDNAM: energy delta minus
  DISPLAY_TYPE: no_plot
  DEPEND_1: energy
  LABL_PTR_1: energy_label
  DICT_KEY: SPASE>Particle>ParticleType:Atom,ParticleQuantity:Energy,Qualifier:Uncertainty

energy_delta_plus:
  <<: *default_float32
  VAR_TYPE: support_data
  CATDESC: Difference between the energy bin center and upper edge.
  LABLAXIS: energy
  UNITS: KeV
  FIELDNAM: energy delta plus
  DISPLAY_TYPE: no_plot
  DEPEND_1: energy
  LABL_PTR_1: energy_label
  DICT_KEY: SPASE>Particle>ParticleType:Atom,ParticleQuantity:Energy,Qualifier:Uncertainty

epoch:
  CATDESC: Map time range start, number of nanoseconds since J2000 with leap seconds included
  FIELDNAM: J2000 Nanoseconds
  DELTA_PLUS_VAR: epoch_delta
  BIN_LOCATION: 0

epoch_delta:
  <<: *default_int64
  CATDESC: Number of nanoseconds covered by data included in this map product.
  FIELDNAM: epoch delta
  UNITS: ns
  VAR_TYPE: support_data
  DISPLAY_TYPE: no_plot
  TIME_SCALE: Terrestrial Time
  DICT_KEY: SPASE>Support>SupportQuantity:Temporal

# These two coordinates will be treated differently in the
# HEALPix and rectangular tilings. They will be substantially overridden
# in the tiling-specific YAML files.
longitude:
  <<: *default_float32
  FIELDNAM: "{frame} Longitude"
  LABLAXIS: "{frame} Longitude"
  UNITS: deg
  VAR_TYPE: support_data
  VALIDMIN: 0
  VALIDMAX: 360
  DICT_KEY: SPASE>Support>SupportQuantity:Orientation,Qualifier:DirectionAngle.AzimuthAngle,CoordinateSystemName:HAE,CoordinateRepresentation:Spherical

latitude:
  <<: *default_float32
  FIELDNAM: "{frame} Latitude"
  LABLAXIS: "{frame} Latitude"
  UNITS: deg
  VAR_TYPE: support_data
  VALIDMIN: -90
  VALIDMAX: 90
  DICT_KEY: SPASE>Support>SupportQuantity:Orientation,Qualifier:DirectionAngle.ElevationAngle,CoordinateSystemName:HAE,CoordinateRepresentation:Spherical

# Define Data variables, but not their pixel-level DEPENDs
# (e.g. pixel_index for HEALPix maps, longitude/latitude for rectangular maps).
# Those are defined in the tiling specific YAML files.
ena_intensity:
  <<: *default_float32
  CATDESC: Mono-energetic ENA intensity.
  FIELDNAM: Intensity
  UNITS: cm -2 s -1 sr -1 keV -1
  DELTA_MINUS_VAR: ena_intensity_stat_uncert
  DELTA_PLUS_VAR: ena_intensity_stat_uncert
  DEPEND_0: epoch
  VAR_TYPE: data
  LABLAXIS: Intensity
  DISPLAY_TYPE: map_image
  DICT_KEY: SPASE>Particle>ParticleType:Atom,ParticleQuantity:NumberFlux,Qualifier:Incident,CoordinateSystemName:HAE,CoordinateRepresentation:Spherical

ena_intensity_stat_uncert:
  <<: *default_float32
  CATDESC: ENA intensity statistical uncertainty.
  FIELDNAM: Intensity stat unc
  UNITS: cm -2 s -1 sr -1 keV -1
  DEPEND_0: epoch
  VAR_TYPE: support_data
  LABLAXIS: Statistical Unc
  DISPLAY_TYPE: map_image
  DICT_KEY: SPASE>Particle>ParticleType:Atom,ParticleQuantity:NumberFlux,Qualifier:Uncertainty,CoordinateSystemName:HAE,CoordinateRepresentation:Spherical

ena_intensity_sys_err:
  <<: *default_float32
  CATDESC: ENA intensity non-statistical error.
  FIELDNAM: Intensity non-stat error
  UNITS: cm -2 s -1 sr -1 keV -1
  DEPEND_0: epoch
  VAR_TYPE: support_data
  LABLAXIS: Non-statistical Error
  DISPLAY_TYPE: map_image
  DICT_KEY: SPASE>Particle>ParticleType:Atom,ParticleQuantity:NumberFlux,Qualifier:Uncertainty,CoordinateSystemName:HAE,CoordinateRepresentation:Spherical

ena_rate:
  <<: *default_float32
  CATDESC: Mono-energetic ENA Rate.
  FIELDNAM: Rate
  UNITS: counts/s
  DEPEND_0: epoch
  VAR_TYPE: data
  LABLAXIS: Rate
  DISPLAY_TYPE: map_image
  DICT_KEY: SPASE>Particle>ParticleType:Atom,ParticleQuantity:NumberFlux,Qualifier:Incident,CoordinateSystemName:HAE,CoordinateRepresentation:Spherical

bg_rate:
  <<: *default_float32
  CATDESC: Total background count rate from non-ENA (non-heliospheric) sources, as calculated by ground processing; makes sense only for "uncombined" calibration products.
  FIELDNAM: Background Rate
  UNITS: count s-1
  DEPEND_0: epoch
  VAR_TYPE: data
  LABLAXIS: Rate
  DISPLAY_TYPE: map_image
  FORMAT: F6.3
  DICT_KEY: SPASE>Particle>ParticleType:Atom,ParticleQuantity:NumberFlux,Qualifier:Incident,CoordinateSystemName:HAE,CoordinateRepresentation:Spherical

ena_count:
  <<: *default_float32
  CATDESC: Mono-energetic ENA Count.
  FIELDNAM: Count
  UNITS: counts
  DEPEND_0: epoch
  VAR_TYPE: data
  LABLAXIS: Count
  DISPLAY_TYPE: map_image
  DICT_KEY: SPASE>Particle>ParticleType:Atom,ParticleQuantity:NumberFlux,Qualifier:Incident,CoordinateSystemName:HAE,CoordinateRepresentation:Spherical

sensitivity:
  <<: *default_float32
  CATDESC: Averaged instrument sensitive area
  FIELDNAM: Sensitivity
  UNITS: cm^2
  VAR_TYPE: support_data
  LABLAXIS: sensitivity
  DISPLAY_TYPE: no_plot
  DICT_KEY: SPASE>Particle>ParticleType:Atom,ParticleQuantity:GeometricFactor,Qualifier:Directional,CoordinateSystemName:HAE,CoordinateRepresentation:Spherical

exposure_factor: &exposure_factor
  <<: *default_float32
  CATDESC: Exact or approximate time over which counts are accumulated.
  FIELDNAM: Exposure Times
  DEPEND_0: epoch
  UNITS: s
  VAR_TYPE: data
  LABLAXIS: Exposure
  DISPLAY_TYPE: no_plot
  FORMAT: F5.2
  VAR_NOTES: Exact or approximate exposure time over which counts in a pixel are accumulated.  Used as a weighting factor for combining data quantities sensibly.
  DICT_KEY: SPASE>Support>SupportQuantity:Temporal

geometric_function:
  <<: *default_float32
  CATDESC: Averaged aperture area as seen by the backstop.
  FIELDNAM: Geometric Function
  UNITS: cm^2 sr
  VAR_TYPE: support_data
  LABLAXIS: Geometric Function
  DISPLAY_TYPE: no_plot
  DICT_KEY: SPASE>Particle>ParticleType:Atom,ParticleQuantity:GeometricFactor,Qualifier:Directional,CoordinateSystemName:HAE,CoordinateRepresentation:Spherical

efficiency:
  <<: *default_float32
  CATDESC: Efficiency of the instrument in converting ENAs to valid events
  FIELDNAM: Efficiency
  UNITS: " "
  VAR_TYPE: support_data
  LABLAXIS: Efficiency
  DISPLAY_TYPE: no_plot
  DICT_KEY: SPASE>Particle>ParticleType:Atom,ParticleQuantity:Other

positional_uncert_theta:
  <<: *default_float32
  CATDESC: Averaged position uncertainty along the theta dimension of the instrument
  FIELDNAM: Positional Uncertainty Theta
  UNITS: degrees
  VAR_TYPE: support_data
  LABLAXIS: Position Uncertainty Theta
  DISPLAY_TYPE: no_plot
  DICT_KEY: SPASE>Particle>ParticleType:Atom,ParticleQuantity:ArrivalDirection,Qualifier:Uncertainty,CoordinateSystemName:HAE,CoordinateRepresentation:Spherical

positional_uncert_phi:
  <<: *default_float32
  CATDESC: Averaged position uncertainty along the phi dimension of the instrument
  FIELDNAM: Positional Uncertainty Phi
  UNITS: degrees
  VAR_TYPE: support_data
  LABLAXIS: Position Uncertainty Phi
  DISPLAY_TYPE: no_plot
  DICT_KEY: SPASE>Particle>ParticleType:Atom,ParticleQuantity:ArrivalDirection,Qualifier:Uncertainty,CoordinateSystemName:HAE,CoordinateRepresentation:Spherical

obs_date: &obs_date
  <<: *default_int64
  datatype: int64
  CATDESC: Mean collection date of data in a pixel
  FIELDNAM: J2000 Nanoseconds
  UNITS: ns
  DEPEND_0: epoch
  VAR_TYPE: support_data
  LABLAXIS: epoch
  DISPLAY_TYPE: no_plot
  DICT_KEY: SPASE>TemporalDescription:TimeSpan,Qualifier:Directional,CoordinateSystemName:HAE,CoordinateRepresentation:Spherical

obs_date_range:
  <<: *default_int64
  datatype: int64
  CATDESC: Standard deviation of the observation date.
  FIELDNAM: Observation date range
  UNITS: ns
  DEPEND_0: epoch
  VAR_TYPE: support_data
  LABLAXIS: epoch
  DISPLAY_TYPE: no_plot
  TIME_SCALE: Terrestrial Time
  DICT_KEY: SPASE>Support>SupportQuantity:Temporal

# These copied metadata vars will allow for variables
# to be either energy-dependent or independent.
# The tiling-specific YAML files will override the DEPENDs and LABL_PTRs.
exposure_factor_energy_independent:
  <<: *exposure_factor

obs_date_energy_independent:
  <<: *obs_date

obs_date_range_energy_independent:
  <<: *obs_date

solid_angle:
  <<: *default_float32
  CATDESC: Solid angle subtended by each pixel.
  FIELDNAM: Solid Angle
  DEPEND_0: epoch
  VAR_TYPE: support_data
  UNITS: sr
  LABLAXIS: Solid Angle
  DISPLAY_TYPE: no_plot
  DICT_KEY: SPASE>Support>SupportQuantity:Other
