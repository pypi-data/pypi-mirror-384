[target]
description = "Kernel BPF selftest (kselftest)"
# Some BPF tests use BTF data (type information) from the generated kernel
# image, hence the dependency to kernel and CONFIG_DEBUG_INFO_BTF. The other
# config options are needed to run all BPF tests but not currently included
# by the kselftest-merge target.
dependencies = kernel headers
commands = {make} -C tools/testing/selftests/ install
    && {tar_caf} {build_dir}/kselftest-bpf.tar{z_ext} -C {build_dir}/kselftest_bpf_install .

[makevars]
INSTALL_PATH = {build_dir}/kselftest_bpf_install
TARGETS = bpf
SKIP_TARGETS = ""
VMLINUX_BTF = {build_dir}/vmlinux

[artifacts]
kselftest-bpf.tar{z_ext} = kselftest-bpf.tar{z_ext}
