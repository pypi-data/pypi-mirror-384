 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 4.4.1     |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash. A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris   |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  S. J. Clark, G. C. Constantinescu, F. Corsetti, N. Corsini,  |
 |  O. Dieguez, S. M. M. Dubois,  J. M. Escartin, A. Greco,      |
 |  H. H. Helal,  Q. O. Hill, L. P. Lee, J.-H. Li,               |
 |  E. B. Linscott, G. Moynihan, D. D. O`Regan, O. K. Okan,      |
 |  M. J. S. Phipps, C. J. Pickard, M. I. J. Probert,            |
 |  L. E. Ratcliff, M. Robinson, A. Ruiz Serrano, J. S. Spencer, |
 |  E. W. Tait, G. Teobaldi, D. Turban, V. Vitale,               |
 |  K. A. Wilkinson, C. Weber, J. C. Womack                      |
 |  and T. J. Zuehlsdorff                                        |
 |                                                               |
 |                                   Copyright (c) 2004-2016     |
 |                                                               |
 |  Please cite:                                                 |
 |  "Introducing ONETEP: Linear-scaling density functional       |
 |   simulations on parallel computers".                         |
 |   C.-K. Skylaris, P. D. Haynes, A. A. Mostofi, M. C. Payne.   |
 |   J. Chem. Phys. 122 084119 (2005).                           |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 28-04-2016 12:36 (+0100)
 
Reading parameters from file "ethene_relax.dat" ...... done

If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
      Default threads: 4
   Running with 4 MPI processes.
   There are 4 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for parallel FFT box operations.
               4 threads for loops over batched FFT box operations.
               4 threads in other parallel regions.
... done

Basic input checks...... done

Reading geometry and species blocks from file "ethene_relax.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

task                : GEOMETRYOPTIMIZATION                                      
geom_max_iter       : 2                                                         
write_forces        : TRUE                                                      
maxit_pen           : 3                                                         
cutoff_energy       : 550 eV                                                    
xc_functional       : LDA                                                       
ngwf_threshold_orig : 1e-5                                                      
timings_level       : 0                                                         
print_qc            : TRUE                                                      
%block  lattice_cart                                                            
40.000    0.000    0.000                                                        
0.000   40.000    0.000                                                         
0.000    0.000   40.000                                                         
%endblock  lattice_cart                                                         
%block  positions_abs                                                           
     Hash =   000003073891830956016749
%endblock  positions_abs                                                        
%block  species                                                                 
H     H   1  1  5.50                                                            
C     C   6  4  6.00                                                            
%endblock  species                                                              
%block  species_pot                                                             
H     "../../pseudo/hydrogen.recpot"                                            
C     "../../pseudo/carbon.recpot"                                              
%endblock  species_pot                                                          

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
WARNING in pseudopotentials_read_species: string "GGA" found in pseudopotential
file "../../pseudo/carbon.recpot", yet xc_functional = "LDA".
 
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: ../../pseudo/carbon.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  6;  ionic charge:  4.000000
    Shell 1: l = 0; rc = 1.48 bohr
File: ../../pseudo/hydrogen.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  C          2         8         2
  H          4         4         0
.......   ......    ......    ......
Totals:      6        12         2
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   65 x  65 x  65
                              FFT-box:   63 x  63 x  63
                                  PPD:    5 x   5 x   1
Grid space d1=  0.615384615385a0 (KE cutoff=  20.05907Eh = 545.83499eV)
Grid space d2=  0.615384615385a0 (KE cutoff=  20.05907Eh = 545.83499eV)
Grid space d3=  0.615384615385a0 (KE cutoff=  20.05907Eh = 545.83499eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     65    65    65
          Real-space ('12') slabs/node (min max mean):     16    17    16
         Recip-space ('23') slabs/node (min max mean):      8     9     8
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:    130   130   130
          Real-space ('12') slabs/node (min max mean):     32    33    32
         Recip-space ('23') slabs/node (min max mean):     16    17    16
********************************************************************************

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Atom SCF converged after  39 iterations to a total energy of     -0.41130076

Atom SCF Calculation for C  : Z (AE atom) =   6 : Z (PS atom) =   4
Config String:
Orbitals (num,occ):  2     2.00 2.00
Orbitals   (num,l):  2        0    1
Atom SCF converged after  37 iterations to a total energy of     -5.30502903

================================================================================
<<<<<<<<<<<<<<<<<<<< Starting ONETEP Geometry Optimisation >>>>>>>>>>>>>>>>>>>>>
================================================================================

 Geometry Optimisation: output file is "ethene_relax.geom"
 
 
                           -------------------------------
                                     Cell Contents
                           -------------------------------
 
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            x  Element    Atom      Absolute co-ordinates of atoms     x
            x            Number        x           y           z       x
            x----------------------------------------------------------x
            x    C         1       21.131469   19.862216   20.048416   x
            x    H         2       22.316684   21.381117   21.086741   x
            x    H         3       22.305600   18.474510   19.097577   x
            x    C         4       18.868395   20.137541   19.951432   x
            x    H         5       17.694385   21.525477   20.902418   x
            x    H         6       17.683467   18.617139   18.913416   x
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
 

Determining parallel strategy ...... done
Calculating Ewald energy ...           14.949500 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done
NGWF initialisation ...... done
Up spin density kernel initialisation ...... done

Writing density kernel to file "ethene_relax.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.40055058488444 0.24893442877 0.01291645337 0.0246  0.000   12.00000000
 2    -13.62003108422273 0.19529551121 0.01195341767 0.8210 -0.784   12.00000000
WARNING: internal_polak_cg_coeff =  6.38985
WARNING: setting internal_polak_cg_coeff to zero
 3    -13.62404492116458 0.19579660337 0.00945892297 0.0593  0.000   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.037638856329
   Final penalty energy   :       0.212644620258
   RMS occupancy error    :       0.066559
   Occupancy bounds       : [-0.117, 1.096]
================================================================================

Finished density kernel iterations (   3)

Writing density kernel to file "ethene_relax.dkn" ... done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.340373151638E+01     7.2708E-03     7.2708E-03
    2        -1.340521643558E+01     7.4367E-04     7.4367E-04    -1.4849E-03
    3        -1.340524142643E+01     1.5781E-04     1.5781E-04    -2.4991E-05
    4        -1.340524246445E+01     3.5512E-05     3.5512E-05    -1.0380E-06
    5        -1.340524251509E+01     1.1707E-05     1.1707E-05    -5.0647E-08
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.34052425150944E+01  Eh
     Estimated bandgap           =   2.9477E-01  Eh
     RMS occupancy error         =   6.1185E-15
     [H,K] commutator            =   1.1707E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.5443E-03 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36277815009336E+01 Eh
   Predicted gain in energy  =      -2.22538985839156E-01 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.362726095292E+01     6.8559E-03     6.8559E-03
    2        -1.362864547188E+01     1.1677E-03     1.1677E-03    -1.3845E-03
    3        -1.362870595895E+01     2.1053E-04     2.1053E-04    -6.0487E-05
    4        -1.362870776453E+01     4.7510E-05     4.7510E-05    -1.8056E-06
    5        -1.362870783946E+01     7.9606E-06     7.9606E-06    -7.4927E-08
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36287078394592E+01  Eh
     Estimated bandgap           =   2.9931E-01  Eh
     RMS occupancy error         =   1.3148E-14
     [H,K] commutator            =   7.9606E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.4757E-03 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36536146437425E+01 Eh
   Predicted gain in energy  =      -2.49068042832512E-02 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.365367819216E+01     2.5842E-03     2.5842E-03
    2        -1.365389033670E+01     5.5176E-04     5.5176E-04    -2.1214E-04
    3        -1.365390289320E+01     9.9471E-05     9.9471E-05    -1.2557E-05
    4        -1.365390339553E+01     2.2828E-05     2.2828E-05    -5.0233E-07
    5        -1.365390341387E+01     6.8273E-06     6.8273E-06    -1.8336E-08
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36539034138654E+01  Eh
     Estimated bandgap           =   2.9504E-01  Eh
     RMS occupancy error         =   9.1054E-16
     [H,K] commutator            =   6.8273E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.8813E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36607618966137E+01 Eh
   Predicted gain in energy  =      -6.85848274833667E-03 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.366075921366E+01     7.6976E-04     7.6976E-04
    2        -1.366078353905E+01     2.0746E-04     2.0746E-04    -2.4325E-05
    3        -1.366078518644E+01     5.0112E-05     5.0112E-05    -1.6474E-06
    4        -1.366078530816E+01     8.8568E-06     8.8568E-06    -1.2172E-07
    5        -1.366078531239E+01     2.2982E-06     2.2982E-06    -4.2320E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36607853123946E+01  Eh
     Estimated bandgap           =   2.8935E-01  Eh
     RMS occupancy error         =   1.2616E-16
     [H,K] commutator            =   2.2982E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.5297E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36636948614292E+01 Eh
   Predicted gain in energy  =      -2.90954903460872E-03 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.366368776310E+01     5.9790E-04     5.9790E-04
    2        -1.366370268586E+01     1.7180E-04     1.7180E-04    -1.4923E-05
    3        -1.366370411085E+01     5.0412E-05     5.0412E-05    -1.4250E-06
    4        -1.366370419812E+01     1.2361E-05     1.2361E-05    -8.7264E-08
    5        -1.366370420579E+01     3.0297E-06     3.0297E-06    -7.6754E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36637042057936E+01  Eh
     Estimated bandgap           =   2.8417E-01  Eh
     RMS occupancy error         =   2.8921E-16
     [H,K] commutator            =   3.0297E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.4076E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36644178018473E+01 Eh
   Predicted gain in energy  =      -7.13596053707022E-04 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.366441762142E+01     3.2252E-04     3.2252E-04
    2        -1.366442126726E+01     9.5238E-05     9.5238E-05    -3.6458E-06
    3        -1.366442177973E+01     2.2394E-05     2.2394E-05    -5.1247E-07
    4        -1.366442179576E+01     5.1881E-06     5.1881E-06    -1.6035E-08
    5        -1.366442179704E+01     1.5678E-06     1.5678E-06    -1.2799E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36644217970435E+01  Eh
     Estimated bandgap           =   2.8153E-01  Eh
     RMS occupancy error         =   1.3643E-16
     [H,K] commutator            =   1.5678E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.4986E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36647525729997E+01 Eh
   Predicted gain in energy  =      -3.30775956193463E-04 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.366475274538E+01     3.7250E-04     3.7250E-04
    2        -1.366475755842E+01     1.1255E-04     1.1255E-04    -4.8130E-06
    3        -1.366475847281E+01     1.6970E-05     1.6970E-05    -9.1439E-07
    4        -1.366475848504E+01     6.1385E-06     6.1385E-06    -1.2232E-08
    5        -1.366475848671E+01     1.3558E-06     1.3558E-06    -1.6658E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36647584867091E+01  Eh
     Estimated bandgap           =   2.7782E-01  Eh
     RMS occupancy error         =   1.6369E-16
     [H,K] commutator            =   1.3558E-06
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.1727E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36647922161981E+01 Eh
   Predicted gain in energy  =      -3.37294889263262E-05 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.366479197312E+01     1.1165E-04     1.1165E-04
    2        -1.366479254756E+01     3.3844E-05     3.3844E-05    -5.7443E-07
    3        -1.366479259461E+01     6.3387E-06     6.3387E-06    -4.7056E-08
    4        -1.366479259683E+01     1.5903E-06     1.5903E-06    -2.2147E-09
    5        -1.366479259695E+01     4.4093E-07     4.4093E-07    -1.2792E-10
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36647925969539E+01  Eh
     Estimated bandgap           =   2.7659E-01  Eh
     RMS occupancy error         =   1.3635E-16
     [H,K] commutator            =   4.4093E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.4907E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36647927679397E+01 Eh
   Predicted gain in energy  =      -1.70985773095822E-07 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.366479276521E+01     9.6135E-06     9.6135E-06
    2        -1.366479276936E+01     2.7660E-06     2.7660E-06    -4.1508E-09
    3        -1.366479276968E+01     5.4757E-07     5.4757E-07    -3.2249E-10
    4        -1.366479276970E+01     1.7748E-07     1.7748E-07    -1.6330E-11
    5        -1.366479276970E+01     7.7018E-08     7.7018E-08    -5.9863E-13
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36647927697004E+01  Eh
     Estimated bandgap           =   2.7669E-01  Eh
     RMS occupancy error         =   8.2703E-17
     [H,K] commutator            =   7.7018E-08
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000622145858              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.45889166765359 |
           | Pseudopotential (local)    :      -60.80585251326911 |
           | Pseudopotential (non-local):        1.56705729583219 |
           | Hartree                    :       24.96616638787333 |
           | Exchange-correlation       :       -4.80055544722132 |
           | Ewald                      :       14.94949983943091 |
           | Total                      :      -13.66479276970040 |
           --------------------------------------------------------
           Integrated density           :       12.00000000000004
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   0     0.00454429879067    -13.40524251509441   0.500982    -13.62778150093356
   1     0.00147569748045    -13.62870783945923   0.528348    -13.65361464374249
   2     0.00068813015968    -13.65390341386536   0.665064    -13.66076189661370
   3     0.00045297017077    -13.66078531239462   0.657586    -13.66369486142923
   4     0.00024075941352    -13.66370420579363   0.572315    -13.66441780184734
   5     0.00014985836899    -13.66442179704354   0.682248    -13.66475257299973
   6     0.00007172741103    -13.66475848670915   0.299652    -13.66479221619807
   7     0.00001490668551    -13.66479259695388   0.035772    -13.66479276793965
   8     0.00000622145858    -13.66479276970040  <-- CG                         
 
<QC>        [NGWF iterations]:                      9
<QC>           [total_energy]:       -13.664792769700
<QC>           [rms_gradient]:         0.000006221459

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    C       1      0.20395525   0.03182300   0.02657598 *
*    H       2     -0.01220656  -0.02128278  -0.01171911 *
*    H       3     -0.00206699  -0.00905678  -0.00366512 *
*    C       4     -0.20401178  -0.03193167  -0.02659628 *
*    H       5      0.00207531   0.00899291   0.00362843 *
*    H       6      0.01225477   0.02145532   0.01177610 *
*                                                        *
**********************************************************
* TOTAL:            0.00000000   0.00000000  -0.00000000 *
**********************************************************
<QC>       [total_force(1,1)]:         0.203955247464
<QC>       [total_force(1,2)]:        -0.012206561023
<QC>       [total_force(1,3)]:        -0.002066989542
<QC>       [total_force(1,4)]:        -0.204011781097
<QC>       [total_force(1,5)]:         0.002075309314
<QC>       [total_force(1,6)]:         0.012254774884
<QC>       [total_force(2,1)]:         0.031822998542
<QC>       [total_force(2,2)]:        -0.021282783716
<QC>       [total_force(2,3)]:        -0.009056776801
<QC>       [total_force(2,4)]:        -0.031931674932
<QC>       [total_force(2,5)]:         0.008992911978
<QC>       [total_force(2,6)]:         0.021455324930
<QC>       [total_force(3,1)]:         0.026575979580
<QC>       [total_force(3,2)]:        -0.011719112305
<QC>       [total_force(3,3)]:        -0.003665115412
<QC>       [total_force(3,4)]:        -0.026596282264
<QC>       [total_force(3,5)]:         0.003628427763
<QC>       [total_force(3,6)]:         0.011776102638
 Geometry Optimisation: read_denskern parameter over-ridden to T
 Geometry Optimisation: read_tightbox_ngwfs parameter over-ridden to TRUE
 
                           -------------------------------
                                     Cell Contents
                           -------------------------------
 
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            x  Element    Atom      Absolute co-ordinates of atoms     x
            x            Number        x           y           z       x
            x----------------------------------------------------------x
            x    C         1       21.131469   19.862216   20.048416   x
            x    H         2       22.316684   21.381117   21.086741   x
            x    H         3       22.305600   18.474510   19.097577   x
            x    C         4       18.868395   20.137541   19.951432   x
            x    H         5       17.694385   21.525477   20.902418   x
            x    H         6       17.683467   18.617139   18.913416   x
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
 

BFGS: continuation file name is "ethene_relax.continuation"
 BFGS: finished iteration   0  with enthalpy= -1.366479276970E+001 Ha
  
 +-----------+-----------------+-----------------+------------+-----+ <-- BFGS
 | Parameter |      value      |    tolerance    |    units   | OK? | <-- BFGS
 +-----------+-----------------+-----------------+------------+-----+ <-- BFGS
 |  dE/ion   |   0.000000E+000 |   1.000000E-006 |         Ha | No  | <-- BFGS
 |  |F|max   |   2.082013E-001 |   2.000000E-003 |    Ha/Bohr | No  | <-- BFGS
 |  |dR|max  |   0.000000E+000 |   5.000000E-003 |       Bohr | No  | <-- BFGS
 +-----------+-----------------+-----------------+------------+-----+ <-- BFGS
  

================================================================================
 Starting BFGS iteration    1 ...
================================================================================

 Writing continuation file "ethene_relax.continuation" ...done
 Backing up NGWFs to file "ethene_relax.tightbox_ngwfs.bfgs_back" ... done
 Backing up density kernel to file "ethene_relax.dkn.bfgs_back" ... done
  
 +------------+-------------+-------------+-----------------+ <-- min BFGS
 |    Step    |   lambda    |   F.delta   |    enthalpy     | <-- min BFGS
 +------------+-------------+-------------+-----------------+ <-- min BFGS
 |  previous  |    0.000000 |    0.179471 |      -13.664793 | <-- min BFGS
 +------------+-------------+-------------+-----------------+ <-- min BFGS
  

--------------------------------------------------------------------------------
 BFGS: starting iteration   1 with trial guess (lambda=    1.000000)
--------------------------------------------------------------------------------
 
                           -------------------------------
                                     Cell Contents
                           -------------------------------
 
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            x  Element    Atom      Absolute co-ordinates of atoms     x
            x            Number        x           y           z       x
            x----------------------------------------------------------x
            x    C         1       21.545771   19.926859   20.102401   x
            x    H         2       22.291888   21.337884   21.062936   x
            x    H         3       22.301401   18.456113   19.090132   x
            x    C         4       18.453978   20.072677   19.897406   x
            x    H         5       17.698601   21.543745   20.909789   x
            x    H         6       17.708361   18.660722   18.937337   x
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
 

Determining parallel strategy ...... done
Calculating Ewald energy ...           13.629813 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_relax.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_relax.dkn" ... done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.339451604269E+01     1.9678E-02     1.9677E-02
    2        -1.341115113424E+01     4.4939E-03     4.4939E-03    -1.6635E-02
    3        -1.341195848765E+01     1.1204E-03     1.1204E-03    -8.0735E-04
    4        -1.341203170623E+01     4.8900E-04     4.8900E-04    -7.3219E-05
    5        -1.341204754715E+01     2.2003E-04     2.2003E-04    -1.5841E-05
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.34120475471452E+01  Eh
     Estimated bandgap           =   1.1913E-01  Eh
     RMS occupancy error         =   2.1835E-09
     [H,K] commutator            =   2.2003E-04
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.4322E-03 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35734012034046E+01 Eh
   Predicted gain in energy  =      -1.61353656259397E-01 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.357366125452E+01     5.5656E-03     5.5656E-03
    2        -1.357473898002E+01     1.1784E-03     1.1784E-03    -1.0777E-03
    3        -1.357481108469E+01     3.4038E-04     3.4038E-04    -7.2105E-05
    4        -1.357481672924E+01     5.8659E-05     5.8659E-05    -5.6445E-06
    5        -1.357481691519E+01     1.3217E-05     1.3217E-05    -1.8595E-07
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35748169151878E+01  Eh
     Estimated bandgap           =   1.3240E-01  Eh
     RMS occupancy error         =   2.0399E-13
     [H,K] commutator            =   1.3217E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.9793E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35867604101950E+01 Eh
   Predicted gain in energy  =      -1.19434950072534E-02 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.358674748421E+01     1.9828E-03     1.9828E-03
    2        -1.358688046844E+01     2.5647E-04     2.5647E-04    -1.3298E-04
    3        -1.358688337542E+01     5.7219E-05     5.7219E-05    -2.9070E-06
    4        -1.358688357611E+01     2.1360E-05     2.1360E-05    -2.0069E-07
    5        -1.358688361970E+01     8.1889E-06     8.1889E-06    -4.3595E-08
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35868836197036E+01  Eh
     Estimated bandgap           =   1.3355E-01  Eh
     RMS occupancy error         =   1.2855E-14
     [H,K] commutator            =   8.1889E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.7826E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35903972719762E+01 Eh
   Predicted gain in energy  =      -3.51365227259848E-03 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359038601015E+01     1.4175E-03     1.4175E-03
    2        -1.359045261657E+01     1.2975E-04     1.2975E-04    -6.6606E-05
    3        -1.359045344181E+01     2.0865E-05     2.0865E-05    -8.2524E-07
    4        -1.359045346373E+01     4.7176E-06     4.7176E-06    -2.1924E-08
    5        -1.359045346520E+01     1.3262E-06     1.3262E-06    -1.4713E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35904534652024E+01  Eh
     Estimated bandgap           =   1.3315E-01  Eh
     RMS occupancy error         =   7.2054E-17
     [H,K] commutator            =   1.3262E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.8418E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35914886313241E+01 Eh
   Predicted gain in energy  =      -1.03516612171894E-03 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359148351266E+01     6.7018E-04     6.7018E-04
    2        -1.359149875144E+01     6.7426E-05     6.7426E-05    -1.5239E-05
    3        -1.359149898127E+01     7.6976E-06     7.6976E-06    -2.2983E-07
    4        -1.359149898421E+01     2.0185E-06     2.0185E-06    -2.9459E-09
    5        -1.359149898456E+01     1.1275E-06     1.1275E-06    -3.4280E-10
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35914989845570E+01  Eh
     Estimated bandgap           =   1.3262E-01  Eh
     RMS occupancy error         =   1.2534E-16
     [H,K] commutator            =   1.1275E-06
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1792E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35915993019337E+01 Eh
   Predicted gain in energy  =      -1.00317376684700E-04 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359159926465E+01     1.0236E-04     1.0236E-04
    2        -1.359159970950E+01     2.3529E-05     2.3529E-05    -4.4486E-07
    3        -1.359159973485E+01     5.2012E-06     5.2012E-06    -2.5352E-08
    4        -1.359159973640E+01     1.4020E-06     1.4020E-06    -1.5465E-09
    5        -1.359159973649E+01     2.3223E-07     2.3223E-07    -9.3396E-11
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35915997364946E+01  Eh
     Estimated bandgap           =   1.3250E-01  Eh
     RMS occupancy error         =   1.2358E-16
     [H,K] commutator            =   2.3223E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.7057E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35916107926913E+01 Eh
   Predicted gain in energy  =      -1.10561967208156E-05 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359161073646E+01     8.7082E-05     8.7082E-05
    2        -1.359161104057E+01     1.8870E-05     1.8870E-05    -3.0411E-07
    3        -1.359161105714E+01     3.4912E-06     3.4912E-06    -1.6563E-08
    4        -1.359161105786E+01     9.5599E-07     9.5599E-07    -7.2162E-10
    5        -1.359161105790E+01     1.3354E-07     1.3354E-07    -4.4656E-11
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35916110579019E+01  Eh
     Estimated bandgap           =   1.3241E-01  Eh
     RMS occupancy error         =   1.3286E-16
     [H,K] commutator            =   1.3354E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.7908E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35916114677221E+01 Eh
   Predicted gain in energy  =      -4.09820215097056E-07 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359161146233E+01     2.2820E-05     2.2820E-05
    2        -1.359161148275E+01     4.7267E-06     4.7267E-06    -2.0421E-08
    3        -1.359161148380E+01     7.9551E-07     7.9551E-07    -1.0442E-09
    4        -1.359161148383E+01     2.2373E-07     2.2373E-07    -3.7494E-11
    5        -1.359161148384E+01     5.5761E-08     5.5761E-08    -2.6343E-12
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35916114838358E+01  Eh
     Estimated bandgap           =   1.3239E-01  Eh
     RMS occupancy error         =   1.2313E-16
     [H,K] commutator            =   5.5761E-08
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000994658908              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.16294872313559 |
           | Pseudopotential (local)    :      -57.81420241698124 |
           | Pseudopotential (non-local):        1.55826090423645 |
           | Hartree                    :       23.60141580571997 |
           | Exchange-correlation       :       -4.72984784095722 |
           | Ewald                      :       13.62981334101063 |
           | Total                      :      -13.59161148383582 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999998
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   0     0.00443224611983    -13.41204754714518   0.381839    -13.57340120340458
   1     0.00099792897950    -13.57481691518779   0.552127    -13.58676041019505
   2     0.00047825855130    -13.58688361970365   0.707523    -13.59039727197625
   3     0.00028418496363    -13.59045346520239   0.586919    -13.59148863132411
   4     0.00011792434025    -13.59149898455700   0.335366    -13.59159930193369
   5     0.00004705689087    -13.59159973649460   0.231105    -13.59161079269132
   6     0.00001790757422    -13.59161105790189   0.058005    -13.59161146772211
   7     0.00000994658908    -13.59161148383581  <-- CG                         
 
<QC>        [NGWF iterations]:                      8
<QC>           [total_energy]:       -13.591611483836
<QC>           [rms_gradient]:         0.000009946589

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    C       1     -0.21162166  -0.02079367  -0.03648443 *
*    H       2      0.04725343   0.06637739   0.04680259 *
*    H       3      0.02929516  -0.03614924  -0.02290448 *
*    C       4      0.21152519   0.02078020   0.03643742 *
*    H       5     -0.02926405   0.03606048   0.02285118 *
*    H       6     -0.04718807  -0.06627516  -0.04670229 *
*                                                        *
**********************************************************
* TOTAL:            0.00000000  -0.00000000   0.00000000 *
**********************************************************
<QC>       [total_force(1,1)]:        -0.211621661295
<QC>       [total_force(1,2)]:         0.047253428930
<QC>       [total_force(1,3)]:         0.029295163104
<QC>       [total_force(1,4)]:         0.211525189862
<QC>       [total_force(1,5)]:        -0.029264054687
<QC>       [total_force(1,6)]:        -0.047188065914
<QC>       [total_force(2,1)]:        -0.020793670136
<QC>       [total_force(2,2)]:         0.066377390989
<QC>       [total_force(2,3)]:        -0.036149239471
<QC>       [total_force(2,4)]:         0.020780204224
<QC>       [total_force(2,5)]:         0.036060476627
<QC>       [total_force(2,6)]:        -0.066275162234
<QC>       [total_force(3,1)]:        -0.036484425005
<QC>       [total_force(3,2)]:         0.046802591856
<QC>       [total_force(3,3)]:        -0.022904476917
<QC>       [total_force(3,4)]:         0.036437421717
<QC>       [total_force(3,5)]:         0.022851178149
<QC>       [total_force(3,6)]:        -0.046702289800
  
 +------------+-------------+-------------+-----------------+ <-- min BFGS
 |    Step    |   lambda    |   F.delta   |    enthalpy     | <-- min BFGS
 +------------+-------------+-------------+-----------------+ <-- min BFGS
 |  previous  |    0.000000 |    0.179471 |      -13.664793 | <-- min BFGS
 | trial step |    1.000000 |   -0.190885 |      -13.591611 | <-- min BFGS
 +------------+-------------+-------------+-----------------+ <-- min BFGS
  

--------------------------------------------------------------------------------
 BFGS: improving iteration   1 with line minimization (lambda=    0.484591)
--------------------------------------------------------------------------------
 
                           -------------------------------
                                     Cell Contents
                           -------------------------------
 
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            x  Element    Atom      Absolute co-ordinates of atoms     x
            x            Number        x           y           z       x
            x----------------------------------------------------------x
            x    C         1       21.332236   19.893542   20.074577   x
            x    H         2       22.304668   21.360167   21.075205   x
            x    H         3       22.303565   18.465595   19.093969   x
            x    C         4       18.667572   20.106108   19.925251   x
            x    H         5       17.696428   21.534329   20.905990   x
            x    H         6       17.695530   18.638259   18.925008   x
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
 

Determining parallel strategy ...... done
Calculating Ewald energy ...           14.171689 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_relax.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_relax.dkn" ... done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.362179762245E+01     1.3348E-02     1.3348E-02
    2        -1.362856023562E+01     2.7417E-03     2.7417E-03    -6.7626E-03
    3        -1.362895339050E+01     4.4322E-04     4.4322E-04    -3.9315E-04
    4        -1.362896159645E+01     8.7436E-05     8.7436E-05    -8.2059E-06
    5        -1.362896204931E+01     2.8755E-05     2.8755E-05    -4.5286E-07
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36289620493095E+01  Eh
     Estimated bandgap           =   1.9473E-01  Eh
     RMS occupancy error         =   7.1086E-13
     [H,K] commutator            =   2.8755E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.1205E-03 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36674284223540E+01 Eh
   Predicted gain in energy  =      -3.84663730445638E-02 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.366741984592E+01     1.1597E-03     1.1597E-03
    2        -1.366747602702E+01     2.6129E-04     2.6129E-04    -5.6181E-05
    3        -1.366747959238E+01     3.1245E-05     3.1245E-05    -3.5654E-06
    4        -1.366747963921E+01     9.2373E-06     9.2373E-06    -4.6836E-08
    5        -1.366747964389E+01     3.5487E-06     3.5487E-06    -4.6801E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36674796438936E+01  Eh
     Estimated bandgap           =   1.9277E-01  Eh
     RMS occupancy error         =   1.2757E-16
     [H,K] commutator            =   3.5487E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.8280E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36700653920545E+01 Eh
   Predicted gain in energy  =      -2.58574816095347E-03 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.367007349939E+01     6.8043E-04     6.8043E-04
    2        -1.367009079943E+01     1.4456E-04     1.4456E-04    -1.7300E-05
    3        -1.367009190518E+01     2.0750E-05     2.0750E-05    -1.1057E-06
    4        -1.367009192798E+01     5.4790E-06     5.4790E-06    -2.2799E-08
    5        -1.367009192944E+01     1.3467E-06     1.3467E-06    -1.4627E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36700919294440E+01  Eh
     Estimated bandgap           =   1.9180E-01  Eh
     RMS occupancy error         =   1.2152E-16
     [H,K] commutator            =   1.3467E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.9359E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36705241895771E+01 Eh
   Predicted gain in energy  =      -4.32260133111484E-04 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.367052553052E+01     2.9886E-04     2.9886E-04
    2        -1.367052979437E+01     8.8614E-05     8.8614E-05    -4.2639E-06
    3        -1.367053013507E+01     1.1567E-05     1.1567E-05    -3.4070E-07
    4        -1.367053014300E+01     2.1600E-06     2.1600E-06    -7.9301E-09
    5        -1.367053014323E+01     6.5745E-07     6.5745E-07    -2.3275E-10
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36705301432314E+01  Eh
     Estimated bandgap           =   1.9122E-01  Eh
     RMS occupancy error         =   7.2698E-17
     [H,K] commutator            =   6.5745E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.5910E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36706069157974E+01 Eh
   Predicted gain in energy  =      -7.67725660271168E-05 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.367060587039E+01     1.7555E-04     1.7555E-04
    2        -1.367060765827E+01     2.3183E-05     2.3183E-05    -1.7879E-06
    3        -1.367060768126E+01     5.5404E-06     5.5404E-06    -2.2987E-08
    4        -1.367060768278E+01     9.8430E-07     9.8430E-07    -1.5249E-09
    5        -1.367060768283E+01     3.1772E-07     3.1772E-07    -5.0802E-11
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36706076828335E+01  Eh
     Estimated bandgap           =   1.9078E-01  Eh
     RMS occupancy error         =   7.4683E-17
     [H,K] commutator            =   3.1772E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.8813E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36706236735210E+01 Eh
   Predicted gain in energy  =      -1.59906875349947E-05 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.367062274656E+01     1.4598E-04     1.4598E-04
    2        -1.367062378483E+01     4.1394E-05     4.1394E-05    -1.0383E-06
    3        -1.367062385708E+01     3.7688E-06     3.7688E-06    -7.2246E-08
    4        -1.367062385785E+01     3.8107E-07     3.8107E-07    -7.6418E-10
    5        -1.367062385785E+01     9.3321E-08     9.3321E-08    -7.8177E-12
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36706238578529E+01  Eh
     Estimated bandgap           =   1.9047E-01  Eh
     RMS occupancy error         =   1.5063E-16
     [H,K] commutator            =   9.3321E-08
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.2921E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36706846727718E+01 Eh
   Predicted gain in energy  =      -6.08149189407214E-05 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.367067521252E+01     4.4666E-04     4.4666E-04
    2        -1.367068482452E+01     1.3006E-04     1.3006E-04    -9.6120E-06
    3        -1.367068553002E+01     1.0908E-05     1.0908E-05    -7.0550E-07
    4        -1.367068553623E+01     1.4336E-06     1.4336E-06    -6.2138E-09
    5        -1.367068553633E+01     3.8394E-07     3.8394E-07    -9.7288E-11
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36706855363320E+01  Eh
     Estimated bandgap           =   1.9139E-01  Eh
     RMS occupancy error         =   6.2343E-17
     [H,K] commutator            =   3.8394E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.9691E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36706939844431E+01 Eh
   Predicted gain in energy  =      -8.44811110312094E-06 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.367069355041E+01     9.4242E-05     9.4242E-05
    2        -1.367069399831E+01     2.5996E-05     2.5996E-05    -4.4790E-07
    3        -1.367069402549E+01     2.5605E-06     2.5605E-06    -2.7180E-08
    4        -1.367069402584E+01     3.5182E-07     3.5182E-07    -3.4446E-10
    5        -1.367069402584E+01     1.0167E-07     1.0167E-07    -6.0858E-12
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36706940258430E+01  Eh
     Estimated bandgap           =   1.9116E-01  Eh
     RMS occupancy error         =   1.3060E-16
     [H,K] commutator            =   1.0167E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.4424E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36706947853096E+01 Eh
   Predicted gain in energy  =      -7.59466619371096E-07 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.367069475725E+01     2.5302E-05     2.5302E-05
    2        -1.367069479042E+01     6.6217E-06     6.6217E-06    -3.3168E-08
    3        -1.367069479215E+01     7.3854E-07     7.3854E-07    -1.7277E-09
    4        -1.367069479217E+01     1.1441E-07     1.1441E-07    -2.8923E-11
    5        -1.367069479217E+01     3.3066E-07     3.3066E-07     3.1726E-12
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36706947921711E+01  Eh
     Estimated bandgap           =   1.9110E-01  Eh
     RMS occupancy error         =   1.3564E-16
     [H,K] commutator            =   3.3066E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000605589308              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.18138041220052 |
           | Pseudopotential (local)    :      -58.99723100166933 |
           | Pseudopotential (non-local):        1.52737785708796 |
           | Hartree                    :       24.19066487032385 |
           | Exchange-correlation       :       -4.74457566341847 |
           | Ewald                      :       14.17168873330442 |
           | Total                      :      -13.67069479217106 |
           --------------------------------------------------------
           Integrated density           :       12.00000000000006
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   0     0.00212047849949    -13.62896204930946   0.397707    -13.66742842235403
   1     0.00048279906033    -13.66747964389355   0.514834    -13.67006539205451
   2     0.00019359252795    -13.67009192944403   0.530377    -13.67052418957714
   3     0.00008591027283    -13.67053014323139   0.475339    -13.67060691579741
   4     0.00003881264777    -13.67060768283346   0.493481    -13.67062367352099
   5     0.00004292117152    -13.67062385785291   1.534675    -13.67068467277185
   6     0.00005969115191    -13.67068553633200   0.111817    -13.67069398444310
   7     0.00002442395200    -13.67069402584299   0.058898    -13.67069478530961
   8     0.00000605589308    -13.67069479217105  <-- CG                         
 
<QC>        [NGWF iterations]:                      9
<QC>           [total_energy]:       -13.670694792171
<QC>           [rms_gradient]:         0.000006055893

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    C       1     -0.12680014   0.03138308   0.00083561 *
*    H       2      0.01273341   0.00827631   0.00744500 *
*    H       3      0.01576190  -0.02251056  -0.01345554 *
*    C       4      0.12672258  -0.03147580  -0.00087804 *
*    H       5     -0.01575103   0.02243767   0.01341124 *
*    H       6     -0.01266672  -0.00811069  -0.00735828 *
*                                                        *
**********************************************************
* TOTAL:            0.00000000  -0.00000000  -0.00000000 *
**********************************************************
<QC>       [total_force(1,1)]:        -0.126800140300
<QC>       [total_force(1,2)]:         0.012733408356
<QC>       [total_force(1,3)]:         0.015761900817
<QC>       [total_force(1,4)]:         0.126722579464
<QC>       [total_force(1,5)]:        -0.015751032458
<QC>       [total_force(1,6)]:        -0.012666715878
<QC>       [total_force(2,1)]:         0.031383076168
<QC>       [total_force(2,2)]:         0.008276310518
<QC>       [total_force(2,3)]:        -0.022510562729
<QC>       [total_force(2,4)]:        -0.031475803990
<QC>       [total_force(2,5)]:         0.022437667073
<QC>       [total_force(2,6)]:        -0.008110687040
<QC>       [total_force(3,1)]:         0.000835614322
<QC>       [total_force(3,2)]:         0.007445002559
<QC>       [total_force(3,3)]:        -0.013455537558
<QC>       [total_force(3,4)]:        -0.000878040569
<QC>       [total_force(3,5)]:         0.013411241209
<QC>       [total_force(3,6)]:        -0.007358279963
  
 +------------+-------------+-------------+-----------------+ <-- min BFGS
 |    Step    |   lambda    |   F.delta   |    enthalpy     | <-- min BFGS
 +------------+-------------+-------------+-----------------+ <-- min BFGS
 |  previous  |    0.000000 |    0.179471 |      -13.664793 | <-- min BFGS
 | trial step |    1.000000 |   -0.190885 |      -13.591611 | <-- min BFGS
 |  line step |    0.484591 |   -0.101692 |      -13.670695 | <-- min BFGS
 +------------+-------------+-------------+-----------------+ <-- min BFGS
  
 BFGS: finished iteration   1  with enthalpy= -1.367069479217E+001 Ha
  
 +-----------+-----------------+-----------------+------------+-----+ <-- BFGS
 | Parameter |      value      |    tolerance    |    units   | OK? | <-- BFGS
 +-----------+-----------------+-----------------+------------+-----+ <-- BFGS
 |  dE/ion   |   9.836704E-004 |   1.000000E-006 |         Ha | No  | <-- BFGS
 |  |F|max   |   1.306288E-001 |   2.000000E-003 |    Ha/Bohr | No  | <-- BFGS
 |  |dR|max  |   2.049467E-001 |   5.000000E-003 |       Bohr | No  | <-- BFGS
 +-----------+-----------------+-----------------+------------+-----+ <-- BFGS
  

================================================================================
 Starting BFGS iteration    2 ...
================================================================================

 Writing continuation file "ethene_relax.continuation" ...done
 Backing up NGWFs to file "ethene_relax.tightbox_ngwfs.bfgs_back" ... done
 Backing up density kernel to file "ethene_relax.dkn.bfgs_back" ... done
  
 +------------+-------------+-------------+-----------------+ <-- min BFGS
 |    Step    |   lambda    |   F.delta   |    enthalpy     | <-- min BFGS
 +------------+-------------+-------------+-----------------+ <-- min BFGS
 |  previous  |    0.000000 |    0.024595 |      -13.670695 | <-- min BFGS
 +------------+-------------+-------------+-----------------+ <-- min BFGS
  

--------------------------------------------------------------------------------
 BFGS: starting iteration   2 with trial guess (lambda=    1.000000)
--------------------------------------------------------------------------------
 
                           -------------------------------
                                     Cell Contents
                           -------------------------------
 
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            x  Element    Atom      Absolute co-ordinates of atoms     x
            x            Number        x           y           z       x
            x----------------------------------------------------------x
            x    C         1       21.260687   19.948724   20.087761   x
            x    H         2       22.315621   21.361208   21.079523   x
            x    H         3       22.323062   18.432283   19.074853   x
            x    C         4       18.738995   20.050757   19.912003   x
            x    H         5       17.676949   21.567518   20.925031   x
            x    H         6       17.684686   18.637511   18.920829   x
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
 

Determining parallel strategy ...... done
Calculating Ewald energy ...           14.315279 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_relax.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_relax.dkn" ... done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.366897442236E+01     5.4819E-03     5.4819E-03
    2        -1.367026431939E+01     1.5683E-03     1.5683E-03    -1.2899E-03
    3        -1.367038516477E+01     2.4404E-04     2.4404E-04    -1.2085E-04
    4        -1.367038858582E+01     6.3129E-05     6.3129E-05    -3.4211E-06
    5        -1.367038879236E+01     2.3755E-05     2.3755E-05    -2.0654E-07
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36703887923565E+01  Eh
     Estimated bandgap           =   2.2067E-01  Eh
     RMS occupancy error         =   1.9796E-13
     [H,K] commutator            =   2.3755E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.2196E-03 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36830767420876E+01 Eh
   Predicted gain in energy  =      -1.26879497310899E-02 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368306142951E+01     1.1587E-03     1.1587E-03
    2        -1.368311509811E+01     2.4893E-04     2.4893E-04    -5.3669E-05
    3        -1.368311831063E+01     4.5121E-05     4.5121E-05    -3.2125E-06
    4        -1.368311841198E+01     1.3243E-05     1.3243E-05    -1.0135E-07
    5        -1.368311842189E+01     6.3235E-06     6.3235E-06    -9.9190E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36831184218942E+01  Eh
     Estimated bandgap           =   2.1849E-01  Eh
     RMS occupancy error         =   3.4998E-16
     [H,K] commutator            =   6.3235E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.8848E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36840636583390E+01 Eh
   Predicted gain in energy  =      -9.45236444804820E-04 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368406760095E+01     4.7171E-04     4.7171E-04
    2        -1.368407685214E+01     1.2679E-04     1.2679E-04    -9.2512E-06
    3        -1.368407764928E+01     1.7572E-05     1.7572E-05    -7.9714E-07
    4        -1.368407766595E+01     4.7284E-06     4.7284E-06    -1.6669E-08
    5        -1.368407766734E+01     1.8883E-06     1.8883E-06    -1.3934E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36840776673442E+01  Eh
     Estimated bandgap           =   2.1749E-01  Eh
     RMS occupancy error         =   1.1742E-16
     [H,K] commutator            =   1.8883E-06
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1872E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36842510465591E+01 Eh
   Predicted gain in energy  =      -1.73379214885472E-04 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368424914857E+01     2.4598E-04     2.4598E-04
    2        -1.368425286806E+01     6.3421E-05     6.3421E-05    -3.7195E-06
    3        -1.368425300483E+01     1.1381E-05     1.1381E-05    -1.3678E-07
    4        -1.368425301180E+01     3.2858E-06     3.2858E-06    -6.9684E-09
    5        -1.368425301223E+01     1.0058E-06     1.0058E-06    -4.2796E-10
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36842530122282E+01  Eh
     Estimated bandgap           =   2.1684E-01  Eh
     RMS occupancy error         =   1.3718E-16
     [H,K] commutator            =   1.0058E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.1604E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36842742859536E+01 Eh
   Predicted gain in energy  =      -2.12737253608708E-05 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368427338987E+01     1.4062E-04     1.4062E-04
    2        -1.368427456582E+01     3.0153E-05     3.0153E-05    -1.1760E-06
    3        -1.368427459966E+01     3.5139E-06     3.5139E-06    -3.3834E-08
    4        -1.368427460033E+01     4.7361E-07     4.7361E-07    -6.6851E-10
    5        -1.368427460034E+01     2.2063E-07     2.2063E-07    -1.2745E-11
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36842746003404E+01  Eh
     Estimated bandgap           =   2.1651E-01  Eh
     RMS occupancy error         =   1.1637E-16
     [H,K] commutator            =   2.2063E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1552E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36842748493285E+01 Eh
   Predicted gain in energy  =      -2.48988129669669E-07 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368427481414E+01     2.8036E-05     2.8036E-05
    2        -1.368427485555E+01     8.6128E-06     8.6128E-06    -4.1408E-08
    3        -1.368427485862E+01     6.6414E-07     6.6414E-07    -3.0625E-09
    4        -1.368427485864E+01     1.5005E-07     1.5005E-07    -2.1750E-11
    5        -1.368427485864E+01     4.6036E-08     4.6036E-08    -3.9968E-13
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36842748586375E+01  Eh
     Estimated bandgap           =   2.1656E-01  Eh
     RMS occupancy error         =   1.0676E-16
     [H,K] commutator            =   4.6036E-08
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.5820E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36842749509606E+01 Eh
   Predicted gain in energy  =      -9.23231553429105E-08 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368427493855E+01     1.6546E-05     1.6546E-05
    2        -1.368427495300E+01     5.0679E-06     5.0679E-06    -1.4451E-08
    3        -1.368427495406E+01     3.8871E-07     3.8871E-07    -1.0590E-09
    4        -1.368427495407E+01     6.4791E-08     6.4791E-08    -7.3594E-12
    5        -1.368427495407E+01     3.0141E-08     3.0141E-08    -3.4106E-13
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36842749540709E+01  Eh
     Estimated bandgap           =   2.1653E-01  Eh
     RMS occupancy error         =   1.4029E-16
     [H,K] commutator            =   3.0141E-08
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000324230016              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.19992569924808 |
           | Pseudopotential (local)    :      -59.33103265685028 |
           | Pseudopotential (non-local):        1.52771835892739 |
           | Hartree                    :       24.34798110225184 |
           | Exchange-correlation       :       -4.74414651694487 |
           | Ewald                      :       14.31527905929697 |
           | Total                      :      -13.68427495407086 |
           --------------------------------------------------------
           Integrated density           :       12.00000000000003
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   0     0.00121964650113    -13.67038879235653   0.396527    -13.68307674208762
   1     0.00028848154238    -13.68311842189419   0.526214    -13.68406365833900
   2     0.00011871939789    -13.68407766734422   0.562462    -13.68425104655911
   3     0.00005160354096    -13.68425301222823   0.367094    -13.68427428595359
   4     0.00001155215773    -13.68427460034039   0.086737    -13.68427484932852
   5     0.00001581978983    -13.68427485863746   0.017815    -13.68427495096062
   6     0.00000324230016    -13.68427495407087  <-- CG                         
 
<QC>        [NGWF iterations]:                      7
<QC>           [total_energy]:       -13.684274954071
<QC>           [rms_gradient]:         0.000003242300

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    C       1     -0.04068765  -0.01697340  -0.02439174 *
*    H       2      0.00898147   0.01091099   0.00848019 *
*    H       3     -0.00525196   0.00939172   0.00791723 *
*    C       4      0.04073937   0.01703580   0.02444911 *
*    H       5      0.00524970  -0.00945570  -0.00795041 *
*    H       6     -0.00903092  -0.01090941  -0.00850438 *
*                                                        *
**********************************************************
* TOTAL:           -0.00000000   0.00000000   0.00000000 *
**********************************************************
<QC>       [total_force(1,1)]:        -0.040687653432
<QC>       [total_force(1,2)]:         0.008981472648
<QC>       [total_force(1,3)]:        -0.005251959267
<QC>       [total_force(1,4)]:         0.040739365643
<QC>       [total_force(1,5)]:         0.005249699181
<QC>       [total_force(1,6)]:        -0.009030924773
<QC>       [total_force(2,1)]:        -0.016973403295
<QC>       [total_force(2,2)]:         0.010910990547
<QC>       [total_force(2,3)]:         0.009391719317
<QC>       [total_force(2,4)]:         0.017035804512
<QC>       [total_force(2,5)]:        -0.009455700614
<QC>       [total_force(2,6)]:        -0.010909410467
<QC>       [total_force(3,1)]:        -0.024391743196
<QC>       [total_force(3,2)]:         0.008480189609
<QC>       [total_force(3,3)]:         0.007917232426
<QC>       [total_force(3,4)]:         0.024449114441
<QC>       [total_force(3,5)]:        -0.007950414371
<QC>       [total_force(3,6)]:        -0.008504378909
  
 +------------+-------------+-------------+-----------------+ <-- min BFGS
 |    Step    |   lambda    |   F.delta   |    enthalpy     | <-- min BFGS
 +------------+-------------+-------------+-----------------+ <-- min BFGS
 |  previous  |    0.000000 |    0.024595 |      -13.670695 | <-- min BFGS
 | trial step |    1.000000 |    0.002450 |      -13.684275 | <-- min BFGS
 +------------+-------------+-------------+-----------------+ <-- min BFGS
  
 BFGS: finished iteration   2  with enthalpy= -1.368427495407E+001 Ha
  
 +-----------+-----------------+-----------------+------------+-----+ <-- BFGS
 | Parameter |      value      |    tolerance    |    units   | OK? | <-- BFGS
 +-----------+-----------------+-----------------+------------+-----+ <-- BFGS
 |  dE/ion   |   2.263360E-003 |   1.000000E-006 |         Ha | No  | <-- BFGS
 |  |F|max   |   5.047449E-002 |   2.000000E-003 |    Ha/Bohr | No  | <-- BFGS
 |  |dR|max  |   9.132629E-002 |   5.000000E-003 |       Bohr | No  | <-- BFGS
 +-----------+-----------------+-----------------+------------+-----+ <-- BFGS
  
 BFGS : Geometry optimization failed to converge after            2  steps

================================================================================
 BFGS : Final Configuration:
================================================================================
 
                           -------------------------------
                                     Cell Contents
                           -------------------------------
 
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            x  Element    Atom      Absolute co-ordinates of atoms     x
            x            Number        x           y           z       x
            x----------------------------------------------------------x
            x    C         1       21.260687   19.948724   20.087761   x
            x    H         2       22.315621   21.361208   21.079523   x
            x    H         3       22.323062   18.432283   19.074853   x
            x    C         4       18.738995   20.050757   19.912003   x
            x    H         5       17.676949   21.567518   20.925031   x
            x    H         6       17.684686   18.637511   18.920829   x
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
 
 BFGS : Final Enthalpy     = -1.36842750E+001 Ha

 Writing continuation file "ethene_relax.continuation" ...done

 Removing NGWF backup file "ethene_relax.tightbox_ngwfs.bfgs_back" ... done
 Removing density kernel backup file "ethene_relax.dkn.bfgs_back" ... done

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:     234.629s on      4 node(s)                                    
TOTAL TIME:       234.630s on      4 node(s)                                    

Job completed: 28-04-2016 12:39 (+0100)

