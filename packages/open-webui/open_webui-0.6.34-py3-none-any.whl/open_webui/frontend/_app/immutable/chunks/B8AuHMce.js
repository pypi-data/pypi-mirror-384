import{S as We,i as je,s as Be,H as De,I as Ke,C as Y,D as J,E as Q,K as qe,q as v,r as T,F as $,v as Ge,k as pe,e as C,c as D,a as L,d as m,f as g,g as N,x as Dt,z as St,A as At,B as Mt,l as Z,p as X,t as ae,b as ie,h as A,j as oe,m as be,y as ne,u as re,w as Ut,_ as Vt,a0 as Rt,G as ue,X as Lt,U as Le,n as fe,M as ce,T as Se,J as sl,V as st,W as at}from"./BsAB9Z30.js";import{e as Ne}from"./BjVHJN9o.js";import"./IHki7fMi.js";import{t as me}from"./D1AOsjeD.js";import{d as al,n as il,e as Pe,g as it,a as ol,c as cl,m as ul}from"./BzMu2T5T.js";import{n as fl,o as dl,v as ml,p as gl,a as hl,q as _l,r as pl,t as bl,u as vl,w as wl,x as kl,y as yl}from"./Dl9eNJPw.js";import{g as El}from"./BMrfKXJR.js";import{u as Tl,F as Il}from"./DYKPVq7D.js";import{C as Cl,a as Dl,g as Oe,I as Sl,b as Al}from"./guGu2yhA.js";import"./BsJbWAQa.js";import{b as Ml,c as ot}from"./4oMrtK1P.js";import{f as Ul}from"./g5t9vw8M.js";import{D as Vl}from"./UJArJjDp.js";import{T as Ae}from"./cMkWkffq.js";import{V as Rl,R as Ll}from"./B1ioM4qG.js";import{I as Nl}from"./C_VfypxN.js";import{F as Bl}from"./DOlsu18Q.js";import{L as Fl,H as Hl}from"./N3GU-DtH.js";import{s as zl}from"./CbLk2dWY.js";import{S as Ol}from"./BO0KuA--.js";import{X as Pl}from"./CubwYUHd.js";function Wl(r){let e;const l=r[6].default,t=Dt(l,r,r[11],null);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,s){t&&t.m(n,s),e=!0},p(n,s){t&&t.p&&(!e||s&2048)&&St(t,l,n,n[11],e?Mt(l,n[11],s,null):At(n[11]),null)},i(n){e||(v(t,n),e=!0)},o(n){T(t,n),e=!1},d(n){t&&t.d(n)}}}function jl(r){let e,l;return e=new Ae({props:{content:r[4].t("More"),$$slots:{default:[Wl]},$$scope:{ctx:r}}}),{c(){Y(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){Q(e,t,n),l=!0},p(t,n){const s={};n&16&&(s.content=t[4].t("More")),n&2048&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){T(e.$$.fragment,t),l=!1},d(t){$(e,t)}}}function Kl(r){let e,l,t,n=r[4].t("Upload Files")+"",s,a;return e=new Cl({}),{c(){Y(e.$$.fragment),l=Z(),t=C("div"),s=ae(n),this.h()},l(c){J(e.$$.fragment,c),l=X(c),t=D(c,"DIV",{class:!0});var i=L(t);s=ie(i,n),i.forEach(m),this.h()},h(){g(t,"class","line-clamp-1")},m(c,i){Q(e,c,i),N(c,l,i),N(c,t,i),A(t,s),a=!0},p(c,i){(!a||i&16)&&n!==(n=c[4].t("Upload Files")+"")&&oe(s,n)},i(c){a||(v(e.$$.fragment,c),a=!0)},o(c){T(e.$$.fragment,c),a=!1},d(c){c&&(m(l),m(t)),$(e,c)}}}function ql(r){let e,l,t,n=r[4].t("Capture")+"",s,a;return e=new Dl({}),{c(){Y(e.$$.fragment),l=Z(),t=C("div"),s=ae(n),this.h()},l(c){J(e.$$.fragment,c),l=X(c),t=D(c,"DIV",{class:!0});var i=L(t);s=ie(i,n),i.forEach(m),this.h()},h(){g(t,"class","line-clamp-1")},m(c,i){Q(e,c,i),N(c,l,i),N(c,t,i),A(t,s),a=!0},p(c,i){(!a||i&16)&&n!==(n=c[4].t("Capture")+"")&&oe(s,n)},i(c){a||(v(e.$$.fragment,c),a=!0)},o(c){T(e.$$.fragment,c),a=!1},d(c){c&&(m(l),m(t)),$(e,c)}}}function Gl(r){let e,l,t,n;return e=new ot({props:{class:"flex gap-2 items-center px-3 py-1.5 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50 rounded-xl",$$slots:{default:[Kl]},$$scope:{ctx:r}}}),e.$on("click",r[7]),t=new ot({props:{class:"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50  rounded-xl",$$slots:{default:[ql]},$$scope:{ctx:r}}}),t.$on("click",r[8]),{c(){Y(e.$$.fragment),l=Z(),Y(t.$$.fragment)},l(s){J(e.$$.fragment,s),l=X(s),J(t.$$.fragment,s)},m(s,a){Q(e,s,a),N(s,l,a),Q(t,s,a),n=!0},p(s,a){const c={};a&2064&&(c.$$scope={dirty:a,ctx:s}),e.$set(c);const i={};a&2064&&(i.$$scope={dirty:a,ctx:s}),t.$set(i)},i(s){n||(v(e.$$.fragment,s),v(t.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),T(t.$$.fragment,s),n=!1},d(s){s&&m(l),$(e,s),$(t,s)}}}function Zl(r){let e,l,t;return l=new Ml({props:{class:"w-full max-w-[200px] rounded-2xl px-1 py-1  border border-gray-100  dark:border-gray-800 z-999 bg-white dark:bg-gray-850 dark:text-white shadow-lg transition",sideOffset:4,alignOffset:-6,side:"bottom",align:"start",transition:Ul,$$slots:{default:[Gl]},$$scope:{ctx:r}}}),{c(){e=C("div"),Y(l.$$.fragment),this.h()},l(n){e=D(n,"DIV",{slot:!0});var s=L(e);J(l.$$.fragment,s),s.forEach(m),this.h()},h(){g(e,"slot","content")},m(n,s){N(n,e,s),Q(l,e,null),t=!0},p(n,s){const a={};s&2067&&(a.$$scope={dirty:s,ctx:n}),l.$set(a)},i(n){t||(v(l.$$.fragment,n),t=!0)},o(n){T(l.$$.fragment,n),t=!1},d(n){n&&m(e),$(l)}}}function Xl(r){let e,l,t;function n(a){r[9](a)}let s={$$slots:{content:[Zl],default:[jl]},$$scope:{ctx:r}};return r[3]!==void 0&&(s.show=r[3]),e=new Vl({props:s}),De.push(()=>Ke(e,"show",n)),e.$on("change",r[10]),{c(){Y(e.$$.fragment)},l(a){J(e.$$.fragment,a)},m(a,c){Q(e,a,c),t=!0},p(a,[c]){const i={};c&2067&&(i.$$scope={dirty:c,ctx:a}),!l&&c&8&&(l=!0,i.show=a[3],qe(()=>l=!1)),e.$set(i)},i(a){t||(v(e.$$.fragment,a),t=!0)},o(a){T(e.$$.fragment,a),t=!1},d(a){$(e,a)}}}function Yl(r,e,l){let t,{$$slots:n={},$$scope:s}=e;const a=Ge("i18n");pe(r,a,w=>l(4,t=w));let{screenCaptureHandler:c}=e,{uploadFilesHandler:i}=e,{onClose:u=()=>{}}=e,d=!1;const I=async()=>{},b=()=>{i()},E=()=>{c()};function k(w){d=w,l(3,d)}const y=w=>{w.detail===!1&&u()};return r.$$set=w=>{"screenCaptureHandler"in w&&l(0,c=w.screenCaptureHandler),"uploadFilesHandler"in w&&l(1,i=w.uploadFilesHandler),"onClose"in w&&l(2,u=w.onClose),"$$scope"in w&&l(11,s=w.$$scope)},r.$$.update=()=>{r.$$.dirty&8&&d&&I()},[c,i,u,d,t,a,n,b,E,k,y,s]}class Jl extends We{constructor(e){super(),je(this,e,Yl,Xl,Be,{screenCaptureHandler:0,uploadFilesHandler:1,onClose:2})}}function ct(r,e,l){const t=r.slice();return t[23]=e[l],t[25]=l,t}function ut(r){let e,l,t,n=Ne(r[1]),s=[];for(let c=0;c<n.length;c+=1)s[c]=dt(ct(r,n,c));const a=c=>T(s[c],1,1,()=>{s[c]=null});return{c(){e=C("div"),l=C("div");for(let c=0;c<s.length;c+=1)s[c].c();this.h()},l(c){e=D(c,"DIV",{class:!0,id:!0});var i=L(e);l=D(i,"DIV",{class:!0});var u=L(l);for(let d=0;d<s.length;d+=1)s[d].l(u);u.forEach(m),i.forEach(m),this.h()},h(){g(l,"class","overflow-y-auto scrollbar-thin max-h-60"),g(e,"class","mention-list text-black dark:text-white rounded-2xl shadow-lg border border-gray-200 dark:border-gray-800 flex flex-col bg-white dark:bg-gray-850 w-72 p-1"),g(e,"id","suggestions-container")},m(c,i){N(c,e,i),A(e,l);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(l,null);t=!0},p(c,i){if(i&23){n=Ne(c[1]);let u;for(u=0;u<n.length;u+=1){const d=ct(c,n,u);s[u]?(s[u].p(d,i),v(s[u],1)):(s[u]=dt(d),s[u].c(),v(s[u],1),s[u].m(l,null))}for(ne(),u=n.length;u<s.length;u+=1)a(u);re()}},i(c){if(!t){for(let i=0;i<n.length;i+=1)v(s[i]);t=!0}},o(c){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)T(s[i]);t=!1},d(c){c&&m(e),Rt(s,c)}}}function ft(r){let e;function l(s,a){var c,i,u;if(((c=s[23])==null?void 0:c.type)==="user")return xl;if(((i=s[23])==null?void 0:i.type)==="model")return $l;if(((u=s[23])==null?void 0:u.type)==="channel")return Ql}let t=l(r),n=t&&t(r);return{c(){e=C("div"),n&&n.c(),this.h()},l(s){e=D(s,"DIV",{class:!0});var a=L(e);n&&n.l(a),a.forEach(m),this.h()},h(){g(e,"class","px-2 text-xs text-gray-500 py-1")},m(s,a){N(s,e,a),n&&n.m(e,null)},p(s,a){t===(t=l(s))&&n?n.p(s,a):(n&&n.d(1),n=t&&t(s),n&&(n.c(),n.m(e,null)))},d(s){s&&m(e),n&&n.d()}}}function Ql(r){let e=r[2].t("Channels")+"",l;return{c(){l=ae(e)},l(t){l=ie(t,e)},m(t,n){N(t,l,n)},p(t,n){n&4&&e!==(e=t[2].t("Channels")+"")&&oe(l,e)},d(t){t&&m(l)}}}function $l(r){let e=r[2].t("Models")+"",l;return{c(){l=ae(e)},l(t){l=ie(t,e)},m(t,n){N(t,l,n)},p(t,n){n&4&&e!==(e=t[2].t("Models")+"")&&oe(l,e)},d(t){t&&m(l)}}}function xl(r){let e=r[2].t("Users")+"",l;return{c(){l=ae(e)},l(t){l=ie(t,e)},m(t,n){N(t,l,n)},p(t,n){n&4&&e!==(e=t[2].t("Users")+"")&&oe(l,e)},d(t){t&&m(l)}}}function en(r){let e,l,t;return{c(){e=C("img"),this.h()},l(n){e=D(n,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){var n;Le(e.src,l=`${Pe}/users/${r[23].id}/profile/image`)||g(e,"src",l),g(e,"alt",t=((n=r[23])==null?void 0:n.label)??r[23].id),g(e,"class","rounded-full size-5 items-center mr-2")},m(n,s){N(n,e,s)},p(n,s){var a;s&2&&!Le(e.src,l=`${Pe}/users/${n[23].id}/profile/image`)&&g(e,"src",l),s&2&&t!==(t=((a=n[23])==null?void 0:a.label)??n[23].id)&&g(e,"alt",t)},i:fe,o:fe,d(n){n&&m(e)}}}function tn(r){let e,l,t;return{c(){e=C("img"),this.h()},l(n){e=D(n,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){var n,s,a,c,i,u;Le(e.src,l=((c=(a=(s=(n=r[23])==null?void 0:n.data)==null?void 0:s.info)==null?void 0:a.meta)==null?void 0:c.profile_image_url)??`${it}/static/favicon.png`)||g(e,"src",l),g(e,"alt",t=((u=(i=r[23])==null?void 0:i.data)==null?void 0:u.name)??r[23].id),g(e,"class","rounded-full size-5 items-center mr-2")},m(n,s){N(n,e,s)},p(n,s){var a,c,i,u,d,I;s&2&&!Le(e.src,l=((u=(i=(c=(a=n[23])==null?void 0:a.data)==null?void 0:c.info)==null?void 0:i.meta)==null?void 0:u.profile_image_url)??`${it}/static/favicon.png`)&&g(e,"src",l),s&2&&t!==(t=((I=(d=n[23])==null?void 0:d.data)==null?void 0:I.name)??n[23].id)&&g(e,"alt",t)},i:fe,o:fe,d(n){n&&m(e)}}}function ln(r){let e,l,t,n;const s=[rn,nn],a=[];function c(i,u){var d,I;return((I=(d=i[23])==null?void 0:d.data)==null?void 0:I.access_control)===null?0:1}return l=c(r),t=a[l]=s[l](r),{c(){e=C("div"),t.c(),this.h()},l(i){e=D(i,"DIV",{class:!0});var u=L(e);t.l(u),u.forEach(m),this.h()},h(){g(e,"class","size-4 justify-center flex items-center mr-0.5")},m(i,u){N(i,e,u),a[l].m(e,null),n=!0},p(i,u){let d=l;l=c(i),l!==d&&(ne(),T(a[d],1,1,()=>{a[d]=null}),re(),t=a[l],t||(t=a[l]=s[l](i),t.c()),v(t,1),t.m(e,null))},i(i){n||(v(t),n=!0)},o(i){T(t),n=!1},d(i){i&&m(e),a[l].d()}}}function nn(r){let e,l;return e=new Fl({props:{className:"size-[15px]",strokeWidth:"2"}}),{c(){Y(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){Q(e,t,n),l=!0},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){T(e.$$.fragment,t),l=!1},d(t){$(e,t)}}}function rn(r){let e,l;return e=new Hl({props:{className:"size-3",strokeWidth:"2.5"}}),{c(){Y(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){Q(e,t,n),l=!0},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){T(e.$$.fragment,t),l=!1},d(t){$(e,t)}}}function sn(r){let e=r[2].t("Channel")+"",l;return{c(){l=ae(e)},l(t){l=ie(t,e)},m(t,n){N(t,l,n)},p(t,n){n&4&&e!==(e=t[2].t("Channel")+"")&&oe(l,e)},d(t){t&&m(l)}}}function an(r){let e=r[2].t("Model")+"",l;return{c(){l=ae(e)},l(t){l=ie(t,e)},m(t,n){N(t,l,n)},p(t,n){n&4&&e!==(e=t[2].t("Model")+"")&&oe(l,e)},d(t){t&&m(l)}}}function on(r){let e=r[2].t("User")+"",l;return{c(){l=ae(e)},l(t){l=ie(t,e)},m(t,n){N(t,l,n)},p(t,n){n&4&&e!==(e=t[2].t("User")+"")&&oe(l,e)},d(t){t&&m(l)}}}function cn(r){let e,l,t,n,s,a=r[23].label+"",c,i,u,d,I,b,E,k,y;const w=[ln,tn,en],V=[];function z(O,B){return O[23].type==="channel"?0:O[23].type==="model"?1:O[23].type==="user"?2:-1}~(l=z(r))&&(t=V[l]=w[l](r));function F(O,B){if(O[23].type==="user")return on;if(O[23].type==="model")return an;if(O[23].type==="channel")return sn}let q=F(r),M=q&&q(r);function U(){return r[16](r[25])}function R(){return r[17](r[25])}return{c(){e=C("button"),t&&t.c(),n=Z(),s=C("div"),c=ae(a),i=Z(),u=C("div"),M&&M.c(),b=Z(),this.h()},l(O){e=D(O,"BUTTON",{type:!0,class:!0,"data-selected":!0});var B=L(e);t&&t.l(B),n=X(B),s=D(B,"DIV",{class:!0});var h=L(s);c=ie(h,a),h.forEach(m),i=X(B),u=D(B,"DIV",{class:!0});var f=L(u);M&&M.l(f),f.forEach(m),B.forEach(m),b=X(O),this.h()},h(){g(s,"class","truncate flex-1 pr-2"),g(u,"class","shrink-0 text-xs text-gray-500"),g(e,"type","button"),g(e,"class",d="flex items-center justify-between px-2.5 py-1.5 rounded-xl w-full text-left "+(r[25]===r[0]?"bg-gray-50 dark:bg-gray-800 selected-command-option-button":"")),g(e,"data-selected",I=r[25]===r[0])},m(O,B){N(O,e,B),~l&&V[l].m(e,null),A(e,n),A(e,s),A(s,c),A(e,i),A(e,u),M&&M.m(u,null),N(O,b,B),E=!0,k||(y=[ue(e,"click",U),ue(e,"mousemove",R)],k=!0)},p(O,B){r=O;let h=l;l=z(r),l===h?~l&&V[l].p(r,B):(t&&(ne(),T(V[h],1,1,()=>{V[h]=null}),re()),~l?(t=V[l],t?t.p(r,B):(t=V[l]=w[l](r),t.c()),v(t,1),t.m(e,n)):t=null),(!E||B&2)&&a!==(a=r[23].label+"")&&oe(c,a),q===(q=F(r))&&M?M.p(r,B):(M&&M.d(1),M=q&&q(r),M&&(M.c(),M.m(u,null))),(!E||B&1&&d!==(d="flex items-center justify-between px-2.5 py-1.5 rounded-xl w-full text-left "+(r[25]===r[0]?"bg-gray-50 dark:bg-gray-800 selected-command-option-button":"")))&&g(e,"class",d),(!E||B&1&&I!==(I=r[25]===r[0]))&&g(e,"data-selected",I)},i(O){E||(v(t),E=!0)},o(O){T(t),E=!1},d(O){O&&(m(e),m(b)),~l&&V[l].d(),M&&M.d(),k=!1,Lt(y)}}}function dt(r){var s,a,c;let e,l,t,n=(r[25]===0||((s=r[23])==null?void 0:s.type)!==((a=r[1][r[25]-1])==null?void 0:a.type))&&ft(r);return l=new Ae({props:{content:(c=r[23])==null?void 0:c.id,placement:"top-start",$$slots:{default:[cn]},$$scope:{ctx:r}}}),{c(){n&&n.c(),e=Z(),Y(l.$$.fragment)},l(i){n&&n.l(i),e=X(i),J(l.$$.fragment,i)},m(i,u){n&&n.m(i,u),N(i,e,u),Q(l,i,u),t=!0},p(i,u){var I,b,E;i[25]===0||((I=i[23])==null?void 0:I.type)!==((b=i[1][i[25]-1])==null?void 0:b.type)?n?n.p(i,u):(n=ft(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null);const d={};u&2&&(d.content=(E=i[23])==null?void 0:E.id),u&67108871&&(d.$$scope={dirty:u,ctx:i}),l.$set(d)},i(i){t||(v(l.$$.fragment,i),t=!0)},o(i){T(l.$$.fragment,i),t=!1},d(i){i&&m(e),n&&n.d(i),$(l,i)}}}function un(r){let e,l,t=r[1].length&&ut(r);return{c(){t&&t.c(),e=be()},l(n){t&&t.l(n),e=be()},m(n,s){t&&t.m(n,s),N(n,e,s),l=!0},p(n,[s]){n[1].length?t?(t.p(n,s),s&2&&v(t,1)):(t=ut(n),t.c(),v(t,1),t.m(e.parentNode,e)):t&&(ne(),T(t,1,1,()=>{t=null}),re())},i(n){l||(v(t),l=!0)},o(n){T(t),l=!1},d(n){n&&m(e),t&&t.d(n)}}}function fn(r,e,l){let t,n,s,a;pe(r,al,h=>l(18,n=h)),pe(r,il,h=>l(19,s=h));const c=Ge("i18n");pe(r,c,h=>l(2,a=h));let{query:i=""}=e,{command:u}=e,{selectedIndex:d=0}=e,{label:I=""}=e,{triggerChar:b="@"}=e,{modelSuggestions:E=!1}=e,{userSuggestions:k=!1}=e,{channelSuggestions:y=!1}=e,w=[],V=[],z=[];const F=async()=>{const h=await zl(localStorage.token,i).catch(f=>null);h&&l(14,V=[...h.users.map(f=>({type:"user",id:f.id,label:f.name}))].sort((f,P)=>f.label.localeCompare(P.label)))},q=h=>{const f=t[h];f&&f&&u({id:`${f.type==="user"?"U":f.type==="model"?"M":"C"}:${f.id}|${f.label}`,label:f.label})},M=h=>{if(!["ArrowUp","ArrowDown","Enter","Tab","Escape"].includes(h.key))return!1;if(h.key==="ArrowUp"){l(0,d=Math.max(0,d-1));const f=document.querySelector('[data-selected="true"]');return f==null||f.scrollIntoView({block:"center",inline:"nearest",behavior:"instant"}),!0}if(h.key==="ArrowDown"){l(0,d=Math.min(d+1,t.length-1));const f=document.querySelector('[data-selected="true"]');return f==null||f.scrollIntoView({block:"center",inline:"nearest",behavior:"instant"}),!0}return h.key==="Enter"||h.key==="Tab"?(q(d),h.key==="Enter"&&h.preventDefault(),!0):h.key==="Escape"};function U(h){return M(h)}const R=h=>{h.key==="Enter"&&(h.preventDefault(),q(d))};Ut(async()=>{window.addEventListener("keydown",R),y?l(15,z=[...s.map(h=>({type:"channel",id:h.id,label:h.name,data:h}))]):(k&&await F(),E&&l(13,w=[...n.map(h=>({type:"model",id:h.id,label:h.name,data:h}))]))}),Vt(()=>{window.removeEventListener("keydown",R)});const O=h=>q(h),B=h=>{l(0,d=h)};return r.$$set=h=>{"query"in h&&l(5,i=h.query),"command"in h&&l(6,u=h.command),"selectedIndex"in h&&l(0,d=h.selectedIndex),"label"in h&&l(7,I=h.label),"triggerChar"in h&&l(8,b=h.triggerChar),"modelSuggestions"in h&&l(9,E=h.modelSuggestions),"userSuggestions"in h&&l(10,k=h.userSuggestions),"channelSuggestions"in h&&l(11,y=h.channelSuggestions)},r.$$.update=()=>{r.$$.dirty&57376&&l(1,t=[...V,...w,...z].filter(h=>h.label.toLowerCase().includes(i.toLowerCase())||h.id.toLowerCase().includes(i.toLowerCase()))),r.$$.dirty&1056&&i!==null&&k&&F()},[d,t,a,c,q,i,u,I,b,E,k,y,U,w,V,z,O,B]}class mt extends We{constructor(e){super(),je(this,e,fn,un,Be,{query:5,command:6,selectedIndex:0,label:7,triggerChar:8,modelSuggestions:9,userSuggestions:10,channelSuggestions:11,_onKeyDown:12})}get _onKeyDown(){return this.$$.ctx[12]}}const dn=r=>({}),gt=r=>({});function ht(r,e,l){const t=r.slice();return t[73]=e[l],t[75]=l,t}function _t(r){let e,l,t,n,s,a,c,i,u,d,I,b,E,k,y,w,V,z;e=new Bl({props:{show:r[14]}});let F=r[9]&&pt(r);function q(f){r[44](f)}let M={variables:r[21],onSave:r[20]};r[19]!==void 0&&(M.show=r[19]),n=new Sl({props:M}),De.push(()=>Ke(n,"show",q));let U=r[1]===!1&&bt(r),R=r[4].length>0&&vt(r);const O=[gn,mn],B=[];function h(f,P){return f[15]?0:1}return y=h(r),w=B[y]=O[y](r),{c(){Y(e.$$.fragment),l=Z(),F&&F.c(),t=Z(),Y(n.$$.fragment),a=Z(),c=C("div"),i=C("div"),u=C("div"),d=C("div"),I=C("div"),U&&U.c(),b=Z(),R&&R.c(),E=Z(),k=C("div"),w.c(),this.h()},l(f){J(e.$$.fragment,f),l=X(f),F&&F.l(f),t=X(f),J(n.$$.fragment,f),a=X(f),c=D(f,"DIV",{class:!0});var P=L(c);i=D(P,"DIV",{class:!0});var G=L(i);u=D(G,"DIV",{class:!0});var ee=L(u);d=D(ee,"DIV",{class:!0});var H=L(d);I=D(H,"DIV",{class:!0});var S=L(I);U&&U.l(S),S.forEach(m),b=X(H),R&&R.l(H),H.forEach(m),ee.forEach(m),E=X(G),k=D(G,"DIV",{class:!0});var W=L(k);w.l(W),W.forEach(m),G.forEach(m),P.forEach(m),this.h()},h(){g(I,"class","relative"),g(d,"class","flex flex-col px-3 w-full"),g(u,"class","absolute top-0 left-0 right-0 mx-auto inset-x-0 bg-transparent flex justify-center"),g(k,"class",V=(r[8]?"opacity-50 pointer-events-none cursor-not-allowed":"")+" relative z-20"),g(i,"class","max-w-full mx-auto inset-x-0 relative"),g(c,"class","bg-transparent")},m(f,P){Q(e,f,P),N(f,l,P),F&&F.m(f,P),N(f,t,P),Q(n,f,P),N(f,a,P),N(f,c,P),A(c,i),A(i,u),A(u,d),A(d,I),U&&U.m(I,null),A(d,b),R&&R.m(d,null),A(i,E),A(i,k),B[y].m(k,null),z=!0},p(f,P){const G={};P[0]&16384&&(G.show=f[14]),e.$set(G),f[9]?F?F.p(f,P):(F=pt(f),F.c(),F.m(t.parentNode,t)):F&&(F.d(1),F=null);const ee={};P[0]&2097152&&(ee.variables=f[21]),P[0]&1048576&&(ee.onSave=f[20]),!s&&P[0]&524288&&(s=!0,ee.show=f[19],qe(()=>s=!1)),n.$set(ee),f[1]===!1?U?U.p(f,P):(U=bt(f),U.c(),U.m(I,null)):U&&(U.d(1),U=null),f[4].length>0?R?(R.p(f,P),P[0]&16&&v(R,1)):(R=vt(f),R.c(),v(R,1),R.m(d,null)):R&&(ne(),T(R,1,1,()=>{R=null}),re());let H=y;y=h(f),y===H?B[y].p(f,P):(ne(),T(B[H],1,1,()=>{B[H]=null}),re(),w=B[y],w?w.p(f,P):(w=B[y]=O[y](f),w.c()),v(w,1),w.m(k,null)),(!z||P[0]&256&&V!==(V=(f[8]?"opacity-50 pointer-events-none cursor-not-allowed":"")+" relative z-20"))&&g(k,"class",V)},i(f){z||(v(e.$$.fragment,f),v(n.$$.fragment,f),v(R),v(w),z=!0)},o(f){T(e.$$.fragment,f),T(n.$$.fragment,f),T(R),T(w),z=!1},d(f){f&&(m(l),m(t),m(a),m(c)),$(e,f),F&&F.d(f),$(n,f),U&&U.d(),R&&R.d(),B[y].d()}}}function pt(r){let e,l,t;return{c(){e=C("input"),this.h()},l(n){e=D(n,"INPUT",{type:!0}),this.h()},h(){g(e,"type","file"),e.hidden=!0,e.multiple=!0},m(n,s){N(n,e,s),r[41](e),l||(t=[ue(e,"change",r[42]),ue(e,"change",r[43])],l=!0)},p:fe,d(n){n&&m(e),r[41](null),l=!1,Lt(t)}}}function bt(r){let e,l,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M10 3a.75.75 0 01.75.75v10.638l3.96-4.158a.75.75 0 111.08 1.04l-5.25 5.5a.75.75 0 01-1.08 0l-5.25-5.5a.75.75 0 111.08-1.04l3.96 4.158V3.75A.75.75 0 0110 3z" clip-rule="evenodd"></path></svg>',n,s;return{c(){e=C("div"),l=C("button"),l.innerHTML=t,this.h()},l(a){e=D(a,"DIV",{class:!0});var c=L(e);l=D(c,"BUTTON",{class:!0,"data-svelte-h":!0}),Se(l)!=="svelte-1wiokab"&&(l.innerHTML=t),c.forEach(m),this.h()},h(){g(l,"class","bg-white border border-gray-100 dark:border-none dark:bg-white/20 p-1.5 rounded-full pointer-events-auto"),g(e,"class","absolute -top-12 left-0 right-0 flex justify-center z-30 pointer-events-none")},m(a,c){N(a,e,c),A(e,l),n||(s=ue(l,"click",r[45]),n=!0)},p:fe,d(a){a&&m(e),n=!1,s()}}}function vt(r){let e,l,t,n,s,a,c=r[4].map(Ct).join(", ")+"",i,u,d=r[24].t("is typing...")+"",I,b,E;return t=new Ol({props:{size:"xs"}}),{c(){e=C("div"),l=C("div"),Y(t.$$.fragment),n=Z(),s=C("div"),a=C("span"),i=ae(c),u=Z(),I=ae(d),this.h()},l(k){e=D(k,"DIV",{class:!0});var y=L(e);l=D(y,"DIV",{class:!0});var w=L(l);J(t.$$.fragment,w),n=X(w),s=D(w,"DIV",{});var V=L(s);a=D(V,"SPAN",{class:!0});var z=L(a);i=ie(z,c),z.forEach(m),u=X(V),I=ie(V,d),V.forEach(m),w.forEach(m),y.forEach(m),this.h()},h(){g(a,"class","font-normal text-black dark:text-white"),g(l,"class","text-xs px-1 mt-1.5 flex items-center gap-1.5"),g(e,"class",b="-mt-7 pb-2.5 bg-gradient-to-t to-transparent "+r[10]+" pointer-events-none select-none")},m(k,y){N(k,e,y),A(e,l),Q(t,l,null),A(l,n),A(l,s),A(s,a),A(a,i),A(s,u),A(s,I),E=!0},p(k,y){(!E||y[0]&16)&&c!==(c=k[4].map(Ct).join(", ")+"")&&oe(i,c),(!E||y[0]&16777216)&&d!==(d=k[24].t("is typing...")+"")&&oe(I,d),(!E||y[0]&1024&&b!==(b="-mt-7 pb-2.5 bg-gradient-to-t to-transparent "+k[10]+" pointer-events-none select-none"))&&g(e,"class",b)},i(k){E||(v(t.$$.fragment,k),E=!0)},o(k){T(t.$$.fragment,k),E=!1},d(k){k&&m(e),$(t)}}}function mn(r){var H;let e,l,t,n,s,a,c=(H=r[23])==null?void 0:H.richTextInput,i,u,d,I,b,E,k,y,w,V,z,F,q,M=r[2]!==null&&wt(r),U=r[16].length>0&&kt(r),R=Et(r);const O=r[40].menu,B=Dt(O,r,r[61],gt),h=B||bn(r);let f=r[11]===""&&It(r);const P=[kn,wn],G=[];function ee(S,W){return S[5]&&S[6]?0:1}return y=ee(r),w=G[y]=P[y](r),{c(){e=C("form"),l=C("div"),M&&M.c(),t=Z(),U&&U.c(),n=Z(),s=C("div"),a=C("div"),R.c(),i=Z(),u=C("div"),d=C("div"),h&&h.c(),I=Z(),b=C("div"),f&&f.c(),E=Z(),k=C("div"),w.c(),this.h()},l(S){e=D(S,"FORM",{class:!0});var W=L(e);l=D(W,"DIV",{id:!0,class:!0,dir:!0});var te=L(l);M&&M.l(te),t=X(te),U&&U.l(te),n=X(te),s=D(te,"DIV",{class:!0});var ge=L(s);a=D(ge,"DIV",{class:!0});var de=L(a);R.l(de),de.forEach(m),ge.forEach(m),i=X(te),u=D(te,"DIV",{class:!0});var he=L(u);d=D(he,"DIV",{class:!0});var Ce=L(d);h&&h.l(Ce),Ce.forEach(m),I=X(he),b=D(he,"DIV",{class:!0});var ve=L(b);f&&f.l(ve),E=X(ve),k=D(ve,"DIV",{class:!0});var Me=L(k);w.l(Me),Me.forEach(m),ve.forEach(m),he.forEach(m),te.forEach(m),W.forEach(m),this.h()},h(){var S;g(a,"class","scrollbar-hidden rtl:text-right ltr:text-left bg-transparent dark:text-gray-100 outline-hidden w-full pt-2.5 pb-[5px] px-1 resize-none h-fit max-h-96 overflow-auto"),g(s,"class","px-2.5"),g(d,"class","ml-1 self-end flex space-x-1 flex-1"),g(k,"class","flex items-center"),g(b,"class","self-end flex space-x-1 mr-1"),g(u,"class","flex justify-between mb-2.5 mx-0.5"),g(l,"id","message-input-container"),g(l,"class","flex-1 flex flex-col relative w-full shadow-lg rounded-3xl border border-gray-50 dark:border-gray-850 hover:border-gray-100 focus-within:border-gray-100 hover:dark:border-gray-800 focus-within:dark:border-gray-800 transition px-1 bg-white/90 dark:bg-gray-400/5 dark:text-gray-100"),g(l,"dir",V=((S=r[23])==null?void 0:S.chatDirection)??"auto"),g(e,"class","w-full flex gap-1.5")},m(S,W){N(S,e,W),A(e,l),M&&M.m(l,null),A(l,t),U&&U.m(l,null),A(l,n),A(l,s),A(s,a),R.m(a,null),A(l,i),A(l,u),A(u,d),h&&h.m(d,null),A(u,I),A(u,b),f&&f.m(b,null),A(b,E),A(b,k),G[y].m(k,null),z=!0,F||(q=ue(e,"submit",sl(r[60])),F=!0)},p(S,W){var ge,de;S[2]!==null?M?(M.p(S,W),W[0]&4&&v(M,1)):(M=wt(S),M.c(),v(M,1),M.m(l,t)):M&&(ne(),T(M,1,1,()=>{M=null}),re()),S[16].length>0?U?(U.p(S,W),W[0]&65536&&v(U,1)):(U=kt(S),U.c(),v(U,1),U.m(l,n)):U&&(ne(),T(U,1,1,()=>{U=null}),re()),W[0]&8388608&&Be(c,c=(ge=S[23])==null?void 0:ge.richTextInput)?(ne(),T(R,1,1,fe),re(),R=Et(S),R.c(),v(R,1),R.m(a,null)):R.p(S,W),B?B.p&&(!z||W[1]&1073741824)&&St(B,O,S,S[61],z?Mt(O,S[61],W,dn):At(S[61]),gt):h&&h.p&&(!z||W[0]&131584)&&h.p(S,z?W:[-1,-1,-1]),S[11]===""?f?(f.p(S,W),W[0]&2048&&v(f,1)):(f=It(S),f.c(),v(f,1),f.m(b,E)):f&&(ne(),T(f,1,1,()=>{f=null}),re());let te=y;y=ee(S),y===te?G[y].p(S,W):(ne(),T(G[te],1,1,()=>{G[te]=null}),re(),w=G[y],w?w.p(S,W):(w=G[y]=P[y](S),w.c()),v(w,1),w.m(k,null)),(!z||W[0]&8388608&&V!==(V=((de=S[23])==null?void 0:de.chatDirection)??"auto"))&&g(l,"dir",V)},i(S){z||(v(M),v(U),v(R),v(h,S),v(f),v(w),z=!0)},o(S){T(M),T(U),T(R),T(h,S),T(f),T(w),z=!1},d(S){S&&m(e),M&&M.d(),U&&U.d(),R.d(S),h&&h.d(S),f&&f.d(),G[y].d(),F=!1,q()}}}function gn(r){let e,l,t;function n(a){r[48](a)}let s={onCancel:r[46],onConfirm:r[47]};return r[15]!==void 0&&(s.recording=r[15]),e=new Rl({props:s}),De.push(()=>Ke(e,"recording",n)),{c(){Y(e.$$.fragment)},l(a){J(e.$$.fragment,a)},m(a,c){Q(e,a,c),t=!0},p(a,c){const i={};c[0]&32769&&(i.onCancel=a[46]),c[0]&32769&&(i.onConfirm=a[47]),!l&&c[0]&32768&&(l=!0,i.recording=a[15],qe(()=>l=!1)),e.$set(i)},i(a){t||(v(e.$$.fragment,a),t=!0)},o(a){T(e.$$.fragment,a),t=!1},d(a){$(e,a)}}}function wt(r){var y,w;let e,l,t,n,s,a=r[24].t("Replying to {{NAME}}",{NAME:((w=(y=r[2])==null?void 0:y.meta)==null?void 0:w.model_name)??r[2].user.name})+"",c,i,u,d,I,b,E,k;return I=new Pl({}),{c(){e=C("div"),l=C("div"),t=C("div"),n=C("div"),s=C("span"),c=ae(a),i=Z(),u=C("div"),d=C("button"),Y(I.$$.fragment),this.h()},l(V){e=D(V,"DIV",{class:!0});var z=L(e);l=D(z,"DIV",{class:!0});var F=L(l);t=D(F,"DIV",{class:!0});var q=L(t);n=D(q,"DIV",{class:!0});var M=L(n);s=D(M,"SPAN",{class:!0});var U=L(s);c=ie(U,a),U.forEach(m),M.forEach(m),q.forEach(m),i=X(F),u=D(F,"DIV",{});var R=L(u);d=D(R,"BUTTON",{class:!0});var O=L(d);J(I.$$.fragment,O),O.forEach(m),R.forEach(m),F.forEach(m),z.forEach(m),this.h()},h(){g(s,"class",""),g(n,"class","translate-y-[0.5px]"),g(t,"class","pl-[1px] flex items-center gap-2 text-sm"),g(d,"class","flex items-center dark:text-gray-500"),g(l,"class","flex items-center justify-between w-full"),g(e,"class","px-3 pt-3 text-left w-full flex flex-col z-10")},m(V,z){N(V,e,z),A(e,l),A(l,t),A(t,n),A(n,s),A(s,c),A(l,i),A(l,u),A(u,d),Q(I,d,null),b=!0,E||(k=ue(d,"click",r[49]),E=!0)},p(V,z){var F,q;(!b||z[0]&16777220)&&a!==(a=V[24].t("Replying to {{NAME}}",{NAME:((q=(F=V[2])==null?void 0:F.meta)==null?void 0:q.model_name)??V[2].user.name})+"")&&oe(c,a)},i(V){b||(v(I.$$.fragment,V),b=!0)},o(V){T(I.$$.fragment,V),b=!1},d(V){V&&m(e),$(I),E=!1,k()}}}function kt(r){let e,l,t=Ne(r[16]),n=[];for(let a=0;a<t.length;a+=1)n[a]=yt(ht(r,t,a));const s=a=>T(n[a],1,1,()=>{n[a]=null});return{c(){e=C("div");for(let a=0;a<n.length;a+=1)n[a].c();this.h()},l(a){e=D(a,"DIV",{class:!0});var c=L(e);for(let i=0;i<n.length;i+=1)n[i].l(c);c.forEach(m),this.h()},h(){g(e,"class","mx-2 mt-2.5 -mb-1 flex flex-wrap gap-2")},m(a,c){N(a,e,c);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null);l=!0},p(a,c){if(c[0]&65536){t=Ne(a[16]);let i;for(i=0;i<t.length;i+=1){const u=ht(a,t,i);n[i]?(n[i].p(u,c),v(n[i],1)):(n[i]=yt(u),n[i].c(),v(n[i],1),n[i].m(e,null))}for(ne(),i=t.length;i<n.length;i+=1)s(i);re()}},i(a){if(!l){for(let c=0;c<t.length;c+=1)v(n[c]);l=!0}},o(a){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)T(n[c]);l=!1},d(a){a&&m(e),Rt(n,a)}}}function hn(r){var s;let e,l;function t(){return r[51](r[75])}function n(){return r[52](r[73])}return e=new Il({props:{item:r[73],name:r[73].name,type:r[73].type,size:(s=r[73])==null?void 0:s.size,small:!0,loading:r[73].status==="uploading",dismissible:!0,edit:!0}}),e.$on("dismiss",t),e.$on("click",n),{c(){Y(e.$$.fragment)},l(a){J(e.$$.fragment,a)},m(a,c){Q(e,a,c),l=!0},p(a,c){var u;r=a;const i={};c[0]&65536&&(i.item=r[73]),c[0]&65536&&(i.name=r[73].name),c[0]&65536&&(i.type=r[73].type),c[0]&65536&&(i.size=(u=r[73])==null?void 0:u.size),c[0]&65536&&(i.loading=r[73].status==="uploading"),e.$set(i)},i(a){l||(v(e.$$.fragment,a),l=!0)},o(a){T(e.$$.fragment,a),l=!1},d(a){$(e,a)}}}function _n(r){let e,l,t,n,s,a,c='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',i,u,d,I;t=new Nl({props:{src:r[73].url,alt:"",imageClassName:" size-10 rounded-xl object-cover"}});function b(){return r[50](r[75])}return{c(){e=C("div"),l=C("div"),Y(t.$$.fragment),n=Z(),s=C("div"),a=C("button"),a.innerHTML=c,i=Z(),this.h()},l(E){e=D(E,"DIV",{class:!0});var k=L(e);l=D(k,"DIV",{class:!0});var y=L(l);J(t.$$.fragment,y),y.forEach(m),n=X(k),s=D(k,"DIV",{class:!0});var w=L(s);a=D(w,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),Se(a)!=="svelte-ixwiqw"&&(a.innerHTML=c),w.forEach(m),i=X(k),k.forEach(m),this.h()},h(){g(l,"class","relative"),g(a,"class","bg-white text-black border border-white rounded-full group-hover:visible invisible transition"),g(a,"type","button"),g(s,"class","absolute -top-1 -right-1"),g(e,"class","relative group")},m(E,k){N(E,e,k),A(e,l),Q(t,l,null),A(e,n),A(e,s),A(s,a),A(e,i),u=!0,d||(I=ue(a,"click",b),d=!0)},p(E,k){r=E;const y={};k[0]&65536&&(y.src=r[73].url),t.$set(y)},i(E){u||(v(t.$$.fragment,E),u=!0)},o(E){T(t.$$.fragment,E),u=!1},d(E){E&&m(e),$(t),d=!1,I()}}}function yt(r){let e,l,t,n;const s=[_n,hn],a=[];function c(i,u){return i[73].type==="image"?0:1}return e=c(r),l=a[e]=s[e](r),{c(){l.c(),t=be()},l(i){l.l(i),t=be()},m(i,u){a[e].m(i,u),N(i,t,u),n=!0},p(i,u){let d=e;e=c(i),e===d?a[e].p(i,u):(ne(),T(a[d],1,1,()=>{a[d]=null}),re(),l=a[e],l?l.p(i,u):(l=a[e]=s[e](i),l.c()),v(l,1),l.m(t.parentNode,t))},i(i){n||(v(l),n=!0)},o(i){T(l),n=!1},d(i){i&&m(t),a[e].d(i)}}}function Et(r){var n,s,a,c;let e,l,t={id:"chat-input",json:!0,messageInput:!0,editable:!r[8],placeholder:r[3],richText:((n=r[23])==null?void 0:n.richTextInput)??!0,showFormattingToolbar:((s=r[23])==null?void 0:s.showFormattingToolbar)??!1,shiftEnter:!(((a=r[23])==null?void 0:a.ctrlEnterToSend)??!1)&&!r[25]&&!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0),largeTextAsFile:((c=r[23])==null?void 0:c.largeTextAsFile)??!1,floatingMenuPlacement:"top-start",suggestions:r[22],onChange:r[53]};return e=new Ll({props:t}),r[54](e),e.$on("keydown",r[55]),e.$on("paste",r[56]),{c(){Y(e.$$.fragment)},l(i){J(e.$$.fragment,i)},m(i,u){Q(e,i,u),l=!0},p(i,u){var I,b,E,k;const d={};u[0]&256&&(d.editable=!i[8]),u[0]&8&&(d.placeholder=i[3]),u[0]&8388608&&(d.richText=((I=i[23])==null?void 0:I.richTextInput)??!0),u[0]&8388608&&(d.showFormattingToolbar=((b=i[23])==null?void 0:b.showFormattingToolbar)??!1),u[0]&41943040&&(d.shiftEnter=!(((E=i[23])==null?void 0:E.ctrlEnterToSend)??!1)&&!i[25]&&!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)),u[0]&8388608&&(d.largeTextAsFile=((k=i[23])==null?void 0:k.largeTextAsFile)??!1),u[0]&4194304&&(d.suggestions=i[22]),u[0]&6144&&(d.onChange=i[53]),e.$set(d)},i(i){l||(v(e.$$.fragment,i),l=!0)},o(i){T(e.$$.fragment,i),l=!1},d(i){r[54](null),$(e,i)}}}function Tt(r){let e,l;return e=new Jl({props:{screenCaptureHandler:r[29],uploadFilesHandler:r[57],$$slots:{default:[pn]},$$scope:{ctx:r}}}),{c(){Y(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){Q(e,t,n),l=!0},p(t,n){const s={};n[0]&131072&&(s.uploadFilesHandler=t[57]),n[1]&1073741824&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){T(e.$$.fragment,t),l=!1},d(t){$(e,t)}}}function pn(r){let e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path d="M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z"></path></svg>';return{c(){e=C("button"),e.innerHTML=l,this.h()},l(t){e=D(t,"BUTTON",{id:!0,class:!0,type:!0,"aria-label":!0,"data-svelte-h":!0}),Se(e)!=="svelte-180cnf0"&&(e.innerHTML=l),this.h()},h(){g(e,"id","input-menu-button"),g(e,"class","bg-transparent hover:bg-white/80 text-gray-800 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5 outline-hidden focus:outline-hidden"),g(e,"type","button"),g(e,"aria-label","More")},m(t,n){N(t,e,n)},p:fe,d(t){t&&m(e)}}}function bn(r){let e,l,t=r[9]&&Tt(r);return{c(){t&&t.c(),e=be()},l(n){t&&t.l(n),e=be()},m(n,s){t&&t.m(n,s),N(n,e,s),l=!0},p(n,s){n[9]?t?(t.p(n,s),s[0]&512&&v(t,1)):(t=Tt(n),t.c(),v(t,1),t.m(e.parentNode,e)):t&&(ne(),T(t,1,1,()=>{t=null}),re())},i(n){l||(v(t),l=!0)},o(n){T(t),l=!1},d(n){n&&m(e),t&&t.d(n)}}}function It(r){let e,l;return e=new Ae({props:{content:r[24].t("Record voice"),$$slots:{default:[vn]},$$scope:{ctx:r}}}),{c(){Y(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){Q(e,t,n),l=!0},p(t,n){const s={};n[0]&16777216&&(s.content=t[24].t("Record voice")),n[0]&16809984|n[1]&1073741824&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){T(e.$$.fragment,t),l=!1},d(t){$(e,t)}}}function vn(r){let e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 translate-y-[0.5px]"><path d="M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z"></path><path d="M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z"></path></svg>',t,n;return{c(){e=C("button"),e.innerHTML=l,this.h()},l(s){e=D(s,"BUTTON",{id:!0,class:!0,type:!0,"aria-label":!0,"data-svelte-h":!0}),Se(e)!=="svelte-wjtw32"&&(e.innerHTML=l),this.h()},h(){g(e,"id","voice-input-button"),g(e,"class","text-gray-600 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-200 transition rounded-full p-1.5 mr-0.5 self-center"),g(e,"type","button"),g(e,"aria-label","Voice Input")},m(s,a){N(s,e,a),t||(n=ue(e,"click",r[58]),t=!0)},p:fe,d(s){s&&m(e),t=!1,n()}}}function wn(r){let e,l,t;return l=new Ae({props:{content:r[24].t("Send message"),$$slots:{default:[yn]},$$scope:{ctx:r}}}),{c(){e=C("div"),Y(l.$$.fragment),this.h()},l(n){e=D(n,"DIV",{class:!0});var s=L(e);J(l.$$.fragment,s),s.forEach(m),this.h()},h(){g(e,"class","flex items-center")},m(n,s){N(n,e,s),Q(l,e,null),t=!0},p(n,s){const a={};s[0]&16777216&&(a.content=n[24].t("Send message")),s[0]&67584|s[1]&1073741824&&(a.$$scope={dirty:s,ctx:n}),l.$set(a)},i(n){t||(v(l.$$.fragment,n),t=!0)},o(n){T(l.$$.fragment,n),t=!1},d(n){n&&m(e),$(l)}}}function kn(r){let e,l,t;return l=new Ae({props:{content:r[24].t("Stop"),$$slots:{default:[En]},$$scope:{ctx:r}}}),{c(){e=C("div"),Y(l.$$.fragment),this.h()},l(n){e=D(n,"DIV",{class:!0});var s=L(e);J(l.$$.fragment,s),s.forEach(m),this.h()},h(){g(e,"class","flex items-center")},m(n,s){N(n,e,s),Q(l,e,null),t=!0},p(n,s){const a={};s[0]&16777216&&(a.content=n[24].t("Stop")),s[0]&64|s[1]&1073741824&&(a.$$scope={dirty:s,ctx:n}),l.$set(a)},i(n){t||(v(l.$$.fragment,n),t=!0)},o(n){T(l.$$.fragment,n),t=!1},d(n){n&&m(e),$(l)}}}function yn(r){let e,l,t,n,s;return{c(){e=C("button"),l=st("svg"),t=st("path"),this.h()},l(a){e=D(a,"BUTTON",{id:!0,class:!0,type:!0});var c=L(e);l=at(c,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var i=L(l);t=at(i,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),L(t).forEach(m),i.forEach(m),c.forEach(m),this.h()},h(){g(t,"fill-rule","evenodd"),g(t,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),g(t,"clip-rule","evenodd"),g(l,"xmlns","http://www.w3.org/2000/svg"),g(l,"viewBox","0 0 16 16"),g(l,"fill","currentColor"),g(l,"class","size-5"),g(e,"id","send-message-button"),g(e,"class",n=(r[11]!==""||r[16].length!==0?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 self-center"),g(e,"type","submit"),e.disabled=s=r[11]===""&&r[16].length===0},m(a,c){N(a,e,c),A(e,l),A(l,t)},p(a,c){c[0]&67584&&n!==(n=(a[11]!==""||a[16].length!==0?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 self-center")&&g(e,"class",n),c[0]&67584&&s!==(s=a[11]===""&&a[16].length===0)&&(e.disabled=s)},d(a){a&&m(e)}}}function En(r){let e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-5"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 01-1.313-1.313V9.564z" clip-rule="evenodd"></path></svg>',t,n;return{c(){e=C("button"),e.innerHTML=l,this.h()},l(s){e=D(s,"BUTTON",{class:!0,"data-svelte-h":!0}),Se(e)!=="svelte-ciuta7"&&(e.innerHTML=l),this.h()},h(){g(e,"class","bg-white hover:bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5")},m(s,a){N(s,e,a),t||(n=ue(e,"click",r[59]),t=!0)},p:fe,d(s){s&&m(e),t=!1,n()}}}function Tn(r){let e,l,t=r[13]&&_t(r);return{c(){t&&t.c(),e=be()},l(n){t&&t.l(n),e=be()},m(n,s){t&&t.m(n,s),N(n,e,s),l=!0},p(n,s){n[13]?t?(t.p(n,s),s[0]&8192&&v(t,1)):(t=_t(n),t.c(),v(t,1),t.m(e.parentNode,e)):t&&(ne(),T(t,1,1,()=>{t=null}),re())},i(n){l||(v(t),l=!0)},o(n){T(t),l=!1},d(n){n&&m(e),t&&t.d(n)}}}const Ct=r=>r.name;function In(r,e,l){let t,n,s,a;pe(r,ol,o=>l(23,t=o)),pe(r,cl,o=>l(63,s=o)),pe(r,ul,o=>l(25,a=o));let{$$slots:c={},$$scope:i}=e;const u=Ge("i18n");pe(r,u,o=>l(24,n=o));let{placeholder:d=n.t("Type here...")}=e,{id:I=null}=e,{chatInputElement:b}=e,{typingUsers:E=[]}=e,{inputLoading:k=!1}=e,{onSubmit:y=o=>{}}=e,{onChange:w=o=>{}}=e,{onStop:V=o=>{}}=e,{scrollEnd:z=!0}=e,{scrollToBottom:F=()=>{}}=e,{disabled:q=!1}=e,{acceptFiles:M=!0}=e,{showFormattingToolbar:U=!0}=e,{userSuggestions:R=!1}=e,{channelSuggestions:O=!1}=e,{replyToMessage:B=null}=e,{typingUsersClassName:h="from-white dark:from-gray-900"}=e,f=!1,P=!1,G=!1,ee="",H=[],S,W,te=!1,ge,de={},he={};const Ce=async o=>(l(21,de=gl(o)),Object.keys(de).length===0?o:(l(19,te=!0),await new Promise(_=>{l(20,ge=p=>{he={...he,...p},Me(he),l(19,te=!1),_(o)})}))),ve=async o=>{if(o.includes("{{CLIPBOARD}}")){const p=await navigator.clipboard.readText().catch(se=>(me.error(n.t("Failed to read clipboard contents")),"{{CLIPBOARD}}")),K=await navigator.clipboard.read();let x=null;for(const se of K)for(const we of se.types)if(we.startsWith("image/")){const ke=await se.getType(we);x=URL.createObjectURL(ke)}x&&l(16,H=[...H,{type:"image",url:x}]),o=o.replaceAll("{{CLIPBOARD}}",p)}if(o.includes("{{USER_LOCATION}}")){let p;try{p=await hl()}catch{me.error(n.t("Location access not allowed")),p="LOCATION_UNKNOWN"}o=o.replaceAll("{{USER_LOCATION}}",String(p))}const _=await El(localStorage.token);if(o.includes("{{USER_NAME}}")){const p=(_==null?void 0:_.name)||"User";o=o.replaceAll("{{USER_NAME}}",p)}if(o.includes("{{USER_BIO}}")){const p=(_==null?void 0:_.bio)||"";p&&(o=o.replaceAll("{{USER_BIO}}",p))}if(o.includes("{{USER_GENDER}}")){const p=(_==null?void 0:_.gender)||"";p&&(o=o.replaceAll("{{USER_GENDER}}",p))}if(o.includes("{{USER_BIRTH_DATE}}")){const p=(_==null?void 0:_.date_of_birth)||"";p&&(o=o.replaceAll("{{USER_BIRTH_DATE}}",p))}if(o.includes("{{USER_AGE}}")){const p=(_==null?void 0:_.date_of_birth)||"";if(p){const K=_l(p);o=o.replaceAll("{{USER_AGE}}",K)}}if(o.includes("{{USER_LANGUAGE}}")){const p=localStorage.getItem("locale")||"en-US";o=o.replaceAll("{{USER_LANGUAGE}}",p)}if(o.includes("{{CURRENT_DATE}}")){const p=pl();o=o.replaceAll("{{CURRENT_DATE}}",p)}if(o.includes("{{CURRENT_TIME}}")){const p=bl();o=o.replaceAll("{{CURRENT_TIME}}",p)}if(o.includes("{{CURRENT_DATETIME}}")){const p=vl();o=o.replaceAll("{{CURRENT_DATETIME}}",p)}if(o.includes("{{CURRENT_TIMEZONE}}")){const p=wl();o=o.replaceAll("{{CURRENT_TIMEZONE}}",p)}if(o.includes("{{CURRENT_WEEKDAY}}")){const p=kl();o=o.replaceAll("{{CURRENT_WEEKDAY}}",p)}return o},Me=o=>{document.getElementById("chat-input")&&(b.replaceVariables(o),b.focus())},Nt=async(o,_)=>{document.getElementById("chat-input")&&(o!==""&&(o=await ve(o||"")),b==null||b.setText(o),b==null||b.focus(),o!==""&&(o=await Ce(o)),await ce(),_&&await _(o))},Ze=()=>{const o=document.getElementById("chat-input");let _="";return o&&(_=b==null?void 0:b.getWordAtDocPos()),_},Bt=o=>{document.getElementById("chat-input")&&(b==null||b.replaceCommandWithText(o))},Fe=async o=>{const _=document.getElementById("chat-input");if(!_)return;o=await ve(o),ye?Bt(o):b==null||b.insertContent(o),await ce(),o=await Ce(o),await ce();const p=document.getElementById("chat-input-container");p&&(p.scrollTop=p.scrollHeight),await ce(),_&&(_.focus(),_.dispatchEvent(new Event("input")),fl(prompt).length>0?await ce():_.scrollTop=_.scrollHeight)};let ye="",{showCommands:He=!1}=e,Xe=null;const Ft=async()=>{try{const o=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"never"},audio:!1}),_=document.createElement("video");_.srcObject=o,await _.play();const p=document.createElement("canvas");p.width=_.videoWidth,p.height=_.videoHeight,p.getContext("2d").drawImage(_,0,0,p.width,p.height),o.getTracks().forEach(se=>se.stop()),window.focus();const x=p.toDataURL("image/png");l(16,H=[...H,{type:"image",url:x}]),_.srcObject=null}catch(o){}},Ue=async o=>{o.forEach(async _=>{var p,K,x,se;if(console.info("Processing file:",{name:_.name,type:_.type,size:_.size,extension:_.name.split(".").at(-1)}),(((p=s==null?void 0:s.file)==null?void 0:p.max_size)??null)!==null&&_.size>(((K=s==null?void 0:s.file)==null?void 0:K.max_size)??0)*1024*1024){_.size,(((x=s==null?void 0:s.file)==null?void 0:x.max_size)??0)*1024*1024,me.error(n.t("File size should not exceed {{maxSize}} MB.",{maxSize:(se=s==null?void 0:s.file)==null?void 0:se.max_size}));return}if(_.type.startsWith("image/")){const we=async(_e,le={},j={})=>{var xe,et,tt,lt,nt,rt;const Ee=(le==null?void 0:le.imageCompression)??!1,Ve=((et=(xe=j==null?void 0:j.file)==null?void 0:xe.image_compression)==null?void 0:et.width)??null,Re=((lt=(tt=j==null?void 0:j.file)==null?void 0:tt.image_compression)==null?void 0:lt.height)??null;if(!Ee&&!Ve&&!Re)return _e;let Te=null,Ie=null;return Ee&&(Te=((nt=le==null?void 0:le.imageCompressionSize)==null?void 0:nt.width)??null,Ie=((rt=le==null?void 0:le.imageCompressionSize)==null?void 0:rt.height)??null),Ve&&(Te===null||Te>Ve)&&(Te=Ve),Re&&(Ie===null||Ie>Re)&&(Ie=Re),Te||Ie?await yl(_e,Te,Ie):_e};let ke=new FileReader;ke.onload=async _e=>{let le=_e.target.result;t!=null&&t.imageCompression&&(t!=null&&t.imageCompressionInChannels)&&(le=await we(le,t,s)),l(16,H=[...H,{type:"image",url:`${le}`}])},ke.readAsDataURL(_.type==="image/heic"?await dl(_):_)}else Ht(_)})},Ht=async o=>{var K,x,se,we,ke,_e;const _=ml(),p={type:"file",file:"",id:null,url:"",name:o.name,collection_name:"",status:"uploading",size:o.size,error:"",itemId:_};if(p.size==0)return me.error(n.t("You cannot upload an empty file.")),null;l(16,H=[...H,p]);try{let le=null;(o.type.startsWith("audio/")||o.type.startsWith("video/"))&&((x=(K=t==null?void 0:t.audio)==null?void 0:K.stt)!=null&&x.language)&&(le={language:(we=(se=t==null?void 0:t.audio)==null?void 0:se.stt)==null?void 0:we.language});const j=await Tl(localStorage.token,o,le);j?(console.info("File upload completed:",{id:j.id,name:p.name,collection:(ke=j==null?void 0:j.meta)==null?void 0:ke.collection_name}),j.error&&(j.error,me.warning(j.error)),p.status="uploaded",p.file=j,p.id=j.id,p.collection_name=((_e=j==null?void 0:j.meta)==null?void 0:_e.collection_name)||(j==null?void 0:j.collection_name),p.url=`${Pe}/files/${j.id}`,l(16,H)):l(16,H=H.filter(Ee=>(Ee==null?void 0:Ee.itemId)!==_))}catch(le){me.error(`${le}`),l(16,H=H.filter(j=>(j==null?void 0:j.itemId)!==_))}},Ye=o=>{o.key==="Escape"&&l(14,P=!1)},Je=o=>{var _,p;o.preventDefault(),(p=(_=o.dataTransfer)==null?void 0:_.types)!=null&&p.includes("Files")?l(14,P=!0):l(14,P=!1)},Qe=()=>{l(14,P=!1)},$e=async o=>{var _,p;if(o.preventDefault(),(_=o.dataTransfer)!=null&&_.files&&M){const K=Array.from((p=o.dataTransfer)==null?void 0:p.files);K&&K.length>0&&Ue(K)}l(14,P=!1)},ze=async()=>{ee===""&&H.length===0||(y({content:ee,data:{files:H}}),l(11,ee=""),l(16,H=[]),b&&(b==null||b.setText(""),await ce(),b.focus()))};Ut(async()=>{l(22,Xe=[{char:"@",render:Oe(mt,{i18n:u,triggerChar:"@",modelSuggestions:!0,userSuggestions:R})},...O?[{char:"#",render:Oe(mt,{i18n:u,triggerChar:"#",channelSuggestions:O})}]:[],{char:"/",render:Oe(Al,{i18n:u,onSelect:_=>{var x;const{type:p,data:K}=_;(x=document.getElementById("chat-input"))==null||x.focus()},insertTextHandler:Fe,onUpload:_=>{const{type:p,data:K}=_;if(p==="file"){if(H.find(x=>x.id===K.id))return;l(16,H=[...H,{...K,status:"processed"}])}}})}]),l(13,f=!0),window.setTimeout(()=>{b&&b.focus()},100),window.addEventListener("keydown",Ye),await ce();const o=document.getElementById("channel-container");o==null||o.addEventListener("dragover",Je),o==null||o.addEventListener("drop",$e),o==null||o.addEventListener("dragleave",Qe)}),Vt(()=>{window.removeEventListener("keydown",Ye);const o=document.getElementById("channel-container");o&&(o==null||o.removeEventListener("dragover",Je),o==null||o.removeEventListener("drop",$e),o==null||o.removeEventListener("dragleave",Qe))});function zt(o){De[o?"unshift":"push"](()=>{S=o,l(17,S)})}function Ot(){W=this.files,l(18,W)}const Pt=async()=>{W&&W.length>0?Ue(Array.from(W)):me.error(n.t("File not found.")),l(17,S.value="",S)};function Wt(o){te=o,l(19,te)}const jt=()=>{l(1,z=!0),F()},Kt=async()=>{l(15,G=!1),await ce(),b&&b.focus()},qt=async o=>{const{text:_,filename:p}=o;l(15,G=!1),await ce(),Fe(_),await ce(),b&&b.focus()};function Gt(o){G=o,l(15,G)}const Zt=()=>{l(2,B=null)},Xt=o=>{H.splice(o,1),l(16,H)},Yt=o=>{H.splice(o,1),l(16,H)},Jt=o=>{},Qt=o=>{const{md:_}=o;l(11,ee=_),l(12,ye=Ze())};function $t(o){De[o?"unshift":"push"](()=>{b=o,l(0,b)})}const xt=async o=>{o=o.detail.event,o.ctrlKey||o.metaKey,document.getElementById("suggestions-container")||(!a||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0))&&(o.keyCode===13&&!o.shiftKey&&o.preventDefault(),ee!==""&&o.keyCode===13&&!o.shiftKey&&ze()),o.key==="Escape"&&(console.info("Escape"),l(2,B=null))},el=async o=>{o=o.detail.event;const _=o.clipboardData||window.clipboardData;if(_&&_.items){for(const p of _.items)if(p.type.indexOf("image")!==-1){const K=p.getAsFile(),x=new FileReader;x.onload=function(se){l(16,H=[...H,{type:"image",url:`${se.target.result}`}])},x.readAsDataURL(K)}else if((p==null?void 0:p.kind)==="file"){const K=p.getAsFile();K&&(await Ue([K]),o.preventDefault())}}},tl=()=>{S.click()},ll=async()=>{try{let o=await navigator.mediaDevices.getUserMedia({audio:!0}).catch(function(_){return me.error(n.t("Permission denied when accessing microphone: {{error}}",{error:_})),null});o&&(l(15,G=!0),o.getTracks().forEach(p=>p.stop())),o=null}catch{me.error(n.t("Permission denied when accessing microphone"))}},nl=()=>{V()},rl=()=>{ze()};return r.$$set=o=>{"placeholder"in o&&l(3,d=o.placeholder),"id"in o&&l(33,I=o.id),"chatInputElement"in o&&l(0,b=o.chatInputElement),"typingUsers"in o&&l(4,E=o.typingUsers),"inputLoading"in o&&l(5,k=o.inputLoading),"onSubmit"in o&&l(34,y=o.onSubmit),"onChange"in o&&l(35,w=o.onChange),"onStop"in o&&l(6,V=o.onStop),"scrollEnd"in o&&l(1,z=o.scrollEnd),"scrollToBottom"in o&&l(7,F=o.scrollToBottom),"disabled"in o&&l(8,q=o.disabled),"acceptFiles"in o&&l(9,M=o.acceptFiles),"showFormattingToolbar"in o&&l(36,U=o.showFormattingToolbar),"userSuggestions"in o&&l(37,R=o.userSuggestions),"channelSuggestions"in o&&l(38,O=o.channelSuggestions),"replyToMessage"in o&&l(2,B=o.replyToMessage),"typingUsersClassName"in o&&l(10,h=o.typingUsersClassName),"showCommands"in o&&l(32,He=o.showCommands),"$$scope"in o&&l(61,i=o.$$scope)},r.$$.update=()=>{r.$$.dirty[0]&4096&&l(32,He=["/"].includes(ye==null?void 0:ye.charAt(0))),r.$$.dirty[0]&2048|r.$$.dirty[1]&16&&ee&&w()},[b,z,B,d,E,k,V,F,q,M,h,ee,ye,f,P,G,H,S,W,te,ge,de,Xe,t,n,a,u,Ze,Fe,Ft,Ue,ze,He,I,y,w,U,R,O,Nt,c,zt,Ot,Pt,Wt,jt,Kt,qt,Gt,Zt,Xt,Yt,Jt,Qt,$t,xt,el,tl,ll,nl,rl,i]}class Zn extends We{constructor(e){super(),je(this,e,In,Tn,Be,{placeholder:3,id:33,chatInputElement:0,typingUsers:4,inputLoading:5,onSubmit:34,onChange:35,onStop:6,scrollEnd:1,scrollToBottom:7,disabled:8,acceptFiles:9,showFormattingToolbar:36,userSuggestions:37,channelSuggestions:38,replyToMessage:2,typingUsersClassName:10,setText:39,showCommands:32},null,[-1,-1,-1])}get setText(){return this.$$.ctx[39]}}export{Zn as M};
//# sourceMappingURL=B8AuHMce.js.map
