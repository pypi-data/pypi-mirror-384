import{g as A}from"./BzMu2T5T.js";import{L as ot}from"./Dl9eNJPw.js";import{d as at}from"./WBzL16iB.js";import{Y as K,i as rt,a as F,b as ct,s as Ke,S as O,m as D,o as he,p as pe,c as de,M as lt,d as C,e as ft,f as ut,g as H,h as me,j as Ie,l as ht,N as Ae,D as Oe,k as Q,n as pt,q as dt,A as Me,r as mt,t as v,P as Z,u as V,v as G,w as $e,x as yt,y as gt,z as wt,B as qe,L as bt,C as kt,E as Tt}from"./BFK-koEx.js";import"./IHki7fMi.js";import"./D1AOsjeD.js";const q={collection:"map",default:!0,nodeClass:K,tag:"tag:yaml.org,2002:map",resolve(s,e){return rt(s)||e("Expected a mapping for this tag"),s},createNode:(s,e,t)=>K.from(s,e,t)},R={collection:"seq",default:!0,nodeClass:F,tag:"tag:yaml.org,2002:seq",resolve(s,e){return ct(s)||e("Expected a sequence for this tag"),s},createNode:(s,e,t)=>F.from(s,e,t)},ee={identify:s=>typeof s=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:s=>s,stringify(s,e,t,n){return e=Object.assign({actualString:!0},e),Ke(s,e,t,n)}},te={identify:s=>s==null,createNode:()=>new O(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new O(null),stringify:({source:s},e)=>typeof s=="string"&&te.test.test(s)?s:e.options.nullStr},ye={identify:s=>typeof s=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:s=>new O(s[0]==="t"||s[0]==="T"),stringify({source:s,value:e},t){if(s&&ye.test.test(s)){const n=s[0]==="t"||s[0]==="T";if(e===n)return s}return e?t.options.trueStr:t.options.falseStr}};function E({format:s,minFractionDigits:e,tag:t,value:n}){if(typeof n=="bigint")return String(n);const i=typeof n=="number"?n:Number(n);if(!isFinite(i))return isNaN(i)?".nan":i<0?"-.inf":".inf";let o=JSON.stringify(n);if(!s&&e&&(!t||t==="tag:yaml.org,2002:float")&&/^\d/.test(o)){let a=o.indexOf(".");a<0&&(a=o.length,o+=".");let r=e-(o.length-a-1);for(;r-- >0;)o+="0"}return o}const Re={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:s=>s.slice(-3).toLowerCase()==="nan"?NaN:s[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:E},Ue={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:s=>parseFloat(s),stringify(s){const e=Number(s.value);return isFinite(e)?e.toExponential():E(s)}},xe={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(s){const e=new O(parseFloat(s)),t=s.indexOf(".");return t!==-1&&s[s.length-1]==="0"&&(e.minFractionDigits=s.length-t-1),e},stringify:E},se=s=>typeof s=="bigint"||Number.isInteger(s),ge=(s,e,t,{intAsBigInt:n})=>n?BigInt(s):parseInt(s.substring(e),t);function Fe(s,e,t){const{value:n}=s;return se(n)&&n>=0?t+n.toString(e):E(s)}const Ge={identify:s=>se(s)&&s>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(s,e,t)=>ge(s,2,8,t),stringify:s=>Fe(s,8,"0o")},Je={identify:se,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(s,e,t)=>ge(s,0,10,t),stringify:E},Ye={identify:s=>se(s)&&s>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(s,e,t)=>ge(s,2,16,t),stringify:s=>Fe(s,16,"0x")},St=[q,R,ee,te,ye,Ge,Je,Ye,Re,Ue,xe];function _e(s){return typeof s=="bigint"||Number.isInteger(s)}const W=({value:s})=>JSON.stringify(s),Nt=[{identify:s=>typeof s=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:s=>s,stringify:W},{identify:s=>s==null,createNode:()=>new O(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:W},{identify:s=>typeof s=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:s=>s==="true",stringify:W},{identify:_e,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(s,e,{intAsBigInt:t})=>t?BigInt(s):parseInt(s,10),stringify:({value:s})=>_e(s)?s.toString():JSON.stringify(s)},{identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:s=>parseFloat(s),stringify:W}],It={default:!0,tag:"",test:/^/,resolve(s,e){return e(`Unresolved plain scalar ${JSON.stringify(s)}`),s}},At=[q,R].concat(Nt,It),we={identify:s=>s instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(s,e){if(typeof atob=="function"){const t=atob(s.replace(/[\n\r]/g,"")),n=new Uint8Array(t.length);for(let i=0;i<t.length;++i)n[i]=t.charCodeAt(i);return n}else return e("This environment does not support reading binary tags; either Buffer or atob is required"),s},stringify({comment:s,type:e,value:t},n,i,o){if(!t)return"";const a=t;let r;if(typeof btoa=="function"){let c="";for(let l=0;l<a.length;++l)c+=String.fromCharCode(a[l]);r=btoa(c)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(e||(e=O.BLOCK_LITERAL),e!==O.QUOTE_DOUBLE){const c=Math.max(n.options.lineWidth-n.indent.length,n.options.minContentWidth),l=Math.ceil(r.length/c),u=new Array(l);for(let f=0,d=0;f<l;++f,d+=c)u[f]=r.substr(d,c);r=u.join(e===O.BLOCK_LITERAL?`
`:" ")}return Ke({comment:s,type:e,value:r},n,i,o)}};function ze({value:s,source:e},t){return e&&(s?He:Ve).test.test(e)?e:s?t.options.trueStr:t.options.falseStr}const He={identify:s=>s===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new O(!0),stringify:ze},Ve={identify:s=>s===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new O(!1),stringify:ze},Ot={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:s=>s.slice(-3).toLowerCase()==="nan"?NaN:s[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:E},$t={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:s=>parseFloat(s.replace(/_/g,"")),stringify(s){const e=Number(s.value);return isFinite(e)?e.toExponential():E(s)}},_t={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(s){const e=new O(parseFloat(s.replace(/_/g,""))),t=s.indexOf(".");if(t!==-1){const n=s.substring(t+1).replace(/_/g,"");n[n.length-1]==="0"&&(e.minFractionDigits=n.length)}return e},stringify:E},Y=s=>typeof s=="bigint"||Number.isInteger(s);function ne(s,e,t,{intAsBigInt:n}){const i=s[0];if((i==="-"||i==="+")&&(e+=1),s=s.substring(e).replace(/_/g,""),n){switch(t){case 2:s=`0b${s}`;break;case 8:s=`0o${s}`;break;case 16:s=`0x${s}`;break}const a=BigInt(s);return i==="-"?BigInt(-1)*a:a}const o=parseInt(s,t);return i==="-"?-1*o:o}function be(s,e,t){const{value:n}=s;if(Y(n)){const i=n.toString(e);return n<0?"-"+t+i.substr(1):t+i}return E(s)}const Et={identify:Y,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(s,e,t)=>ne(s,2,2,t),stringify:s=>be(s,2,"0b")},jt={identify:Y,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(s,e,t)=>ne(s,1,8,t),stringify:s=>be(s,8,"0")},vt={identify:Y,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(s,e,t)=>ne(s,0,10,t),stringify:E},Ct={identify:Y,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(s,e,t)=>ne(s,2,16,t),stringify:s=>be(s,16,"0x")};function ke(s,e){const t=s[0],n=t==="-"||t==="+"?s.substring(1):s,i=a=>e?BigInt(a):Number(a),o=n.replace(/_/g,"").split(":").reduce((a,r)=>a*i(60)+i(r),i(0));return t==="-"?i(-1)*o:o}function We(s){let{value:e}=s,t=a=>a;if(typeof e=="bigint")t=a=>BigInt(a);else if(isNaN(e)||!isFinite(e))return E(s);let n="";e<0&&(n="-",e*=t(-1));const i=t(60),o=[e%i];return e<60?o.unshift(0):(e=(e-o[0])/i,o.unshift(e%i),e>=60&&(e=(e-o[0])/i,o.unshift(e))),n+o.map(a=>String(a).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const Xe={identify:s=>typeof s=="bigint"||Number.isInteger(s),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(s,e,{intAsBigInt:t})=>ke(s,t),stringify:We},Qe={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:s=>ke(s,!1),stringify:We},ie={identify:s=>s instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(s){const e=s.match(ie.test);if(!e)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,t,n,i,o,a,r]=e.map(Number),c=e[7]?Number((e[7]+"00").substr(1,3)):0;let l=Date.UTC(t,n-1,i,o||0,a||0,r||0,c);const u=e[8];if(u&&u!=="Z"){let f=ke(u,!1);Math.abs(f)<30&&(f*=60),l-=6e4*f}return new Date(l)},stringify:({value:s})=>(s==null?void 0:s.toISOString().replace(/(T00:00:00)?\.000Z$/,""))??""},Ee=[q,R,ee,te,He,Ve,Et,jt,vt,Ct,Ot,$t,_t,we,D,he,pe,de,Xe,Qe,ie],je=new Map([["core",St],["failsafe",[q,R,ee]],["json",At],["yaml11",Ee],["yaml-1.1",Ee]]),ve={binary:we,bool:ye,float:xe,floatExp:Ue,floatNaN:Re,floatTime:Qe,int:Je,intHex:Ye,intOct:Ge,intTime:Xe,map:q,merge:D,null:te,omap:he,pairs:pe,seq:R,set:de,timestamp:ie},Lt={"tag:yaml.org,2002:binary":we,"tag:yaml.org,2002:merge":D,"tag:yaml.org,2002:omap":he,"tag:yaml.org,2002:pairs":pe,"tag:yaml.org,2002:set":de,"tag:yaml.org,2002:timestamp":ie};function re(s,e,t){const n=je.get(e);if(n&&!s)return t&&!n.includes(D)?n.concat(D):n.slice();let i=n;if(!i)if(Array.isArray(s))i=[];else{const o=Array.from(je.keys()).filter(a=>a!=="yaml11").map(a=>JSON.stringify(a)).join(", ");throw new Error(`Unknown schema "${e}"; use one of ${o} or define customTags array`)}if(Array.isArray(s))for(const o of s)i=i.concat(o);else typeof s=="function"&&(i=s(i.slice()));return t&&(i=i.concat(D)),i.reduce((o,a)=>{const r=typeof a=="string"?ve[a]:a;if(!r){const c=JSON.stringify(a),l=Object.keys(ve).map(u=>JSON.stringify(u)).join(", ");throw new Error(`Unknown custom tag ${c}; use one of ${l}`)}return o.includes(r)||o.push(r),o},[])}const Pt=(s,e)=>s.key<e.key?-1:s.key>e.key?1:0;class Te{constructor({compat:e,customTags:t,merge:n,resolveKnownTags:i,schema:o,sortMapEntries:a,toStringDefaults:r}){this.compat=Array.isArray(e)?re(e,"compat"):e?re(null,e):null,this.name=typeof o=="string"&&o||"core",this.knownTags=i?Lt:{},this.tags=re(t,this.name,n),this.toStringOptions=r??null,Object.defineProperty(this,lt,{value:q}),Object.defineProperty(this,C,{value:ee}),Object.defineProperty(this,ft,{value:R}),this.sortMapEntries=typeof a=="function"?a:a===!0?Pt:null}clone(){const e=Object.create(Te.prototype,Object.getOwnPropertyDescriptors(this));return e.tags=this.tags.slice(),e}}function Bt(s,e){var c;const t=[];let n=e.directives===!0;if(e.directives!==!1&&s.directives){const l=s.directives.toString(s);l?(t.push(l),n=!0):s.directives.docStart&&(n=!0)}n&&t.push("---");const i=ut(s,e),{commentString:o}=i.options;if(s.commentBefore){t.length!==1&&t.unshift("");const l=o(s.commentBefore);t.unshift(H(l,""))}let a=!1,r=null;if(s.contents){if(me(s.contents)){if(s.contents.spaceBefore&&n&&t.push(""),s.contents.commentBefore){const f=o(s.contents.commentBefore);t.push(H(f,""))}i.forceBlockIndent=!!s.comment,r=s.contents.comment}const l=r?void 0:()=>a=!0;let u=Ie(s.contents,i,()=>r=null,l);r&&(u+=ht(u,"",o(r))),(u[0]==="|"||u[0]===">")&&t[t.length-1]==="---"?t[t.length-1]=`--- ${u}`:t.push(u)}else t.push(Ie(s.contents,i));if((c=s.directives)!=null&&c.docEnd)if(s.comment){const l=o(s.comment);l.includes(`
`)?(t.push("..."),t.push(H(l,""))):t.push(`... ${l}`)}else t.push("...");else{let l=s.comment;l&&a&&(l=l.replace(/^\n+/,"")),l&&((!a||r)&&t[t.length-1]!==""&&t.push(""),t.push(H(o(l),"")))}return t.join(`
`)+`
`}class oe{constructor(e,t,n){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,Ae,{value:Oe});let i=null;typeof t=="function"||Array.isArray(t)?i=t:n===void 0&&t&&(n=t,t=void 0);const o=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,stringKeys:!1,uniqueKeys:!0,version:"1.2"},n);this.options=o;let{version:a}=o;n!=null&&n._directives?(this.directives=n._directives.atDocument(),this.directives.yaml.explicit&&(a=this.directives.yaml.version)):this.directives=new Q({version:a}),this.setSchema(a,n),this.contents=e===void 0?null:this.createNode(e,i,n)}clone(){const e=Object.create(oe.prototype,{[Ae]:{value:Oe}});return e.commentBefore=this.commentBefore,e.comment=this.comment,e.errors=this.errors.slice(),e.warnings=this.warnings.slice(),e.options=Object.assign({},this.options),this.directives&&(e.directives=this.directives.clone()),e.schema=this.schema.clone(),e.contents=me(this.contents)?this.contents.clone(e.schema):this.contents,this.range&&(e.range=this.range.slice()),e}add(e){P(this.contents)&&this.contents.add(e)}addIn(e,t){P(this.contents)&&this.contents.addIn(e,t)}createAlias(e,t){if(!e.anchor){const n=pt(this);e.anchor=!t||n.has(t)?dt(t||"a",n):t}return new Me(e.anchor)}createNode(e,t,n){let i;if(typeof t=="function")e=t.call({"":e},"",e),i=t;else if(Array.isArray(t)){const m=S=>typeof S=="number"||S instanceof String||S instanceof Number,g=t.filter(m).map(String);g.length>0&&(t=t.concat(g)),i=t}else n===void 0&&t&&(n=t,t=void 0);const{aliasDuplicateObjects:o,anchorPrefix:a,flow:r,keepUndefined:c,onTagObj:l,tag:u}=n??{},{onAnchor:f,setAnchors:d,sourceObjects:h}=wt(this,a||"a"),b={aliasDuplicateObjects:o??!0,keepUndefined:c??!1,onAnchor:f,onTagObj:l,replacer:i,schema:this.schema,sourceObjects:h},p=mt(e,u,b);return r&&v(p)&&(p.flow=!0),d(),p}createPair(e,t,n={}){const i=this.createNode(e,null,n),o=this.createNode(t,null,n);return new Z(i,o)}delete(e){return P(this.contents)?this.contents.delete(e):!1}deleteIn(e){return V(e)?this.contents==null?!1:(this.contents=null,!0):P(this.contents)?this.contents.deleteIn(e):!1}get(e,t){return v(this.contents)?this.contents.get(e,t):void 0}getIn(e,t){return V(e)?!t&&G(this.contents)?this.contents.value:this.contents:v(this.contents)?this.contents.getIn(e,t):void 0}has(e){return v(this.contents)?this.contents.has(e):!1}hasIn(e){return V(e)?this.contents!==void 0:v(this.contents)?this.contents.hasIn(e):!1}set(e,t){this.contents==null?this.contents=$e(this.schema,[e],t):P(this.contents)&&this.contents.set(e,t)}setIn(e,t){V(e)?this.contents=t:this.contents==null?this.contents=$e(this.schema,Array.from(e),t):P(this.contents)&&this.contents.setIn(e,t)}setSchema(e,t={}){typeof e=="number"&&(e=String(e));let n;switch(e){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new Q({version:"1.1"}),n={resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=e:this.directives=new Q({version:e}),n={resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,n=null;break;default:{const i=JSON.stringify(e);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${i}`)}}if(t.schema instanceof Object)this.schema=t.schema;else if(n)this.schema=new Te(Object.assign(n,t));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:e,jsonArg:t,mapAsMap:n,maxAliasCount:i,onAnchor:o,reviver:a}={}){const r={anchors:new Map,doc:this,keep:!e,mapAsMap:n===!0,mapKeyWarned:!1,maxAliasCount:typeof i=="number"?i:100},c=yt(this.contents,t??"",r);if(typeof o=="function")for(const{count:l,res:u}of r.anchors.values())o(u,l);return typeof a=="function"?gt(a,{"":c},"",c):c}toJSON(e,t){return this.toJS({json:!0,jsonArg:e,mapAsMap:!1,onAnchor:t})}toString(e={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in e&&(!Number.isInteger(e.indent)||Number(e.indent)<=0)){const t=JSON.stringify(e.indent);throw new Error(`"indent" option must be a positive integer, not ${t}`)}return Bt(this,e)}}function P(s){if(v(s))return!0;throw new Error("Expected a YAML collection as document contents")}class Ze extends Error{constructor(e,t,n,i){super(),this.name=e,this.code=n,this.message=i,this.pos=t}}class x extends Ze{constructor(e,t,n){super("YAMLParseError",e,t,n)}}class Dt extends Ze{constructor(e,t,n){super("YAMLWarning",e,t,n)}}const Ce=(s,e)=>t=>{if(t.pos[0]===-1)return;t.linePos=t.pos.map(r=>e.linePos(r));const{line:n,col:i}=t.linePos[0];t.message+=` at line ${n}, column ${i}`;let o=i-1,a=s.substring(e.lineStarts[n-1],e.lineStarts[n]).replace(/[\n\r]+$/,"");if(o>=60&&a.length>80){const r=Math.min(o-39,a.length-79);a="…"+a.substring(r),o-=r-1}if(a.length>80&&(a=a.substring(0,79)+"…"),n>1&&/^ *$/.test(a.substring(0,o))){let r=s.substring(e.lineStarts[n-2],e.lineStarts[n-1]);r.length>80&&(r=r.substring(0,79)+`…
`),a=r+a}if(/[^ ]/.test(a)){let r=1;const c=t.linePos[1];c&&c.line===n&&c.col>i&&(r=Math.max(1,Math.min(c.col-i,80-o)));const l=" ".repeat(o)+"^".repeat(r);t.message+=`:

${a}
${l}
`}};function M(s,{flow:e,indicator:t,next:n,offset:i,onError:o,parentIndent:a,startOnNewline:r}){let c=!1,l=r,u=r,f="",d="",h=!1,b=!1,p=null,m=null,g=null,S=null,I=null,T=null,k=null;for(const y of s)switch(b&&(y.type!=="space"&&y.type!=="newline"&&y.type!=="comma"&&o(y.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),b=!1),p&&(l&&y.type!=="comment"&&y.type!=="newline"&&o(p,"TAB_AS_INDENT","Tabs are not allowed as indentation"),p=null),y.type){case"space":!e&&(t!=="doc-start"||(n==null?void 0:n.type)!=="flow-collection")&&y.source.includes("	")&&(p=y),u=!0;break;case"comment":{u||o(y,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const $=y.source.substring(1)||" ";f?f+=d+$:f=$,d="",l=!1;break}case"newline":l?f?f+=y.source:(!T||t!=="seq-item-ind")&&(c=!0):d+=y.source,l=!0,h=!0,(m||g)&&(S=y),u=!0;break;case"anchor":m&&o(y,"MULTIPLE_ANCHORS","A node can have at most one anchor"),y.source.endsWith(":")&&o(y.offset+y.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),m=y,k===null&&(k=y.offset),l=!1,u=!1,b=!0;break;case"tag":{g&&o(y,"MULTIPLE_TAGS","A node can have at most one tag"),g=y,k===null&&(k=y.offset),l=!1,u=!1,b=!0;break}case t:(m||g)&&o(y,"BAD_PROP_ORDER",`Anchors and tags must be after the ${y.source} indicator`),T&&o(y,"UNEXPECTED_TOKEN",`Unexpected ${y.source} in ${e??"collection"}`),T=y,l=t==="seq-item-ind"||t==="explicit-key-ind",u=!1;break;case"comma":if(e){I&&o(y,"UNEXPECTED_TOKEN",`Unexpected , in ${e}`),I=y,l=!1,u=!1;break}default:o(y,"UNEXPECTED_TOKEN",`Unexpected ${y.type} token`),l=!1,u=!1}const w=s[s.length-1],N=w?w.offset+w.source.length:i;return b&&n&&n.type!=="space"&&n.type!=="newline"&&n.type!=="comma"&&(n.type!=="scalar"||n.source!=="")&&o(n.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),p&&(l&&p.indent<=a||(n==null?void 0:n.type)==="block-map"||(n==null?void 0:n.type)==="block-seq")&&o(p,"TAB_AS_INDENT","Tabs are not allowed as indentation"),{comma:I,found:T,spaceBefore:c,comment:f,hasNewline:h,anchor:m,tag:g,newlineAfterProp:S,end:N,start:k??N}}function J(s){if(!s)return null;switch(s.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(s.source.includes(`
`))return!0;if(s.end){for(const e of s.end)if(e.type==="newline")return!0}return!1;case"flow-collection":for(const e of s.items){for(const t of e.start)if(t.type==="newline")return!0;if(e.sep){for(const t of e.sep)if(t.type==="newline")return!0}if(J(e.key)||J(e.value))return!0}return!1;default:return!0}}function ue(s,e,t){if((e==null?void 0:e.type)==="flow-collection"){const n=e.end[0];n.indent===s&&(n.source==="]"||n.source==="}")&&J(e)&&t(n,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function et(s,e,t){const{uniqueKeys:n}=s.options;if(n===!1)return!1;const i=typeof n=="function"?n:(o,a)=>o===a||G(o)&&G(a)&&o.value===a.value;return e.some(o=>i(o.key,t))}const Le="All mapping items must start at the same column";function Kt({composeNode:s,composeEmptyNode:e},t,n,i,o){var u;const a=(o==null?void 0:o.nodeClass)??K,r=new a(t.schema);t.atRoot&&(t.atRoot=!1);let c=n.offset,l=null;for(const f of n.items){const{start:d,key:h,sep:b,value:p}=f,m=M(d,{indicator:"explicit-key-ind",next:h??(b==null?void 0:b[0]),offset:c,onError:i,parentIndent:n.indent,startOnNewline:!0}),g=!m.found;if(g){if(h&&(h.type==="block-seq"?i(c,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in h&&h.indent!==n.indent&&i(c,"BAD_INDENT",Le)),!m.anchor&&!m.tag&&!b){l=m.end,m.comment&&(r.comment?r.comment+=`
`+m.comment:r.comment=m.comment);continue}(m.newlineAfterProp||J(h))&&i(h??d[d.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else((u=m.found)==null?void 0:u.indent)!==n.indent&&i(c,"BAD_INDENT",Le);t.atKey=!0;const S=m.end,I=h?s(t,h,m,i):e(t,S,d,null,m,i);t.schema.compat&&ue(n.indent,h,i),t.atKey=!1,et(t,r.items,I)&&i(S,"DUPLICATE_KEY","Map keys must be unique");const T=M(b??[],{indicator:"map-value-ind",next:p,offset:I.range[2],onError:i,parentIndent:n.indent,startOnNewline:!h||h.type==="block-scalar"});if(c=T.end,T.found){g&&((p==null?void 0:p.type)==="block-map"&&!T.hasNewline&&i(c,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),t.options.strict&&m.start<T.found.offset-1024&&i(I.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const k=p?s(t,p,T,i):e(t,c,b,null,T,i);t.schema.compat&&ue(n.indent,p,i),c=k.range[2];const w=new Z(I,k);t.options.keepSourceTokens&&(w.srcToken=f),r.items.push(w)}else{g&&i(I.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),T.comment&&(I.comment?I.comment+=`
`+T.comment:I.comment=T.comment);const k=new Z(I);t.options.keepSourceTokens&&(k.srcToken=f),r.items.push(k)}}return l&&l<c&&i(l,"IMPOSSIBLE","Map comment with trailing content"),r.range=[n.offset,c,l??c],r}function Mt({composeNode:s,composeEmptyNode:e},t,n,i,o){const a=(o==null?void 0:o.nodeClass)??F,r=new a(t.schema);t.atRoot&&(t.atRoot=!1),t.atKey&&(t.atKey=!1);let c=n.offset,l=null;for(const{start:u,value:f}of n.items){const d=M(u,{indicator:"seq-item-ind",next:f,offset:c,onError:i,parentIndent:n.indent,startOnNewline:!0});if(!d.found)if(d.anchor||d.tag||f)f&&f.type==="block-seq"?i(d.end,"BAD_INDENT","All sequence items must start at the same column"):i(c,"MISSING_CHAR","Sequence item without - indicator");else{l=d.end,d.comment&&(r.comment=d.comment);continue}const h=f?s(t,f,d,i):e(t,d.end,u,null,d,i);t.schema.compat&&ue(n.indent,f,i),c=h.range[2],r.items.push(h)}return r.range=[n.offset,c,l??c],r}function z(s,e,t,n){let i="";if(s){let o=!1,a="";for(const r of s){const{source:c,type:l}=r;switch(l){case"space":o=!0;break;case"comment":{t&&!o&&n(r,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const u=c.substring(1)||" ";i?i+=a+u:i=u,a="";break}case"newline":i&&(a+=c),o=!0;break;default:n(r,"UNEXPECTED_TOKEN",`Unexpected ${l} at node end`)}e+=c.length}}return{comment:i,offset:e}}const ce="Block collections are not allowed within flow collections",le=s=>s&&(s.type==="block-map"||s.type==="block-seq");function qt({composeNode:s,composeEmptyNode:e},t,n,i,o){const a=n.start.source==="{",r=a?"flow map":"flow sequence",c=(o==null?void 0:o.nodeClass)??(a?K:F),l=new c(t.schema);l.flow=!0;const u=t.atRoot;u&&(t.atRoot=!1),t.atKey&&(t.atKey=!1);let f=n.offset+n.start.source.length;for(let m=0;m<n.items.length;++m){const g=n.items[m],{start:S,key:I,sep:T,value:k}=g,w=M(S,{flow:r,indicator:"explicit-key-ind",next:I??(T==null?void 0:T[0]),offset:f,onError:i,parentIndent:n.indent,startOnNewline:!1});if(!w.found){if(!w.anchor&&!w.tag&&!T&&!k){m===0&&w.comma?i(w.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${r}`):m<n.items.length-1&&i(w.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${r}`),w.comment&&(l.comment?l.comment+=`
`+w.comment:l.comment=w.comment),f=w.end;continue}!a&&t.options.strict&&J(I)&&i(I,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(m===0)w.comma&&i(w.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${r}`);else if(w.comma||i(w.start,"MISSING_CHAR",`Missing , between ${r} items`),w.comment){let N="";e:for(const y of S)switch(y.type){case"comma":case"space":break;case"comment":N=y.source.substring(1);break e;default:break e}if(N){let y=l.items[l.items.length-1];qe(y)&&(y=y.value??y.key),y.comment?y.comment+=`
`+N:y.comment=N,w.comment=w.comment.substring(N.length+1)}}if(!a&&!T&&!w.found){const N=k?s(t,k,w,i):e(t,w.end,T,null,w,i);l.items.push(N),f=N.range[2],le(k)&&i(N.range,"BLOCK_IN_FLOW",ce)}else{t.atKey=!0;const N=w.end,y=I?s(t,I,w,i):e(t,N,S,null,w,i);le(I)&&i(y.range,"BLOCK_IN_FLOW",ce),t.atKey=!1;const $=M(T??[],{flow:r,indicator:"map-value-ind",next:k,offset:y.range[2],onError:i,parentIndent:n.indent,startOnNewline:!1});if($.found){if(!a&&!w.found&&t.options.strict){if(T)for(const _ of T){if(_===$.found)break;if(_.type==="newline"){i(_,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}w.start<$.found.offset-1024&&i($.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else k&&("source"in k&&k.source&&k.source[0]===":"?i(k,"MISSING_CHAR",`Missing space after : in ${r}`):i($.start,"MISSING_CHAR",`Missing , or : between ${r} items`));const L=k?s(t,k,$,i):$.found?e(t,$.end,T,null,$,i):null;L?le(k)&&i(L.range,"BLOCK_IN_FLOW",ce):$.comment&&(y.comment?y.comment+=`
`+$.comment:y.comment=$.comment);const ae=new Z(y,L);if(t.options.keepSourceTokens&&(ae.srcToken=g),a){const _=l;et(t,_.items,y)&&i(N,"DUPLICATE_KEY","Map keys must be unique"),_.items.push(ae)}else{const _=new K(t.schema);_.flow=!0,_.items.push(ae);const Ne=(L??y).range;_.range=[y.range[0],Ne[1],Ne[2]],l.items.push(_)}f=L?L.range[2]:$.end}}const d=a?"}":"]",[h,...b]=n.end;let p=f;if(h&&h.source===d)p=h.offset+h.source.length;else{const m=r[0].toUpperCase()+r.substring(1),g=u?`${m} must end with a ${d}`:`${m} in block collection must be sufficiently indented and end with a ${d}`;i(f,u?"MISSING_CHAR":"BAD_INDENT",g),h&&h.source.length!==1&&b.unshift(h)}if(b.length>0){const m=z(b,p,t.options.strict,i);m.comment&&(l.comment?l.comment+=`
`+m.comment:l.comment=m.comment),l.range=[n.offset,p,m.offset]}else l.range=[n.offset,p,p];return l}function fe(s,e,t,n,i,o){const a=t.type==="block-map"?Kt(s,e,t,n,o):t.type==="block-seq"?Mt(s,e,t,n,o):qt(s,e,t,n,o),r=a.constructor;return i==="!"||i===r.tagName?(a.tag=r.tagName,a):(i&&(a.tag=i),a)}function Rt(s,e,t,n,i){var d;const o=n.tag,a=o?e.directives.tagName(o.source,h=>i(o,"TAG_RESOLVE_FAILED",h)):null;if(t.type==="block-seq"){const{anchor:h,newlineAfterProp:b}=n,p=h&&o?h.offset>o.offset?h:o:h??o;p&&(!b||b.offset<p.offset)&&i(p,"MISSING_CHAR","Missing newline after block sequence props")}const r=t.type==="block-map"?"map":t.type==="block-seq"?"seq":t.start.source==="{"?"map":"seq";if(!o||!a||a==="!"||a===K.tagName&&r==="map"||a===F.tagName&&r==="seq")return fe(s,e,t,i,a);let c=e.schema.tags.find(h=>h.tag===a&&h.collection===r);if(!c){const h=e.schema.knownTags[a];if(h&&h.collection===r)e.schema.tags.push(Object.assign({},h,{default:!1})),c=h;else return h?i(o,"BAD_COLLECTION_TYPE",`${h.tag} used for ${r} collection, but expects ${h.collection??"scalar"}`,!0):i(o,"TAG_RESOLVE_FAILED",`Unresolved tag: ${a}`,!0),fe(s,e,t,i,a)}const l=fe(s,e,t,i,a,c),u=((d=c.resolve)==null?void 0:d.call(c,l,h=>i(o,"TAG_RESOLVE_FAILED",h),e.options))??l,f=me(u)?u:new O(u);return f.range=l.range,f.tag=a,c!=null&&c.format&&(f.format=c.format),f}function Ut(s,e,t){const n=e.offset,i=xt(e,s.options.strict,t);if(!i)return{value:"",type:null,comment:"",range:[n,n,n]};const o=i.mode===">"?O.BLOCK_FOLDED:O.BLOCK_LITERAL,a=e.source?Ft(e.source):[];let r=a.length;for(let p=a.length-1;p>=0;--p){const m=a[p][1];if(m===""||m==="\r")r=p;else break}if(r===0){const p=i.chomp==="+"&&a.length>0?`
`.repeat(Math.max(1,a.length-1)):"";let m=n+i.length;return e.source&&(m+=e.source.length),{value:p,type:o,comment:i.comment,range:[n,m,m]}}let c=e.indent+i.indent,l=e.offset+i.length,u=0;for(let p=0;p<r;++p){const[m,g]=a[p];if(g===""||g==="\r")i.indent===0&&m.length>c&&(c=m.length);else{m.length<c&&t(l+m.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),i.indent===0&&(c=m.length),u=p,c===0&&!s.atRoot&&t(l,"BAD_INDENT","Block scalar values in collections must be indented");break}l+=m.length+g.length+1}for(let p=a.length-1;p>=r;--p)a[p][0].length>c&&(r=p+1);let f="",d="",h=!1;for(let p=0;p<u;++p)f+=a[p][0].slice(c)+`
`;for(let p=u;p<r;++p){let[m,g]=a[p];l+=m.length+g.length+1;const S=g[g.length-1]==="\r";if(S&&(g=g.slice(0,-1)),g&&m.length<c){const T=`Block scalar lines must not be less indented than their ${i.indent?"explicit indentation indicator":"first line"}`;t(l-g.length-(S?2:1),"BAD_INDENT",T),m=""}o===O.BLOCK_LITERAL?(f+=d+m.slice(c)+g,d=`
`):m.length>c||g[0]==="	"?(d===" "?d=`
`:!h&&d===`
`&&(d=`

`),f+=d+m.slice(c)+g,d=`
`,h=!0):g===""?d===`
`?f+=`
`:d=`
`:(f+=d+g,d=" ",h=!1)}switch(i.chomp){case"-":break;case"+":for(let p=r;p<a.length;++p)f+=`
`+a[p][0].slice(c);f[f.length-1]!==`
`&&(f+=`
`);break;default:f+=`
`}const b=n+i.length+e.source.length;return{value:f,type:o,comment:i.comment,range:[n,b,b]}}function xt({offset:s,props:e},t,n){if(e[0].type!=="block-scalar-header")return n(e[0],"IMPOSSIBLE","Block scalar header not found"),null;const{source:i}=e[0],o=i[0];let a=0,r="",c=-1;for(let d=1;d<i.length;++d){const h=i[d];if(!r&&(h==="-"||h==="+"))r=h;else{const b=Number(h);!a&&b?a=b:c===-1&&(c=s+d)}}c!==-1&&n(c,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${i}`);let l=!1,u="",f=i.length;for(let d=1;d<e.length;++d){const h=e[d];switch(h.type){case"space":l=!0;case"newline":f+=h.source.length;break;case"comment":t&&!l&&n(h,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),f+=h.source.length,u=h.source.substring(1);break;case"error":n(h,"UNEXPECTED_TOKEN",h.message),f+=h.source.length;break;default:{const b=`Unexpected token in block scalar header: ${h.type}`;n(h,"UNEXPECTED_TOKEN",b);const p=h.source;p&&typeof p=="string"&&(f+=p.length)}}}return{mode:o,indent:a,chomp:r,comment:u,length:f}}function Ft(s){const e=s.split(/\n( *)/),t=e[0],n=t.match(/^( *)/),o=[n!=null&&n[1]?[n[1],t.slice(n[1].length)]:["",t]];for(let a=1;a<e.length;a+=2)o.push([e[a],e[a+1]]);return o}function Gt(s,e,t){const{offset:n,type:i,source:o,end:a}=s;let r,c;const l=(d,h,b)=>t(n+d,h,b);switch(i){case"scalar":r=O.PLAIN,c=Jt(o,l);break;case"single-quoted-scalar":r=O.QUOTE_SINGLE,c=Yt(o,l);break;case"double-quoted-scalar":r=O.QUOTE_DOUBLE,c=zt(o,l);break;default:return t(s,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${i}`),{value:"",type:null,comment:"",range:[n,n+o.length,n+o.length]}}const u=n+o.length,f=z(a,u,e,t);return{value:c,type:r,comment:f.comment,range:[n,u,f.offset]}}function Jt(s,e){let t="";switch(s[0]){case"	":t="a tab character";break;case",":t="flow indicator character ,";break;case"%":t="directive indicator character %";break;case"|":case">":{t=`block scalar indicator ${s[0]}`;break}case"@":case"`":{t=`reserved character ${s[0]}`;break}}return t&&e(0,"BAD_SCALAR_START",`Plain value cannot start with ${t}`),tt(s)}function Yt(s,e){return(s[s.length-1]!=="'"||s.length===1)&&e(s.length,"MISSING_CHAR","Missing closing 'quote"),tt(s.slice(1,-1)).replace(/''/g,"'")}function tt(s){let e,t;try{e=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),t=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{e=/(.*?)[ \t]*\r?\n/sy,t=/[ \t]*(.*?)[ \t]*\r?\n/sy}let n=e.exec(s);if(!n)return s;let i=n[1],o=" ",a=e.lastIndex;for(t.lastIndex=a;n=t.exec(s);)n[1]===""?o===`
`?i+=o:o=`
`:(i+=o+n[1],o=" "),a=t.lastIndex;const r=/[ \t]*(.*)/sy;return r.lastIndex=a,n=r.exec(s),i+o+((n==null?void 0:n[1])??"")}function zt(s,e){let t="";for(let n=1;n<s.length-1;++n){const i=s[n];if(!(i==="\r"&&s[n+1]===`
`))if(i===`
`){const{fold:o,offset:a}=Ht(s,n);t+=o,n=a}else if(i==="\\"){let o=s[++n];const a=Vt[o];if(a)t+=a;else if(o===`
`)for(o=s[n+1];o===" "||o==="	";)o=s[++n+1];else if(o==="\r"&&s[n+1]===`
`)for(o=s[++n+1];o===" "||o==="	";)o=s[++n+1];else if(o==="x"||o==="u"||o==="U"){const r={x:2,u:4,U:8}[o];t+=Wt(s,n+1,r,e),n+=r}else{const r=s.substr(n-1,2);e(n-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${r}`),t+=r}}else if(i===" "||i==="	"){const o=n;let a=s[n+1];for(;a===" "||a==="	";)a=s[++n+1];a!==`
`&&!(a==="\r"&&s[n+2]===`
`)&&(t+=n>o?s.slice(o,n+1):i)}else t+=i}return(s[s.length-1]!=='"'||s.length===1)&&e(s.length,"MISSING_CHAR",'Missing closing "quote'),t}function Ht(s,e){let t="",n=s[e+1];for(;(n===" "||n==="	"||n===`
`||n==="\r")&&!(n==="\r"&&s[e+2]!==`
`);)n===`
`&&(t+=`
`),e+=1,n=s[e+1];return t||(t=" "),{fold:t,offset:e}}const Vt={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"",_:" ",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function Wt(s,e,t,n){const i=s.substr(e,t),a=i.length===t&&/^[0-9a-fA-F]+$/.test(i)?parseInt(i,16):NaN;if(isNaN(a)){const r=s.substr(e-2,t+2);return n(e-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${r}`),r}return String.fromCodePoint(a)}function st(s,e,t,n){const{value:i,type:o,comment:a,range:r}=e.type==="block-scalar"?Ut(s,e,n):Gt(e,s.options.strict,n),c=t?s.directives.tagName(t.source,f=>n(t,"TAG_RESOLVE_FAILED",f)):null;let l;s.options.stringKeys&&s.atKey?l=s.schema[C]:c?l=Xt(s.schema,i,c,t,n):e.type==="scalar"?l=Qt(s,i,e,n):l=s.schema[C];let u;try{const f=l.resolve(i,d=>n(t??e,"TAG_RESOLVE_FAILED",d),s.options);u=G(f)?f:new O(f)}catch(f){const d=f instanceof Error?f.message:String(f);n(t??e,"TAG_RESOLVE_FAILED",d),u=new O(i)}return u.range=r,u.source=i,o&&(u.type=o),c&&(u.tag=c),l.format&&(u.format=l.format),a&&(u.comment=a),u}function Xt(s,e,t,n,i){var r;if(t==="!")return s[C];const o=[];for(const c of s.tags)if(!c.collection&&c.tag===t)if(c.default&&c.test)o.push(c);else return c;for(const c of o)if((r=c.test)!=null&&r.test(e))return c;const a=s.knownTags[t];return a&&!a.collection?(s.tags.push(Object.assign({},a,{default:!1,test:void 0})),a):(i(n,"TAG_RESOLVE_FAILED",`Unresolved tag: ${t}`,t!=="tag:yaml.org,2002:str"),s[C])}function Qt({atKey:s,directives:e,schema:t},n,i,o){const a=t.tags.find(r=>{var c;return(r.default===!0||s&&r.default==="key")&&((c=r.test)==null?void 0:c.test(n))})||t[C];if(t.compat){const r=t.compat.find(c=>{var l;return c.default&&((l=c.test)==null?void 0:l.test(n))})??t[C];if(a.tag!==r.tag){const c=e.tagString(a.tag),l=e.tagString(r.tag),u=`Value may be parsed as either ${c} or ${l}`;o(i,"TAG_RESOLVE_FAILED",u,!0)}}return a}function Zt(s,e,t){if(e){t===null&&(t=e.length);for(let n=t-1;n>=0;--n){let i=e[n];switch(i.type){case"space":case"comment":case"newline":s-=i.source.length;continue}for(i=e[++n];(i==null?void 0:i.type)==="space";)s+=i.source.length,i=e[++n];break}}return s}const es={composeNode:nt,composeEmptyNode:Se};function nt(s,e,t,n){const i=s.atKey,{spaceBefore:o,comment:a,anchor:r,tag:c}=t;let l,u=!0;switch(e.type){case"alias":l=ts(s,e,n),(r||c)&&n(e,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":l=st(s,e,c,n),r&&(l.anchor=r.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":l=Rt(es,s,e,t,n),r&&(l.anchor=r.source.substring(1));break;default:{const f=e.type==="error"?e.message:`Unsupported token (type: ${e.type})`;n(e,"UNEXPECTED_TOKEN",f),l=Se(s,e.offset,void 0,null,t,n),u=!1}}return r&&l.anchor===""&&n(r,"BAD_ALIAS","Anchor cannot be an empty string"),i&&s.options.stringKeys&&(!G(l)||typeof l.value!="string"||l.tag&&l.tag!=="tag:yaml.org,2002:str")&&n(c??e,"NON_STRING_KEY","With stringKeys, all keys must be strings"),o&&(l.spaceBefore=!0),a&&(e.type==="scalar"&&e.source===""?l.comment=a:l.commentBefore=a),s.options.keepSourceTokens&&u&&(l.srcToken=e),l}function Se(s,e,t,n,{spaceBefore:i,comment:o,anchor:a,tag:r,end:c},l){const u={type:"scalar",offset:Zt(e,t,n),indent:-1,source:""},f=st(s,u,r,l);return a&&(f.anchor=a.source.substring(1),f.anchor===""&&l(a,"BAD_ALIAS","Anchor cannot be an empty string")),i&&(f.spaceBefore=!0),o&&(f.comment=o,f.range[2]=c),f}function ts({options:s},{offset:e,source:t,end:n},i){const o=new Me(t.substring(1));o.source===""&&i(e,"BAD_ALIAS","Alias cannot be an empty string"),o.source.endsWith(":")&&i(e+t.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const a=e+t.length,r=z(n,a,s.strict,i);return o.range=[e,a,r.offset],r.comment&&(o.comment=r.comment),o}function ss(s,e,{offset:t,start:n,value:i,end:o},a){const r=Object.assign({_directives:e},s),c=new oe(void 0,r),l={atKey:!1,atRoot:!0,directives:c.directives,options:c.options,schema:c.schema},u=M(n,{indicator:"doc-start",next:i??(o==null?void 0:o[0]),offset:t,onError:a,parentIndent:0,startOnNewline:!0});u.found&&(c.directives.docStart=!0,i&&(i.type==="block-map"||i.type==="block-seq")&&!u.hasNewline&&a(u.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),c.contents=i?nt(l,i,u,a):Se(l,u.end,n,null,u,a);const f=c.contents.range[2],d=z(o,f,!1,a);return d.comment&&(c.comment=d.comment),c.range=[t,f,d.offset],c}function U(s){if(typeof s=="number")return[s,s+1];if(Array.isArray(s))return s.length===2?s:[s[0],s[1]];const{offset:e,source:t}=s;return[e,e+(typeof t=="string"?t.length:1)]}function Pe(s){var i;let e="",t=!1,n=!1;for(let o=0;o<s.length;++o){const a=s[o];switch(a[0]){case"#":e+=(e===""?"":n?`

`:`
`)+(a.substring(1)||" "),t=!0,n=!1;break;case"%":((i=s[o+1])==null?void 0:i[0])!=="#"&&(o+=1),t=!1;break;default:t||(n=!0),t=!1}}return{comment:e,afterEmptyLine:n}}class ns{constructor(e={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(t,n,i,o)=>{const a=U(t);o?this.warnings.push(new Dt(a,n,i)):this.errors.push(new x(a,n,i))},this.directives=new Q({version:e.version||"1.2"}),this.options=e}decorate(e,t){const{comment:n,afterEmptyLine:i}=Pe(this.prelude);if(n){const o=e.contents;if(t)e.comment=e.comment?`${e.comment}
${n}`:n;else if(i||e.directives.docStart||!o)e.commentBefore=n;else if(v(o)&&!o.flow&&o.items.length>0){let a=o.items[0];qe(a)&&(a=a.key);const r=a.commentBefore;a.commentBefore=r?`${n}
${r}`:n}else{const a=o.commentBefore;o.commentBefore=a?`${n}
${a}`:n}}t?(Array.prototype.push.apply(e.errors,this.errors),Array.prototype.push.apply(e.warnings,this.warnings)):(e.errors=this.errors,e.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:Pe(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(e,t=!1,n=-1){for(const i of e)yield*this.next(i);yield*this.end(t,n)}*next(e){switch(e.type){case"directive":this.directives.add(e.source,(t,n,i)=>{const o=U(e);o[0]+=t,this.onError(o,"BAD_DIRECTIVE",n,i)}),this.prelude.push(e.source),this.atDirectives=!0;break;case"document":{const t=ss(this.options,this.directives,e,this.onError);this.atDirectives&&!t.directives.docStart&&this.onError(e,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(t,!1),this.doc&&(yield this.doc),this.doc=t,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(e.source);break;case"error":{const t=e.source?`${e.message}: ${JSON.stringify(e.source)}`:e.message,n=new x(U(e),"UNEXPECTED_TOKEN",t);this.atDirectives||!this.doc?this.errors.push(n):this.doc.errors.push(n);break}case"doc-end":{if(!this.doc){const n="Unexpected doc-end without preceding document";this.errors.push(new x(U(e),"UNEXPECTED_TOKEN",n));break}this.doc.directives.docEnd=!0;const t=z(e.end,e.offset+e.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),t.comment){const n=this.doc.comment;this.doc.comment=n?`${n}
${t.comment}`:t.comment}this.doc.range[2]=t.offset;break}default:this.errors.push(new x(U(e),"UNEXPECTED_TOKEN",`Unsupported token ${e.type}`))}}*end(e=!1,t=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(e){const n=Object.assign({_directives:this.directives},this.options),i=new oe(void 0,n);this.atDirectives&&this.onError(t,"MISSING_CHAR","Missing directives-end indicator line"),i.range=[0,t,t],this.decorate(i,!1),yield i}}}class is{constructor(){this.lineStarts=[],this.addNewLine=e=>this.lineStarts.push(e),this.linePos=e=>{let t=0,n=this.lineStarts.length;for(;t<n;){const o=t+n>>1;this.lineStarts[o]<e?t=o+1:n=o}if(this.lineStarts[t]===e)return{line:t+1,col:1};if(t===0)return{line:0,col:e};const i=this.lineStarts[t-1];return{line:t,col:e-i+1}}}}function j(s,e){for(let t=0;t<s.length;++t)if(s[t].type===e)return!0;return!1}function Be(s){for(let e=0;e<s.length;++e)switch(s[e].type){case"space":case"comment":case"newline":break;default:return e}return-1}function it(s){switch(s==null?void 0:s.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function X(s){switch(s.type){case"document":return s.start;case"block-map":{const e=s.items[s.items.length-1];return e.sep??e.start}case"block-seq":return s.items[s.items.length-1].start;default:return[]}}function B(s){var t;if(s.length===0)return[];let e=s.length;e:for(;--e>=0;)switch(s[e].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;((t=s[++e])==null?void 0:t.type)==="space";);return s.splice(e,s.length)}function De(s){if(s.start.type==="flow-seq-start")for(const e of s.items)e.sep&&!e.value&&!j(e.start,"explicit-key-ind")&&!j(e.sep,"map-value-ind")&&(e.key&&(e.value=e.key),delete e.key,it(e.value)?e.value.end?Array.prototype.push.apply(e.value.end,e.sep):e.value.end=e.sep:Array.prototype.push.apply(e.start,e.sep),delete e.sep)}class os{constructor(e){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new bt,this.onNewLine=e}*parse(e,t=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(const n of this.lexer.lex(e,t))yield*this.next(n);t||(yield*this.end())}*next(e){if(this.source=e,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=e.length;return}const t=kt(e);if(t)if(t==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=t,yield*this.step(),t){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+e.length);break;case"space":this.atNewLine&&e[0]===" "&&(this.indent+=e.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=e.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=e.length}else{const n=`Not a YAML token: ${e}`;yield*this.pop({type:"error",offset:this.offset,message:n,source:e}),this.offset+=e.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const e=this.peek(1);if(this.type==="doc-end"&&(!e||e.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!e)return yield*this.stream();switch(e.type){case"document":return yield*this.document(e);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(e);case"block-scalar":return yield*this.blockScalar(e);case"block-map":return yield*this.blockMap(e);case"block-seq":return yield*this.blockSequence(e);case"flow-collection":return yield*this.flowCollection(e);case"doc-end":return yield*this.documentEnd(e)}yield*this.pop()}peek(e){return this.stack[this.stack.length-e]}*pop(e){const t=e??this.stack.pop();if(!t)yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"};else if(this.stack.length===0)yield t;else{const n=this.peek(1);switch(t.type==="block-scalar"?t.indent="indent"in n?n.indent:0:t.type==="flow-collection"&&n.type==="document"&&(t.indent=0),t.type==="flow-collection"&&De(t),n.type){case"document":n.value=t;break;case"block-scalar":n.props.push(t);break;case"block-map":{const i=n.items[n.items.length-1];if(i.value){n.items.push({start:[],key:t,sep:[]}),this.onKeyLine=!0;return}else if(i.sep)i.value=t;else{Object.assign(i,{key:t,sep:[]}),this.onKeyLine=!i.explicitKey;return}break}case"block-seq":{const i=n.items[n.items.length-1];i.value?n.items.push({start:[],value:t}):i.value=t;break}case"flow-collection":{const i=n.items[n.items.length-1];!i||i.value?n.items.push({start:[],key:t,sep:[]}):i.sep?i.value=t:Object.assign(i,{key:t,sep:[]});return}default:yield*this.pop(),yield*this.pop(t)}if((n.type==="document"||n.type==="block-map"||n.type==="block-seq")&&(t.type==="block-map"||t.type==="block-seq")){const i=t.items[t.items.length-1];i&&!i.sep&&!i.value&&i.start.length>0&&Be(i.start)===-1&&(t.indent===0||i.start.every(o=>o.type!=="comment"||o.indent<t.indent))&&(n.type==="document"?n.end=i.start:n.items.push({start:i.start}),t.items.splice(-1,1))}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{const e={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&e.start.push(this.sourceToken),this.stack.push(e);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(e){if(e.value)return yield*this.lineEnd(e);switch(this.type){case"doc-start":{Be(e.start)!==-1?(yield*this.pop(),yield*this.step()):e.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":e.start.push(this.sourceToken);return}const t=this.startBlockValue(e);t?this.stack.push(t):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(e){if(this.type==="map-value-ind"){const t=X(this.peek(2)),n=B(t);let i;e.end?(i=e.end,i.push(this.sourceToken),delete e.end):i=[this.sourceToken];const o={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:n,key:e,sep:i}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=o}else yield*this.lineEnd(e)}*blockScalar(e){switch(this.type){case"space":case"comment":case"newline":e.props.push(this.sourceToken);return;case"scalar":if(e.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let t=this.source.indexOf(`
`)+1;for(;t!==0;)this.onNewLine(this.offset+t),t=this.source.indexOf(`
`,t)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(e){var n;const t=e.items[e.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,t.value){const i="end"in t.value?t.value.end:void 0,o=Array.isArray(i)?i[i.length-1]:void 0;(o==null?void 0:o.type)==="comment"?i==null||i.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"space":case"comment":if(t.value)e.items.push({start:[this.sourceToken]});else if(t.sep)t.sep.push(this.sourceToken);else{if(this.atIndentedComment(t.start,e.indent)){const i=e.items[e.items.length-2],o=(n=i==null?void 0:i.value)==null?void 0:n.end;if(Array.isArray(o)){Array.prototype.push.apply(o,t.start),o.push(this.sourceToken),e.items.pop();return}}t.start.push(this.sourceToken)}return}if(this.indent>=e.indent){const i=!this.onKeyLine&&this.indent===e.indent,o=i&&(t.sep||t.explicitKey)&&this.type!=="seq-item-ind";let a=[];if(o&&t.sep&&!t.value){const r=[];for(let c=0;c<t.sep.length;++c){const l=t.sep[c];switch(l.type){case"newline":r.push(c);break;case"space":break;case"comment":l.indent>e.indent&&(r.length=0);break;default:r.length=0}}r.length>=2&&(a=t.sep.splice(r[1]))}switch(this.type){case"anchor":case"tag":o||t.value?(a.push(this.sourceToken),e.items.push({start:a}),this.onKeyLine=!0):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"explicit-key-ind":!t.sep&&!t.explicitKey?(t.start.push(this.sourceToken),t.explicitKey=!0):o||t.value?(a.push(this.sourceToken),e.items.push({start:a,explicitKey:!0})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]}),this.onKeyLine=!0;return;case"map-value-ind":if(t.explicitKey)if(t.sep)if(t.value)e.items.push({start:[],key:null,sep:[this.sourceToken]});else if(j(t.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:null,sep:[this.sourceToken]}]});else if(it(t.key)&&!j(t.sep,"newline")){const r=B(t.start),c=t.key,l=t.sep;l.push(this.sourceToken),delete t.key,delete t.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,key:c,sep:l}]})}else a.length>0?t.sep=t.sep.concat(a,this.sourceToken):t.sep.push(this.sourceToken);else if(j(t.start,"newline"))Object.assign(t,{key:null,sep:[this.sourceToken]});else{const r=B(t.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,key:null,sep:[this.sourceToken]}]})}else t.sep?t.value||o?e.items.push({start:a,key:null,sep:[this.sourceToken]}):j(t.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const r=this.flowScalar(this.type);o||t.value?(e.items.push({start:a,key:r,sep:[]}),this.onKeyLine=!0):t.sep?this.stack.push(r):(Object.assign(t,{key:r,sep:[]}),this.onKeyLine=!0);return}default:{const r=this.startBlockValue(e);if(r){if(r.type==="block-seq"){if(!t.explicitKey&&t.sep&&!j(t.sep,"newline")){yield*this.pop({type:"error",offset:this.offset,message:"Unexpected block-seq-ind on same line with key",source:this.source});return}}else i&&e.items.push({start:a});this.stack.push(r);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(e){var n;const t=e.items[e.items.length-1];switch(this.type){case"newline":if(t.value){const i="end"in t.value?t.value.end:void 0,o=Array.isArray(i)?i[i.length-1]:void 0;(o==null?void 0:o.type)==="comment"?i==null||i.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else t.start.push(this.sourceToken);return;case"space":case"comment":if(t.value)e.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(t.start,e.indent)){const i=e.items[e.items.length-2],o=(n=i==null?void 0:i.value)==null?void 0:n.end;if(Array.isArray(o)){Array.prototype.push.apply(o,t.start),o.push(this.sourceToken),e.items.pop();return}}t.start.push(this.sourceToken)}return;case"anchor":case"tag":if(t.value||this.indent<=e.indent)break;t.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==e.indent)break;t.value||j(t.start,"seq-item-ind")?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken);return}if(this.indent>e.indent){const i=this.startBlockValue(e);if(i){this.stack.push(i);return}}yield*this.pop(),yield*this.step()}*flowCollection(e){const t=e.items[e.items.length-1];if(this.type==="flow-error-end"){let n;do yield*this.pop(),n=this.peek(1);while(n&&n.type==="flow-collection")}else if(e.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!t||t.sep?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken);return;case"map-value-ind":!t||t.value?e.items.push({start:[],key:null,sep:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!t||t.value?e.items.push({start:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const i=this.flowScalar(this.type);!t||t.value?e.items.push({start:[],key:i,sep:[]}):t.sep?this.stack.push(i):Object.assign(t,{key:i,sep:[]});return}case"flow-map-end":case"flow-seq-end":e.end.push(this.sourceToken);return}const n=this.startBlockValue(e);n?this.stack.push(n):(yield*this.pop(),yield*this.step())}else{const n=this.peek(2);if(n.type==="block-map"&&(this.type==="map-value-ind"&&n.indent===e.indent||this.type==="newline"&&!n.items[n.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&n.type!=="flow-collection"){const i=X(n),o=B(i);De(e);const a=e.end.splice(1,e.end.length);a.push(this.sourceToken);const r={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:o,key:e,sep:a}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=r}else yield*this.lineEnd(e)}}flowScalar(e){if(this.onNewLine){let t=this.source.indexOf(`
`)+1;for(;t!==0;)this.onNewLine(this.offset+t),t=this.source.indexOf(`
`,t)+1}return{type:e,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(e){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const t=X(e),n=B(t);return n.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:n,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;const t=X(e),n=B(t);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:n,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(e,t){return this.type!=="comment"||this.indent<=t?!1:e.every(n=>n.type==="newline"||n.type==="space")}*documentEnd(e){this.type!=="doc-mode"&&(e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(e){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}}function as(s){const e=s.prettyErrors!==!1;return{lineCounter:s.lineCounter||e&&new is||null,prettyErrors:e}}function rs(s,e={}){const{lineCounter:t,prettyErrors:n}=as(e),i=new os(t==null?void 0:t.addNewLine),o=new ns(e);let a=null;for(const r of o.compose(i.parse(s),!0,s.length))if(!a)a=r;else if(a.options.logLevel!=="silent"){a.errors.push(new x(r.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return n&&t&&(a.errors.forEach(Ce(s,t)),a.warnings.forEach(Ce(s,t))),a}function cs(s,e,t){let n;const i=rs(s,t);if(!i)return null;if(i.warnings.forEach(o=>Tt(i.options.logLevel,o)),i.errors.length>0){if(i.options.logLevel!=="silent")throw i.errors[0];i.errors=[]}return i.toJS(Object.assign({reviver:n},t))}const ys=async(s="",e=null,t=!1,n=!1)=>{const i=new URLSearchParams;n&&i.append("refresh","true");let o=null;const a=await fetch(`${A}/api/models${t?"/base":""}?${i.toString()}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}}}).then(async c=>{if(!c.ok)throw await c.json();return c.json()}).catch(c=>(o=c,null));if(o)throw o;let r=(a==null?void 0:a.data)??[];if(e&&!t){let c=[];if(e){const u=e.OPENAI_API_BASE_URLS,f=e.OPENAI_API_KEYS,d=e.OPENAI_API_CONFIGS,h=[];for(const p in u){const m=u[p];if(p.toString()in d){const g=d[p.toString()]??{},S=(g==null?void 0:g.enable)??!0,I=(g==null?void 0:g.model_ids)??[];if(S)if(I.length>0){const T={object:"list",data:I.map(k=>({id:k,name:k,owned_by:"openai",openai:{id:k},urlIdx:p}))};h.push((async()=>T)())}else h.push((async()=>await at(m,f[p]).then(T=>T).catch(T=>({object:"list",data:[],urlIdx:p})))());else h.push((async()=>({object:"list",data:[],urlIdx:p}))())}}const b=await Promise.all(h);for(const p in b){const m=b[p],g=d[p.toString()]??{};let S=Array.isArray(m)?m:(m==null?void 0:m.data)??[];S=S.map(k=>({...k,openai:{id:k.id},urlIdx:p}));const I=g.prefix_id;if(I)for(const k of S)k.id=`${I}.${k.id}`;const T=g.tags;if(T)for(const k of S)k.tags=T;c=c.concat(S)}}r=r.concat(c.map(u=>({...u,name:(u==null?void 0:u.name)??(u==null?void 0:u.id),direct:!0})));const l={};for(const u of r)l[u.id]=u;r=Object.values(l)}return r},gs=async(s,e)=>{let t=null;const n=await fetch(`${A}/api/chat/completed`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}},body:JSON.stringify(e)}).then(async i=>{if(!i.ok)throw await i.json();return i.json()}).catch(i=>("detail"in i?t=i.detail:t=i,null));if(t)throw t;return n},ws=async(s,e,t)=>{let n=null;const i=await fetch(`${A}/api/chat/actions/${e}`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}},body:JSON.stringify(t)}).then(async o=>{if(!o.ok)throw await o.json();return o.json()}).catch(o=>("detail"in o?n=o.detail:n=o,null));if(n)throw n;return i},bs=async(s,e)=>{let t=null;const n=await fetch(`${A}/api/tasks/stop/${e}`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}}}).then(async i=>{if(!i.ok)throw await i.json();return i.json()}).catch(i=>("detail"in i?t=i.detail:t=i,null));if(t)throw t;return n},ks=async(s,e)=>{let t=null;const n=await fetch(`${A}/api/tasks/chat/${e}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}}}).then(async i=>{if(!i.ok)throw await i.json();return i.json()}).catch(i=>("detail"in i?t=i.detail:t=i,null));if(t)throw t;return n},ls=async(s,e)=>{let t=null;const n=await fetch(`${e}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}}}).then(async i=>{if(e.toLowerCase().endsWith(".yaml")||e.toLowerCase().endsWith(".yml")){if(!i.ok)throw await i.text();const o=await i.text();return cs(o)}else{if(!i.ok)throw await i.json();return i.json()}}).catch(i=>("detail"in i?t=i.detail:t=i,null));if(t)throw t;return n},Ts=async s=>(await Promise.all(s.filter(e=>{var t;return(t=e==null?void 0:e.config)==null?void 0:t.enable}).map(async e=>{let t=null,n=null;const i=(e==null?void 0:e.auth_type)??"bearer";i==="bearer"?n=e==null?void 0:e.key:i==="none"||i==="session"&&(n=localStorage.token);let o=null;const a=(e==null?void 0:e.spec_type)??"url";if(a==="url")o=await ls(n,((e==null?void 0:e.path)??"").includes("://")?e==null?void 0:e.path:`${e==null?void 0:e.url}${((e==null?void 0:e.path)??"").startsWith("/")?"":"/"}${e==null?void 0:e.path}`).catch(r=>(t=r,null));else if((a==="json"&&(e==null?void 0:e.spec))??null)try{o=JSON.parse(e==null?void 0:e.spec)}catch{t="Failed to parse JSON spec"}if(o){const{openapi:r,info:c,specs:l}={openapi:o,info:o.info,specs:ot(o)};return{url:e==null?void 0:e.url,openapi:r,info:c,specs:l}}else return t?{error:t,url:e==null?void 0:e.url}:null}))).filter(e=>e),Ss=async(s,e,t,n,i)=>{let o=null;try{const a=Object.entries(i.openapi.paths).find(([w,N])=>Object.entries(N).some(([y,$])=>$.operationId===t));if(!a)throw new Error(`No matching route found for operationId: ${t}`);const[r,c]=a,l=Object.entries(c).find(([w,N])=>N.operationId===t);if(!l)throw new Error(`No matching method found for operationId: ${t}`);const[u,f]=l,d={},h={};let b={};f.parameters&&f.parameters.forEach(w=>{const N=w.name,y=w.in;n.hasOwnProperty(N)&&(y==="path"?d[N]=n[N]:y==="query"&&(h[N]=n[N]))});let p=`${e}${r}`;if(Object.entries(d).forEach(([w,N])=>{p=p.replace(new RegExp(`{${w}}`,"g"),encodeURIComponent(N))}),Object.keys(h).length>0){const w=new URLSearchParams(Object.entries(h).map(([N,y])=>[N,String(y)])).toString();p+=`?${w}`}if(f.requestBody&&f.requestBody.content){const w=Object.keys(f.requestBody.content)[0];if(n!==void 0)b=n;else throw new Error(`Request body expected for operation '${t}' but none found.`)}const m={"Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}},g={method:u.toUpperCase(),headers:m};["post","put","patch","delete"].includes(u.toLowerCase())&&f.requestBody&&(g.body=JSON.stringify(b));const S=await fetch(p,g);if(!S.ok){const w=await S.text();throw new Error(`HTTP error! Status: ${S.status}. Message: ${w}`)}const I={};S.headers.forEach((w,N)=>{I[N]=w});const T=await S.text();let k;try{k=JSON.parse(T)}catch{k=T}return[k,I]}catch(a){return o=a.message,[{error:o},null]}},Ns=async(s="")=>{let e=null;const t=await fetch(`${A}/api/v1/tasks/config`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}}}).then(async n=>{if(!n.ok)throw await n.json();return n.json()}).catch(n=>(e=n,null));if(e)throw e;return t},Is=async(s,e)=>{let t=null;const n=await fetch(`${A}/api/v1/tasks/config/update`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}},body:JSON.stringify(e)}).then(async i=>{if(!i.ok)throw await i.json();return i.json()}).catch(i=>("detail"in i?t=i.detail:t=i,null));if(t)throw t;return n},As=async(s="",e,t,n)=>{var a,r;let i=null;const o=await fetch(`${A}/api/v1/tasks/title/completions`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({model:e,messages:t,...n})}).then(async c=>{if(!c.ok)throw await c.json();return c.json()}).catch(c=>("detail"in c&&(i=c.detail),null));if(i)throw i;try{const l=(((r=(a=o==null?void 0:o.choices[0])==null?void 0:a.message)==null?void 0:r.content)??"").replace(/['‘’`]/g,'"'),u=l.indexOf("{"),f=l.lastIndexOf("}");if(u!==-1&&f!==-1){const d=l.substring(u,f+1),h=JSON.parse(d);return h&&h.title?h.title:null}return null}catch{return null}},Os=async(s="",e,t,n)=>{var a,r;let i=null;const o=await fetch(`${A}/api/v1/tasks/tags/completions`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({model:e,messages:t,...n&&{chat_id:n}})}).then(async c=>{if(!c.ok)throw await c.json();return c.json()}).catch(c=>("detail"in c&&(i=c.detail),null));if(i)throw i;try{const l=(((r=(a=o==null?void 0:o.choices[0])==null?void 0:a.message)==null?void 0:r.content)??"").replace(/['‘’`]/g,'"'),u=l.indexOf("{"),f=l.lastIndexOf("}");if(u!==-1&&f!==-1){const d=l.substring(u,f+1),h=JSON.parse(d);return h&&h.tags?Array.isArray(h.tags)?h.tags:[]:[]}return[]}catch{return[]}},$s=async(s="",e,t,n)=>{var r,c;let i=null;const o=await fetch(`${A}/api/v1/tasks/emoji/completions`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({model:e,prompt:t,...n&&{chat_id:n}})}).then(async l=>{if(!l.ok)throw await l.json();return l.json()}).catch(l=>("detail"in l&&(i=l.detail),null));if(i)throw i;const a=((c=(r=o==null?void 0:o.choices[0])==null?void 0:r.message)==null?void 0:c.content.replace(/["']/g,""))??null;return a&&new RegExp("\\p{Extended_Pictographic}","u").test(a)?a.match(new RegExp("\\p{Extended_Pictographic}","gu"))[0]:null},_s=async(s="",e,t,n,i="search query")=>{var l,u;const o=new AbortController;let a=null;const r=await fetch(`${A}/api/v1/tasks/auto/completions`,{signal:o.signal,method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({model:e,prompt:t,...n&&{messages:n},type:i,stream:!1})}).then(async f=>{if(!f.ok)throw await f.json();return f.json()}).catch(f=>("detail"in f&&(a=f.detail),null));if(a)throw a;const c=((u=(l=r==null?void 0:r.choices[0])==null?void 0:l.message)==null?void 0:u.content)??"";try{const f=c.indexOf("{"),d=c.lastIndexOf("}");if(f!==-1&&d!==-1){const h=c.substring(f,d+1),b=JSON.parse(h);return b&&b.text?b.text:""}return c}catch{return c}},Es=async(s="",e,t,n)=>{const i=new AbortController;let o=null;const a=await fetch(`${A}/api/v1/tasks/moa/completions`,{signal:i.signal,method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({model:e,prompt:t,responses:n,stream:!0})}).catch(r=>(o=r,null));if(o)throw o;return[a,i]},js=async(s="")=>{let e=null;const t=await fetch(`${A}/api/v1/pipelines/list`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}}}).then(async i=>{if(!i.ok)throw await i.json();return i.json()}).catch(i=>(e=i,null));if(e)throw e;return(t==null?void 0:t.data)??[]},vs=async(s,e,t)=>{let n=null;const i=new FormData;i.append("file",e),i.append("urlIdx",t);const o=await fetch(`${A}/api/v1/pipelines/upload`,{method:"POST",headers:{...s&&{authorization:`Bearer ${s}`}},body:i}).then(async a=>{if(!a.ok)throw await a.json();return a.json()}).catch(a=>("detail"in a?n=a.detail:n=a,null));if(n)throw n;return o},Cs=async(s,e,t)=>{let n=null;const i=await fetch(`${A}/api/v1/pipelines/add`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}},body:JSON.stringify({url:e,urlIdx:t})}).then(async o=>{if(!o.ok)throw await o.json();return o.json()}).catch(o=>("detail"in o?n=o.detail:n=o,null));if(n)throw n;return i},Ls=async(s,e,t)=>{let n=null;const i=await fetch(`${A}/api/v1/pipelines/delete`,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}},body:JSON.stringify({id:e,urlIdx:t})}).then(async o=>{if(!o.ok)throw await o.json();return o.json()}).catch(o=>("detail"in o?n=o.detail:n=o,null));if(n)throw n;return i},Ps=async(s,e)=>{let t=null;const n=new URLSearchParams;e!==void 0&&n.append("urlIdx",e);const i=await fetch(`${A}/api/v1/pipelines/?${n.toString()}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}}}).then(async a=>{if(!a.ok)throw await a.json();return a.json()}).catch(a=>(t=a,null));if(t)throw t;return(i==null?void 0:i.data)??[]},Bs=async(s,e,t)=>{let n=null;const i=new URLSearchParams;t!==void 0&&i.append("urlIdx",t);const o=await fetch(`${A}/api/v1/pipelines/${e}/valves?${i.toString()}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}}}).then(async a=>{if(!a.ok)throw await a.json();return a.json()}).catch(a=>(n=a,null));if(n)throw n;return o},Ds=async(s,e,t)=>{let n=null;const i=new URLSearchParams;t!==void 0&&i.append("urlIdx",t);const o=await fetch(`${A}/api/v1/pipelines/${e}/valves/spec?${i.toString()}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}}}).then(async a=>{if(!a.ok)throw await a.json();return a.json()}).catch(a=>(n=a,null));if(n)throw n;return o},Ks=async(s="",e,t,n)=>{let i=null;const o=new URLSearchParams;n!==void 0&&o.append("urlIdx",n);const a=await fetch(`${A}/api/v1/pipelines/${e}/valves/update?${o.toString()}`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}},body:JSON.stringify(t)}).then(async r=>{if(!r.ok)throw await r.json();return r.json()}).catch(r=>("detail"in r?i=r.detail:i=r,null));if(i)throw i;return a},Ms=async(s="")=>{let e=null;const t=await fetch(`${A}/api/usage`,{method:"GET",headers:{"Content-Type":"application/json",...s&&{Authorization:`Bearer ${s}`}}}).then(async n=>{if(!n.ok)throw await n.json();return n.json()}).catch(n=>(e=n,null));if(e)throw e;return t},qs=async()=>{let s=null;const e=await fetch(`${A}/api/config`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}).then(async t=>{if(!t.ok)throw await t.json();return t.json()}).catch(t=>(s=t,null));if(s)throw s;return e},Rs=async()=>{let s=null;const e=await fetch(`${A}/api/changelog`,{method:"GET",headers:{"Content-Type":"application/json"}}).then(async t=>{if(!t.ok)throw await t.json();return t.json()}).catch(t=>(s=t,null));if(s)throw s;return e},Us=async s=>{let e=null;const t=await fetch(`${A}/api/version/updates`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}}).then(async n=>{if(!n.ok)throw await n.json();return n.json()}).catch(n=>(e=n,null));if(e)throw e;return t},xs=async s=>{let e=null;const t=await fetch(`${A}/api/webhook`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}}).then(async n=>{if(!n.ok)throw await n.json();return n.json()}).catch(n=>(e=n,null));if(e)throw e;return t.url},Fs=async(s,e)=>{let t=null;const n=await fetch(`${A}/api/webhook`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({url:e})}).then(async i=>{if(!i.ok)throw await i.json();return i.json()}).catch(i=>(t=i,null));if(t)throw t;return n.url};export{As as A,Ts as B,Rs as C,qs as a,ls as b,Ms as c,Os as d,Ss as e,xs as f,ys as g,Us as h,js as i,Ks as j,Ds as k,Bs as l,Ps as m,Cs as n,Ls as o,vs as p,Is as q,Ns as r,_s as s,$s as t,Fs as u,ks as v,ws as w,bs as x,Es as y,gs as z};
//# sourceMappingURL=C-MpeODL.js.map
