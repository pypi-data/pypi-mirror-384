version: '3.0'

scanning-settings:
  max-depth: 6
  exclude:
    - "node_modules"
    - "lib/other/**"
    - "**/*.js"
  include-files:
    - path: inside_target_dir/requirements-docs.txt
      file-type: requirements.txt
    - path: inside_target_dir/requirements-dev.txt
      file-type: requirements.txt

installation:
  default-action: allow
  audit-logging:
    enabled: true
  allow:
    packages:
      - ecosystem: pip
        specifications:
          - "boto3==2.14"
          - "django>=2.0"
          - "flask>=1.0"
          - "jinja2~=2.0"
      - ecosystem: npmjs
        specifications:
          - "react@19"
          - "@angular/core@18"
    vulnerabilities:
      59901:
        reason: We are not impacted by this vulnerability
        expires: '2024-03-15'
      62044:
        reason: No upstream python images provide updated pip yet
        expires: '2024-06-01'
  deny:
    packages:
      warning-on-any-of:
        age-below: "3 months"
        packages:
          - ecosystem: pip
            specifications:
              - safety
          - ecosystem: npmjs
            specifications:
              - "react"
      block-on-any-of:
        age-below: "1 month"
        packages:
          - ecosystem: pip
            specifications:
              - safety
          - ecosystem: npmjs
            specifications:
              - "react"
    vulnerabilities:
      warning-on-any-of:
        cvss-severity:
          - critical
          - high
      block-on-any-of:
        cvss-severity:
          - critical

report:
  dependency-vulnerabilities:
    enabled: true
    auto-ignore-in-report:
      python:
        environment-results: true
        unpinned-requirements: true
      cvss-severity: []
      vulnerabilities:
        59901:
          reason: We are not impacted by this vulnerability
          expires: '2024-03-15'
        62044:
          reason: No upstream python images provide updated pip yet
          expires: '2024-06-01'

fail-scan-with-exit-code:
  dependency-vulnerabilities:
    enabled: true
    fail-on-any-of:
      cvss-severity:
        - critical
        - high
        - medium

security-updates:
  dependency-vulnerabilities:
    auto-security-updates-limit:
      - patch