{
  "$defs": {
    "AuthenticationType": {
      "enum": [
        "token",
        "api_key",
        "unauthenticated"
      ],
      "title": "AuthenticationType",
      "type": "string"
    },
    "ReportSchemaVersion": {
      "const": "3.0",
      "enum": [
        "3.0"
      ],
      "title": "ReportSchemaVersion",
      "type": "string"
    },
    "ScanType": {
      "enum": [
        "scan",
        "system-scan",
        "check"
      ],
      "title": "ScanType",
      "type": "string"
    },
    "Stage": {
      "enum": [
        "development",
        "cicd",
        "production"
      ],
      "title": "Stage",
      "type": "string"
    },
    "TelemetryModel": {
      "description": "Telemetry object generated per Safety report; this model holds data related to the\nclient application running Safety CLI.",
      "properties": {
        "safety_options": {
          "additionalProperties": {
            "additionalProperties": {
              "type": "integer"
            },
            "type": "object"
          },
          "title": "Safety Options",
          "type": "object"
        },
        "safety_version": {
          "title": "Safety Version",
          "type": "string"
        },
        "safety_source": {
          "title": "Safety Source",
          "type": "string"
        },
        "os_type": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Os Type"
        },
        "os_release": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Os Release"
        },
        "os_description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Os Description"
        },
        "python_version": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Python Version"
        },
        "safety_command": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Safety Command"
        }
      },
      "required": [
        "safety_options",
        "safety_version",
        "safety_source"
      ],
      "title": "TelemetryModel",
      "type": "object"
    }
  },
  "description": "Main data about the report, used for traceability purposes.",
  "properties": {
    "scan_type": {
      "$ref": "#/$defs/ScanType"
    },
    "stage": {
      "$ref": "#/$defs/Stage"
    },
    "scan_locations": {
      "items": {
        "format": "path",
        "type": "string"
      },
      "title": "Scan Locations",
      "type": "array"
    },
    "authenticated": {
      "title": "Authenticated",
      "type": "boolean"
    },
    "authentication_type": {
      "$ref": "#/$defs/AuthenticationType"
    },
    "telemetry": {
      "$ref": "#/$defs/TelemetryModel"
    },
    "schema_version": {
      "$ref": "#/$defs/ReportSchemaVersion"
    },
    "timestamp": {
      "default": "2024-11-01T10:03:01.141997",
      "format": "date-time",
      "title": "Timestamp",
      "type": "string"
    }
  },
  "required": [
    "scan_type",
    "stage",
    "scan_locations",
    "authenticated",
    "authentication_type",
    "telemetry",
    "schema_version"
  ],
  "title": "MetadataModel",
  "type": "object"
}