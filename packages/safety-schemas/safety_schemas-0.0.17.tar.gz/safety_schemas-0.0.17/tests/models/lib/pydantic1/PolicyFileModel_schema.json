{
    "title": "PolicyFileModel",
    "type": "object",
    "properties": {
        "id": {
            "title": "Id",
            "type": "string"
        },
        "source": {
            "$ref": "#/definitions/PolicySource"
        },
        "location": {
            "title": "Location",
            "type": "string",
            "format": "path"
        },
        "config": {
            "$ref": "#/definitions/ConfigModel"
        }
    },
    "required": [
        "id",
        "source",
        "location"
    ],
    "definitions": {
        "PolicySource": {
            "title": "PolicySource",
            "description": "An enumeration.",
            "enum": [
                "local",
                "cloud"
            ]
        },
        "ScanConfigModel": {
            "title": "ScanConfigModel",
            "type": "object",
            "properties": {
                "max_depth": {
                    "title": "Max Depth",
                    "default": 6,
                    "type": "integer"
                },
                "ignore": {
                    "title": "Ignore",
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "include_files": {
                    "title": "Include Files",
                    "type": "object",
                    "additionalProperties": {
                        "type": "array",
                        "items": {
                            "type": "string",
                            "format": "path"
                        }
                    }
                },
                "system_targets": {
                    "title": "System Targets",
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                }
            }
        },
        "IgnoreCodes": {
            "title": "IgnoreCodes",
            "description": "An enumeration.",
            "enum": [
                "unpinned-specification",
                "environment-dependency",
                "cvss-severity",
                "manual"
            ]
        },
        "IgnoredItemDetail": {
            "title": "IgnoredItemDetail",
            "type": "object",
            "properties": {
                "code": {
                    "default": "manual",
                    "allOf": [
                        {
                            "$ref": "#/definitions/IgnoreCodes"
                        }
                    ]
                },
                "reason": {
                    "title": "Reason",
                    "type": "string"
                },
                "expires": {
                    "title": "Expires",
                    "type": "string",
                    "format": "date"
                },
                "specifications": {
                    "title": "Specifications",
                    "type": "array",
                    "items": {},
                    "uniqueItems": true
                }
            }
        },
        "VulnerabilitySeverityLabels": {
            "title": "VulnerabilitySeverityLabels",
            "description": "An enumeration.",
            "enum": [
                "unknown",
                "none",
                "low",
                "medium",
                "high",
                "critical"
            ]
        },
        "PythonEcosystemIgnoreConfigModel": {
            "title": "PythonEcosystemIgnoreConfigModel",
            "type": "object",
            "properties": {
                "unpinned_specifications": {
                    "title": "Unpinned Specifications",
                    "default": true,
                    "type": "boolean"
                },
                "environment_results": {
                    "title": "Environment Results",
                    "default": true,
                    "type": "boolean"
                }
            }
        },
        "EPSSExploitabilityLabels": {
            "title": "EPSSExploitabilityLabels",
            "description": "An enumeration.",
            "enum": [
                "unknown",
                "low",
                "medium",
                "high",
                "critical"
            ]
        },
        "FailConfig": {
            "title": "FailConfig",
            "type": "object",
            "properties": {
                "enabled": {
                    "title": "Enabled",
                    "default": true,
                    "type": "boolean"
                },
                "cvss_severity": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/VulnerabilitySeverityLabels"
                    }
                },
                "exploitability": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/EPSSExploitabilityLabels"
                    }
                }
            }
        },
        "UpdateLevel": {
            "title": "UpdateLevel",
            "description": "An enumeration.",
            "enum": [
                "major",
                "minor",
                "patch"
            ]
        },
        "SecurityUpdates": {
            "title": "SecurityUpdates",
            "type": "object",
            "properties": {
                "auto_security_updates_limit": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/UpdateLevel"
                    }
                }
            }
        },
        "DependencyVulnerabilityConfig": {
            "title": "DependencyVulnerabilityConfig",
            "type": "object",
            "properties": {
                "enabled": {
                    "title": "Enabled",
                    "default": true,
                    "type": "boolean"
                },
                "ignore_vulnerabilities": {
                    "title": "Ignore Vulnerabilities",
                    "type": "object",
                    "additionalProperties": {
                        "$ref": "#/definitions/IgnoredItemDetail"
                    }
                },
                "ignore_cvss_severity": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/VulnerabilitySeverityLabels"
                    }
                },
                "python_ignore": {
                    "$ref": "#/definitions/PythonEcosystemIgnoreConfigModel"
                },
                "fail_on": {
                    "$ref": "#/definitions/FailConfig"
                },
                "security_updates": {
                    "$ref": "#/definitions/SecurityUpdates"
                }
            }
        },
        "ConfigModel": {
            "title": "ConfigModel",
            "type": "object",
            "properties": {
                "telemetry_enabled": {
                    "title": "Telemetry Enabled",
                    "default": true,
                    "type": "boolean"
                },
                "scan": {
                    "$ref": "#/definitions/ScanConfigModel"
                },
                "depedendency_vulnerability": {
                    "$ref": "#/definitions/DependencyVulnerabilityConfig"
                }
            }
        }
    }
}