{
  "$defs": {
    "AllowedInstallationConfig": {
      "properties": {
        "packages": {
          "items": {
            "$ref": "#/$defs/PackageDefinition"
          },
          "title": "Packages",
          "type": "array"
        },
        "vulnerabilities": {
          "additionalProperties": {
            "$ref": "#/$defs/VulnerabilityDefinition"
          },
          "title": "Vulnerabilities",
          "type": "object"
        }
      },
      "title": "AllowedInstallationConfig",
      "type": "object"
    },
    "AuditLoggingConfig": {
      "properties": {
        "enabled": {
          "default": true,
          "title": "Enabled",
          "type": "boolean"
        }
      },
      "title": "AuditLoggingConfig",
      "type": "object"
    },
    "DeniedInstallationConfig": {
      "properties": {
        "packages": {
          "$ref": "#/$defs/DeniedPackagesConfig"
        },
        "vulnerabilities": {
          "$ref": "#/$defs/DeniedVulnerabilityConfig"
        }
      },
      "title": "DeniedInstallationConfig",
      "type": "object"
    },
    "DeniedPackagesConfig": {
      "properties": {
        "warn": {
          "$ref": "#/$defs/DeniedPackagesCriteria"
        },
        "block": {
          "$ref": "#/$defs/DeniedPackagesCriteria"
        }
      },
      "title": "DeniedPackagesConfig",
      "type": "object"
    },
    "DeniedPackagesCriteria": {
      "properties": {
        "age_below": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Age Below"
        },
        "packages": {
          "items": {
            "$ref": "#/$defs/PackageDefinition"
          },
          "title": "Packages",
          "type": "array"
        }
      },
      "title": "DeniedPackagesCriteria",
      "type": "object"
    },
    "DeniedVulnerabilityConfig": {
      "properties": {
        "warn": {
          "$ref": "#/$defs/DeniedVulnerabilityCriteria"
        },
        "block": {
          "$ref": "#/$defs/DeniedVulnerabilityCriteria"
        }
      },
      "title": "DeniedVulnerabilityConfig",
      "type": "object"
    },
    "DeniedVulnerabilityCriteria": {
      "properties": {
        "cvss_severities": {
          "items": {
            "$ref": "#/$defs/VulnerabilitySeverityLabels"
          },
          "title": "Cvss Severities",
          "type": "array"
        }
      },
      "title": "DeniedVulnerabilityCriteria",
      "type": "object"
    },
    "DependencyVulnerabilityConfig": {
      "properties": {
        "enabled": {
          "default": true,
          "title": "Enabled",
          "type": "boolean"
        },
        "ignore_vulnerabilities": {
          "anyOf": [
            {
              "additionalProperties": {
                "$ref": "#/$defs/IgnoredItemDetail"
              },
              "type": "object"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Ignore Vulnerabilities"
        },
        "ignore_cvss_severity": {
          "items": {
            "$ref": "#/$defs/VulnerabilitySeverityLabels"
          },
          "title": "Ignore Cvss Severity",
          "type": "array"
        },
        "python_ignore": {
          "$ref": "#/$defs/PythonEcosystemIgnoreConfigModel"
        },
        "fail_on": {
          "$ref": "#/$defs/FailConfig"
        },
        "security_updates": {
          "$ref": "#/$defs/SecurityUpdates"
        }
      },
      "title": "DependencyVulnerabilityConfig",
      "type": "object"
    },
    "EPSSExploitabilityLabels": {
      "enum": [
        "unknown",
        "low",
        "medium",
        "high",
        "critical"
      ],
      "title": "EPSSExploitabilityLabels",
      "type": "string"
    },
    "FailConfig": {
      "properties": {
        "enabled": {
          "default": true,
          "title": "Enabled",
          "type": "boolean"
        },
        "cvss_severity": {
          "items": {
            "$ref": "#/$defs/VulnerabilitySeverityLabels"
          },
          "title": "Cvss Severity",
          "type": "array"
        },
        "exploitability": {
          "items": {
            "$ref": "#/$defs/EPSSExploitabilityLabels"
          },
          "title": "Exploitability",
          "type": "array"
        }
      },
      "title": "FailConfig",
      "type": "object"
    },
    "IgnoreCodes": {
      "enum": [
        "unpinned-specification",
        "environment-dependency",
        "cvss-severity",
        "manual"
      ],
      "title": "IgnoreCodes",
      "type": "string"
    },
    "IgnoredItemDetail": {
      "properties": {
        "code": {
          "$ref": "#/$defs/IgnoreCodes",
          "default": "manual"
        },
        "reason": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Reason"
        },
        "expires": {
          "anyOf": [
            {
              "format": "date",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Expires"
        },
        "specifications": {
          "anyOf": [
            {
              "items": {},
              "type": "array",
              "uniqueItems": true
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Specifications"
        }
      },
      "title": "IgnoredItemDetail",
      "type": "object"
    },
    "InstallationAction": {
      "enum": [
        "allow",
        "deny"
      ],
      "title": "InstallationAction",
      "type": "string"
    },
    "InstallationConfig": {
      "properties": {
        "default_action": {
          "$ref": "#/$defs/InstallationAction",
          "default": "deny"
        },
        "audit_logging": {
          "$ref": "#/$defs/AuditLoggingConfig"
        },
        "allow": {
          "$ref": "#/$defs/AllowedInstallationConfig"
        },
        "deny": {
          "$ref": "#/$defs/DeniedInstallationConfig"
        }
      },
      "title": "InstallationConfig",
      "type": "object"
    },
    "PackageDefinition": {
      "properties": {
        "ecosystem": {
          "$ref": "#/$defs/PackageEcosystem"
        },
        "specifications": {
          "items": {
            "type": "string"
          },
          "title": "Specifications",
          "type": "array"
        }
      },
      "required": [
        "ecosystem"
      ],
      "title": "PackageDefinition",
      "type": "object"
    },
    "PackageEcosystem": {
      "const": "pip",
      "enum": [
        "pip"
      ],
      "title": "PackageEcosystem",
      "type": "string"
    },
    "PythonEcosystemIgnoreConfigModel": {
      "properties": {
        "unpinned_specifications": {
          "default": true,
          "title": "Unpinned Specifications",
          "type": "boolean"
        },
        "environment_results": {
          "default": true,
          "title": "Environment Results",
          "type": "boolean"
        }
      },
      "title": "PythonEcosystemIgnoreConfigModel",
      "type": "object"
    },
    "ScanConfigModel": {
      "properties": {
        "max_depth": {
          "default": 6,
          "title": "Max Depth",
          "type": "integer"
        },
        "ignore": {
          "items": {
            "type": "string"
          },
          "title": "Ignore",
          "type": "array"
        },
        "include_files": {
          "additionalProperties": {
            "items": {
              "format": "path",
              "type": "string"
            },
            "type": "array"
          },
          "title": "Include Files",
          "type": "object"
        },
        "system_targets": {
          "items": {
            "type": "string"
          },
          "title": "System Targets",
          "type": "array"
        }
      },
      "title": "ScanConfigModel",
      "type": "object"
    },
    "SecurityUpdates": {
      "properties": {
        "auto_security_updates_limit": {
          "items": {
            "$ref": "#/$defs/UpdateLevel"
          },
          "title": "Auto Security Updates Limit",
          "type": "array"
        }
      },
      "title": "SecurityUpdates",
      "type": "object"
    },
    "UpdateLevel": {
      "enum": [
        "major",
        "minor",
        "patch"
      ],
      "title": "UpdateLevel",
      "type": "string"
    },
    "VulnerabilityDefinition": {
      "properties": {
        "reason": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Reason"
        },
        "expires": {
          "anyOf": [
            {
              "format": "date",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Expires"
        }
      },
      "title": "VulnerabilityDefinition",
      "type": "object"
    },
    "VulnerabilitySeverityLabels": {
      "enum": [
        "unknown",
        "none",
        "low",
        "medium",
        "high",
        "critical"
      ],
      "title": "VulnerabilitySeverityLabels",
      "type": "string"
    }
  },
  "properties": {
    "telemetry_enabled": {
      "default": true,
      "title": "Telemetry Enabled",
      "type": "boolean"
    },
    "scan": {
      "$ref": "#/$defs/ScanConfigModel"
    },
    "depedendency_vulnerability": {
      "$ref": "#/$defs/DependencyVulnerabilityConfig"
    },
    "installation": {
      "$ref": "#/$defs/InstallationConfig"
    }
  },
  "title": "ConfigModel",
  "type": "object"
}