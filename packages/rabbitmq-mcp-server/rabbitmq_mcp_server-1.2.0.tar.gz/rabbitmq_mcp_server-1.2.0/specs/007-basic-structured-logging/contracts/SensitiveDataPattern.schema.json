{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://rabbitmq-mcp.dev/schemas/SensitiveDataPattern.json",
  "title": "SensitiveDataPattern",
  "description": "Pattern definition for automatic sensitive data redaction in structured logs",
  "type": "object",
  "required": [
    "name",
    "pattern",
    "replacement",
    "enabled"
  ],
  "properties": {
    "name": {
      "type": "string",
      "minLength": 1,
      "description": "Descriptive identifier for the redaction pattern",
      "examples": ["password", "api_key", "bearer_token", "amqp_password"]
    },
    "pattern": {
      "type": "string",
      "minLength": 1,
      "description": "Regular expression pattern to match sensitive data (must be valid Python regex)",
      "examples": [
        "password\\s*=\\s*[\"']?([^\"'\\s]+)",
        "api[_-]?key\\s*=\\s*[\"']?([^\"'\\s]+)",
        "Bearer\\s+([A-Za-z0-9\\-._~+/]+=*)"
      ]
    },
    "replacement": {
      "type": "string",
      "description": "Replacement text to use instead of matched sensitive data",
      "examples": ["[REDACTED]", "password=[REDACTED]", "Bearer [REDACTED]"]
    },
    "flags": {
      "type": "integer",
      "minimum": 0,
      "default": 0,
      "description": "Python regex flags (e.g., re.IGNORECASE=2, re.MULTILINE=8)"
    },
    "enabled": {
      "type": "boolean",
      "default": true,
      "description": "Whether this pattern is currently active for redaction"
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "name": "password",
      "pattern": "password\\s*=\\s*[\"']?([^\"'\\s]+)",
      "replacement": "password=[REDACTED]",
      "flags": 2,
      "enabled": true
    },
    {
      "name": "amqp_password",
      "pattern": "amqp://([^:]+):([^@]+)@",
      "replacement": "amqp://\\1:[REDACTED]@",
      "flags": 0,
      "enabled": true
    },
    {
      "name": "bearer_token",
      "pattern": "Bearer\\s+([A-Za-z0-9\\-._~+/]+=*)",
      "replacement": "Bearer [REDACTED]",
      "flags": 2,
      "enabled": true
    }
  ]
}

