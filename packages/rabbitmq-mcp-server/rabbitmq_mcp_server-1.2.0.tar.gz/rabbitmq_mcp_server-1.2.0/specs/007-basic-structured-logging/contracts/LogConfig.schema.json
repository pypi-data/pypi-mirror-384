{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://rabbitmq-mcp.dev/schemas/LogConfig.json",
  "title": "LogConfig",
  "description": "Configuration for structured logging system including rotation, retention, and performance settings",
  "type": "object",
  "required": [
    "log_level",
    "output_file",
    "rotation_when",
    "rotation_interval",
    "rotation_max_bytes",
    "retention_days",
    "compression_enabled",
    "async_queue_size",
    "async_flush_interval",
    "batch_size",
    "file_permissions",
    "fallback_to_console"
  ],
  "properties": {
    "log_level": {
      "type": "string",
      "enum": ["ERROR", "WARN", "INFO", "DEBUG"],
      "default": "INFO",
      "description": "Minimum log level to record"
    },
    "output_file": {
      "type": "string",
      "default": "./logs/rabbitmq-mcp-{date}.log",
      "description": "Log file path pattern with optional {date} placeholder for daily rotation"
    },
    "rotation_when": {
      "type": "string",
      "enum": ["midnight", "H", "M", "S"],
      "default": "midnight",
      "description": "Time-based rotation trigger: midnight (daily), H (hourly), M (per minute), S (per second)"
    },
    "rotation_interval": {
      "type": "integer",
      "minimum": 1,
      "default": 1,
      "description": "Interval multiplier for time-based rotation (e.g., 2 with 'H' means every 2 hours)"
    },
    "rotation_max_bytes": {
      "type": "integer",
      "minimum": 1048576,
      "default": 104857600,
      "description": "Maximum file size in bytes before rotation (default 100MB)"
    },
    "retention_days": {
      "type": "integer",
      "minimum": 1,
      "default": 30,
      "description": "Number of days to retain log files before automatic deletion"
    },
    "compression_enabled": {
      "type": "boolean",
      "default": true,
      "description": "Enable gzip compression for rotated log files"
    },
    "async_queue_size": {
      "type": "integer",
      "minimum": 100,
      "default": 10000,
      "description": "Size of async buffer queue; blocks writes when full to ensure zero log loss"
    },
    "async_flush_interval": {
      "type": "number",
      "minimum": 0.01,
      "default": 0.1,
      "description": "Maximum time in seconds to wait before flushing buffered logs"
    },
    "batch_size": {
      "type": "integer",
      "minimum": 1,
      "default": 100,
      "description": "Number of log entries to batch before writing to disk"
    },
    "file_permissions": {
      "type": "string",
      "pattern": "^[0-7]{3}$",
      "default": "600",
      "description": "Unix file permissions in octal format (e.g., 600 for owner read/write only)"
    },
    "fallback_to_console": {
      "type": "boolean",
      "default": true,
      "description": "Write to stderr/console if file logging fails"
    },
    "sensitive_patterns": {
      "type": "array",
      "description": "Additional custom patterns for sensitive data redaction",
      "items": {
        "type": "object",
        "required": ["name", "pattern", "replacement"],
        "properties": {
          "name": {
            "type": "string",
            "description": "Descriptive name for the pattern"
          },
          "pattern": {
            "type": "string",
            "description": "Regex pattern to match sensitive data"
          },
          "replacement": {
            "type": "string",
            "description": "Replacement text (e.g., '[REDACTED]')"
          },
          "enabled": {
            "type": "boolean",
            "default": true,
            "description": "Whether this pattern is active"
          }
        }
      }
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "log_level": "INFO",
      "output_file": "./logs/rabbitmq-mcp-{date}.log",
      "rotation_when": "midnight",
      "rotation_interval": 1,
      "rotation_max_bytes": 104857600,
      "retention_days": 30,
      "compression_enabled": true,
      "async_queue_size": 10000,
      "async_flush_interval": 0.1,
      "batch_size": 100,
      "file_permissions": "600",
      "fallback_to_console": true,
      "sensitive_patterns": [
        {
          "name": "custom_secret",
          "pattern": "secret_key=([^\\s]+)",
          "replacement": "secret_key=[REDACTED]",
          "enabled": true
        }
      ]
    }
  ]
}

