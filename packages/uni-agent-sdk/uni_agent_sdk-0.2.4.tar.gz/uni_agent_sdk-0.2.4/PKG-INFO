Metadata-Version: 2.4
Name: uni_agent_sdk
Version: 0.2.4
Summary: æç®€çš„uni-imå¹³å°æ™ºèƒ½ä½“å¼€å‘æ¡†æ¶
Home-page: https://github.com/uni-im/uni-agent-sdk
Author: uni-im
Author-email: uni-im <support@uni-im.com>
Maintainer-email: uni-im <support@uni-im.com>
License: MIT
Project-URL: Homepage, https://github.com/uni-im/uni-agent-sdk
Project-URL: Documentation, https://uni-agent-sdk.readthedocs.io
Project-URL: Repository, https://github.com/uni-im/uni-agent-sdk.git
Project-URL: Issues, https://github.com/uni-im/uni-agent-sdk/issues
Keywords: chatbot,agent,ai,uni-im,messaging
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Topic :: Communications :: Chat
Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
Requires-Python: >=3.8
Description-Content-Type: text/markdown
Requires-Dist: aiohttp>=3.8.0
Requires-Dist: pydantic>=1.10.0
Requires-Dist: litellm>=1.0.0
Requires-Dist: pika>=1.3.0
Requires-Dist: httpx>=0.24.0
Requires-Dist: tomli>=2.0.0; python_version < "3.11"
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: pytest-asyncio>=0.21.0; extra == "dev"
Requires-Dist: black>=22.0.0; extra == "dev"
Requires-Dist: isort>=5.10.0; extra == "dev"
Requires-Dist: flake8>=4.0.0; extra == "dev"
Requires-Dist: mypy>=0.991; extra == "dev"
Provides-Extra: docs
Requires-Dist: sphinx>=5.0.0; extra == "docs"
Requires-Dist: sphinx-rtd-theme>=1.0.0; extra == "docs"
Dynamic: author
Dynamic: home-page
Dynamic: requires-python

# uni-agent-sdk

æ™ºèƒ½ä½“å¼€å‘SDK - æç®€çš„uni-imå¹³å°æ™ºèƒ½ä½“å¼€å‘æ¡†æ¶

è®©å¼€å‘è€…åªéœ€3è¡Œä»£ç å°±èƒ½åˆ›å»ºå¼ºå¤§çš„æ™ºèƒ½ä½“ï¼Œè‡ªåŠ¨å¤„ç†æ¶ˆæ¯æ¥æ”¶ã€LLMæ¨ç†ã€å“åº”å‘é€ç­‰å¤æ‚æµç¨‹ã€‚

## ğŸš€ ç‰¹æ€§

- **æç®€API**: åªéœ€3è¡Œä»£ç åˆ›å»ºæ™ºèƒ½ä½“
- **æ— çŠ¶æ€æ¶æ„**: åŸºäºRabbitMQçš„æ— çŠ¶æ€æ¶ˆè´¹è€…æ¨¡å¼
- **å¼€ç®±å³ç”¨**: å†…ç½®LLMé›†æˆã€å¹³å°é€šä¿¡ã€æ–‡ä»¶å¤„ç†
- **ç±»å‹å®‰å…¨**: å®Œæ•´çš„ç±»å‹æ³¨è§£å’ŒPydanticéªŒè¯
- **é«˜æ€§èƒ½**: å¼‚æ­¥å¤„ç†ï¼Œæ”¯æŒå¹¶å‘æ¶ˆæ¯å¤„ç†
- **æ˜“äºæ‰©å±•**: æ”¯æŒå‡½æ•°è°ƒç”¨ã€ä¸Šä¸‹æ–‡è®°å¿†ç­‰é«˜çº§åŠŸèƒ½

## ğŸ“¦ å®‰è£…

```bash
pip install uni-agent-sdk
```

## âš¡ å¿«é€Ÿå¼€å§‹

### æœ€ç®€å•çš„æ™ºèƒ½ä½“

```python
import asyncio
from uni_agent_sdk import Agent, Message, Response

class SimpleAgent(Agent):
    async def handle_message(self, message: Message, context: dict) -> Response:
        return Response.text(f"ä½ å¥½ï¼æˆ‘æ”¶åˆ°äº†ï¼š{message.content}")

# å¯åŠ¨æ™ºèƒ½ä½“
agent = SimpleAgent(
    api_key="your_api_key",
    api_secret="your_api_secret",
    openrouter_api_key="your_openrouter_key"
)
asyncio.run(agent.start())
```

### AIæ™ºèƒ½ä½“ï¼ˆä½¿ç”¨LLMï¼‰

```python
class AIAgent(Agent):
    async def handle_message(self, message: Message, context: dict) -> Response:
        # ç›´æ¥ä½¿ç”¨å†…ç½®çš„LLMæœåŠ¡
        reply = await self.llm.chat(
            message.content,
            system_prompt="ä½ æ˜¯ä¸€ä¸ªå‹å–„çš„AIåŠ©æ‰‹"
        )
        return Response.text(reply)
```

### ä¸Šä¸‹æ–‡æ„ŸçŸ¥æ™ºèƒ½ä½“

```python
class ContextualAgent(Agent):
    async def handle_message(self, message: Message, context: dict) -> Response:
        # è·å–å†å²æ¶ˆæ¯
        history = context.get('messages', [])

        # æ„å»ºå¯¹è¯å†å²
        conversation = []
        for hist_msg in history[-5:]:  # æœ€è¿‘5æ¡æ¶ˆæ¯
            conversation.append({
                "role": "user" if hist_msg['from_uid'] == message.from_uid else "assistant",
                "content": hist_msg['body']
            })

        # æ·»åŠ å½“å‰æ¶ˆæ¯
        conversation.append({"role": "user", "content": message.content})

        # ç”Ÿæˆå›å¤
        reply = await self.llm.chat(conversation)
        return Response.text(reply)
```

## ğŸ”§ é…ç½®

### ç¯å¢ƒå˜é‡é…ç½®

```bash
# å¿…éœ€é…ç½®
export OPENROUTER_API_KEY="sk-or-v1-xxx"
export RABBITMQ_HOST="your-rabbitmq-host"
export RABBITMQ_USER="your-username"
export RABBITMQ_PASSWORD="your-password"

# å¯é€‰é…ç½®
export PLATFORM_BASE_URL="https://uni-im.dcloud.net.cn"
export DEFAULT_MODEL="openai/gpt-3.5-turbo"
export LOG_LEVEL="INFO"
```

### ä»£ç é…ç½®

```python
agent = MyAgent(
    api_key="robot_xxx",
    api_secret="xxx",

    # OpenRouteré…ç½®
    openrouter_api_key="sk-or-v1-xxx",

    # RabbitMQé…ç½®
    rabbitmq_host="localhost",
    rabbitmq_port=5673,
    rabbitmq_user="guest",
    rabbitmq_password="guest",

    # LLMé…ç½®
    default_model="openai/gpt-3.5-turbo",
    default_temperature=0.7,

    # å…¶ä»–é…ç½®
    log_level="INFO"
)
```

## ğŸ“š ç¤ºä¾‹

æŸ¥çœ‹ `examples/` ç›®å½•è·å–æ›´å¤šç¤ºä¾‹ï¼š

- **simple_agent.py**: æœ€ç®€å•çš„å›å£°æ™ºèƒ½ä½“
- **ai_agent.py**: ä½¿ç”¨LLMçš„AIæ™ºèƒ½ä½“
- **contextual_agent.py**: æ”¯æŒä¸Šä¸‹æ–‡è®°å¿†çš„æ™ºèƒ½ä½“
- **function_agent.py**: æ”¯æŒå‡½æ•°è°ƒç”¨çš„æ™ºèƒ½ä½“

## ğŸ—ï¸ æ¶æ„

```
ç”¨æˆ·æ¶ˆæ¯ â†’ uni-imå¹³å° â†’ RabbitMQ â†’ SDKæ¶ˆè´¹è€… â†’ å¼€å‘è€…æ™ºèƒ½ä½“
                                                    â†“
ç”¨æˆ·æ”¶åˆ°å›å¤ â† uni-imå¹³å° â† HTTP API â† SDKå“åº” â† LLMæ¨ç†
```

### æ ¸å¿ƒç»„ä»¶

- **Agent**: æ™ºèƒ½ä½“åŸºç±»ï¼Œå¤„ç†æ¶ˆæ¯æ¥æ”¶å’Œå“åº”
- **LLMService**: LLMæœåŠ¡ï¼Œæ”¯æŒå¤šç§æ¨¡å‹
- **PlatformAPI**: å¹³å°é€šä¿¡æœåŠ¡
- **FileService**: æ–‡ä»¶ä¸Šä¼ ä¸‹è½½æœåŠ¡
- **Config**: é…ç½®ç®¡ç†

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python run_tests.py

# è¿è¡Œç‰¹å®šæµ‹è¯•
python -m unittest tests.test_crypto

# è¿è¡Œé›†æˆæµ‹è¯•
python -m pytest tests/test_integration.py -v
```

## ğŸ“– APIæ–‡æ¡£

### Agentç±»

```python
class Agent(ABC):
    """æ™ºèƒ½ä½“æŠ½è±¡åŸºç±»"""

    @abstractmethod
    async def handle_message(self, message: Message, context: dict) -> Response:
        """å¤„ç†æ¶ˆæ¯çš„æŠ½è±¡æ–¹æ³•"""
        pass

    async def start(self):
        """å¯åŠ¨æ™ºèƒ½ä½“"""
        pass

    async def stop(self):
        """åœæ­¢æ™ºèƒ½ä½“"""
        pass
```

### æ¶ˆæ¯ç±»å‹

```python
class Message(BaseModel):
    """æ¥æ”¶æ¶ˆæ¯æ¨¡å‹"""
    id: str
    from_uid: str
    to_uid: str
    conversation_id: str
    content: str
    message_type: str = "text"
    create_time: int

class Response(BaseModel):
    """å“åº”æ¶ˆæ¯æ¨¡å‹"""
    content: str
    response_type: str = "text"
    metadata: Dict[str, Any] = {}

    @classmethod
    def text(cls, content: str) -> "Response":
        """åˆ›å»ºæ–‡æœ¬å“åº”"""

    @classmethod
    def image(cls, image_url: str, caption: str = "") -> "Response":
        """åˆ›å»ºå›¾ç‰‡å“åº”"""

    @classmethod
    def file(cls, file_url: str, filename: str) -> "Response":
        """åˆ›å»ºæ–‡ä»¶å“åº”"""
```

### LLMæœåŠ¡

```python
class LLMService:
    """LLMæ¨ç†æœåŠ¡"""

    async def chat(self, messages, model=None, temperature=None) -> str:
        """èŠå¤©æ¥å£"""

    async def chat_stream(self, messages, model=None) -> AsyncIterator[str]:
        """æµå¼èŠå¤©æ¥å£"""

    async def function_call(self, messages, functions) -> Dict:
        """å‡½æ•°è°ƒç”¨æ¥å£"""
```

## ğŸ”’ å®‰å…¨

- ä½¿ç”¨HMAC-SHA256ç­¾åéªŒè¯APIè¯·æ±‚
- æ”¯æŒç­¾åè¿‡æœŸæ—¶é—´è®¾ç½®
- æ•æ„Ÿä¿¡æ¯è‡ªåŠ¨è„±æ•æ˜¾ç¤º
- é…ç½®éªŒè¯å’Œç±»å‹æ£€æŸ¥

## ğŸš€ éƒ¨ç½²

### å•è¿›ç¨‹éƒ¨ç½²

```python
# main.py
import asyncio
from my_agent import MyAgent

async def main():
    agent = MyAgent(
        api_key="xxx",
        api_secret="xxx",
        openrouter_api_key="xxx"
    )
    await agent.start()

if __name__ == "__main__":
    asyncio.run(main())
```

### Dockeréƒ¨ç½²

```dockerfile
FROM python:3.9-slim

WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .
CMD ["python", "main.py"]
```

### å¤šå®ä¾‹è´Ÿè½½å‡è¡¡

åŒä¸€æ™ºèƒ½ä½“å¯ä»¥è¿è¡Œå¤šä¸ªè¿›ç¨‹å®ä¾‹ï¼ŒRabbitMQä¼šè‡ªåŠ¨è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ†˜ æ”¯æŒ

- ğŸ“§ é‚®ç®±: support@uni-im.com
- ğŸ’¬ QQç¾¤: 123456789
- ğŸ“– æ–‡æ¡£: https://uni-im.dcloud.net.cn/docs
- ğŸ› é—®é¢˜åé¦ˆ: https://github.com/uni-im/uni-agent-sdk/issues

## ğŸ† è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š

- [litellm](https://github.com/BerriAI/litellm) - ç»Ÿä¸€LLM API
- [pika](https://github.com/pika/pika) - RabbitMQå®¢æˆ·ç«¯
- [pydantic](https://github.com/pydantic/pydantic) - æ•°æ®éªŒè¯
- [aiohttp](https://github.com/aio-libs/aiohttp) - å¼‚æ­¥HTTPå®¢æˆ·ç«¯
