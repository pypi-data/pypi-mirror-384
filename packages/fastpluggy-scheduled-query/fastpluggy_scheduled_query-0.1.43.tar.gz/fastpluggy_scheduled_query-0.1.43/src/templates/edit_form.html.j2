<div class="card">
    <div class="card-header">
        <h3 class="card-title">
            <i class="ti ti-edit me-2"></i>
            Edit Scheduled Query
        </h3>
    </div>
    <div class="card-body">
        <form method="post" action="{{ widget.form_action }}">
            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label" for="name">Query Name</label>
                        <input type="text" class="form-control" id="name" name="name" 
                               value="{{ widget.query.name }}" required>
                        <div class="form-text">A descriptive name for this scheduled query</div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label" for="cron_schedule">Cron Schedule</label>
                        <input type="text" class="form-control" id="cron_schedule" name="cron_schedule" 
                               value="{{ widget.query.cron_schedule }}" required>
                        <div class="form-text">Cron expression (e.g., "0 */6 * * *" for every 6 hours)</div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label" for="render_type">Render Type</label>
                        <select class="form-select" id="render_type" name="render_type">
                            <option value="auto" {% if widget.query.render_type == 'auto' or not widget.query.render_type %}selected{% endif %}>
                                Auto (Automatic Detection)
                            </option>
                            <option value="table" {% if widget.query.render_type == 'table' %}selected{% endif %}>
                                Table (Force Table Display)
                            </option>
                            <option value="counter" {% if widget.query.render_type == 'counter' %}selected{% endif %}>
                                Counter (Force Counter/Metric Display)
                            </option>
                            <option value="metric" {% if widget.query.render_type == 'metric' %}selected{% endif %}>
                                Metric (Force Metric Display)
                            </option>
                            <option value="raw" {% if widget.query.render_type == 'raw' %}selected{% endif %}>
                                Raw (Force Raw Text Display)
                            </option>
                        </select>
                        <div class="form-text">How to display query results</div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <div class="form-check form-switch mt-4">
                            <input class="form-check-input" type="checkbox" id="enabled" name="enabled" 
                                   {% if widget.query.enabled %}checked{% endif %}>
                            <label class="form-check-label" for="enabled">
                                Enable Query Execution
                            </label>
                        </div>
                        <div class="form-text">Whether this query should be executed on schedule</div>
                    </div>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label" for="query">SQL Query</label>
                <textarea class="form-control" id="query" name="query" rows="8" required>{{ widget.query.query }}</textarea>
                <div class="form-text">The SQL query to execute on schedule</div>
            </div>

            <div class="card-footer">
                <div class="d-flex justify-content-between">
                    <a href="{{ request.url_for('read_scheduled_queries') }}" class="btn btn-secondary">
                        <i class="ti ti-arrow-left me-2"></i>
                        Cancel
                    </a>
                    <button type="submit" class="btn btn-primary">
                        <i class="ti ti-device-floppy me-2"></i>
                        Save Changes
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>

<style>
.form-text {
    font-size: 0.875rem;
    color: #6c757d;
}

.card-footer {
    background-color: #f8f9fa;
    border-top: 1px solid #dee2e6;
    padding: 1rem;
    margin-top: 1rem;
}

textarea.form-control {
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-size: 0.875rem;
}

.form-check-input:checked {
    background-color: #0d6efd;
    border-color: #0d6efd;
}
</style>