{
    "name": "{{ cluster_name }}",
    "alias": "{{ alias }}",
    "region": "{{ region }}",
    "version": "{{ version }}",
    "resources": {
        "elasticsearch": [
            {
                "ref_id": "main-elasticsearch",
                "display_name": "{{ display_name }}",
                "region": "{{ region }}",
                "plan": {
                    "cluster_topology": [
                        {
                            "id": "hot_content",
                            "node_type": {
                                "data": true
                            },
                            "node_roles": [
                                "master"
                            ],
                            "zone_count": {{ hot_zone_count | default(zone_count)) }},
                            "elasticsearch": {
                                "version": "{{ version }}",
                                "user_settings_yaml": "",
                                "user_settings_override_yaml": ""
                            },
                            "instance_configuration_id": "string",
                            "instance_configuration_version": 42,
                            "size": {
                                "value": {{ hot_memory }},
                                "resource": "memory"
                            },
                            "autoscaling_max": {
                                "value": {{ autoscaling_max | default(122880) }},
                                "resource": "memory"
                            }
                        }
                    ],
                    "elasticsearch": {
                        "version": "{{ version }}",
                        "user_settings_yaml": "",
                        "user_settings_override_yaml": ""
                    },
                    "deployment_template": {
                        "id": "{{ deployment_template }}"
                    },
                    "autoscaling_enabled": true
                },
                "settings": {
                    "snapshot": {
                        "interval": "string",
                        "retention": {
                            "snapshots": 42,
                            "max_age": "string"
                        },
                        "cron_expression": "string"
                    },
                    "monitoring": {
                        "target_cluster_id": "string"
                    },
                    "metadata": {
                        "name": "string"
                    },
                    "curation": {
                        "specs": [
                            {
                                "index_pattern": "string",
                                "trigger_interval_seconds": 42
                            }
                        ]
                    },
                    "dedicated_masters_threshold": 42,
                    "traffic_filter": {
                        "rulesets": [
                            "string"
                        ]
                    },
                    "trust": {
                        "accounts": [
                            {
                                "account_id": "string",
                                "name": "string",
                                "trust_all": true,
                                "trust_allowlist": [
                                    "string"
                                ]
                            }
                        ],
                        "external": [
                            {
                                "trust_relationship_id": "string",
                                "name": "string",
                                "trust_all": true,
                                "trust_allowlist": [
                                    "string"
                                ]
                            }
                        ],
                        "direct": [
                            {
                                "uid": "string",
                                "name": "string",
                                "type": "ECE",
                                "trust_all": true,
                                "trust_allowlist": [
                                    "string"
                                ],
                                "scope_id": "abc123",
                                "additional_node_names": [
                                    "string"
                                ],
                                "certificates": [
                                    {
                                        "pem": "string"
                                    }
                                ]
                            }
                        ]
                    },
                    "keystore_contents": {
                        "secrets": {
                            "additionalProperty1": {
                                "value": {},
                                "as_file": true
                            },
                            "additionalProperty2": {
                                "value": {},
                                "as_file": true
                            }
                        }
                    }
                }
            }
        ],
        "kibana": [
            {
                "ref_id": "main-kibana",
                "elasticsearch_cluster_ref_id": "main-elasticsearch",
                "display_name": "string",
                "region": "{{ region }}",
                "plan": {
                    "cluster_topology": [
                        {
                            "instance_configuration_id": "azure.kibana.fsv2",
                            "size": {
                                "value": {{ kibana_memory | default(1024)}},
                                "resource": "memory"
                            },
                            "zone_count": {{ kiban_zone_count | default(zone_count) }},
                            "kibana": {
                                "user_settings_yaml": ""
                            }
                        }
                    ],
                    "kibana": {
                        "user_settings_json": {
                            "xpack": {
                                "banners": {
                                    "text": "Hallo"
                                }
                            }
                        }
                    }
                }
            }
        ]
    },
    "settings": {
        "traffic_filter_settings": {
            "rulesets": [
            {% for ruleset in traffic_filter_rulesets | default([]) %}
                "{{ ruleset }}"{% if not loop.last %},{% endif %}
            {% endfor %}
            ]
        },
        "observability": {
            "logging": {
                "destination": {
                    "deployment_id": "self"
                }
            },
            "metrics": {
                "destination": {
                    "deployment_id": "self"
                }
            }
        },
        "autoscaling_enabled": true
    },
    "metadata": {
        "tags": [
        {% key, value in tags.itmes() | default([]) %}
            {
                "key": "{{ key }}",
                "value": "{{ value }}"
            }{% if not loop.last %},{% endif %}
        {% endfor %}
        ]
    }
}
