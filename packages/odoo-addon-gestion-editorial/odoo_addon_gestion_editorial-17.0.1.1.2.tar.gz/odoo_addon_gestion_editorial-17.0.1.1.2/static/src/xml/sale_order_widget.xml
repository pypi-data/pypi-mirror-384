<?xml version="1.0" encoding="UTF-8" ?>

<!-- Modified version of original code from OCB
https://github.com/OCA/OCB/blob/17.0/addons/sale_stock/static/src/widgets/qty_at_date_widget.xml
-->

<templates id="template" xml:space="preserve">

    <t t-name="gestion_editorial.SaleOrderWidget">
        <a t-att-tabindex="props.record.data.display_qty_widget ? '0' : '-1'"
            t-on-click="showPopup"
            t-att-class="!props.record.data.display_qty_widget ? 'invisible' : ''"
            t-attf-class="fa fa-area-chart cursor-pointer {{ calcData.not_enough_stock ? 'text-danger' : '' }}"
        />
    </t>

    <t t-name="gestion_editorial.SaleOrderPopover">
        <div class="p-2">
        <h6>Availability</h6>
        <hr/>
        <table class="table table-borderless table-sm">
            <tbody>
                <t t-if="!props.record.data.is_mto and ['draft', 'sent'].includes(props.record.data.state)">
                    <tr>
                        <td><strong>En almacén</strong><br/><small>Al <span t-out="props.calcData.delivery_date"/></small></td>
                        <td class="text-end"><b t-out='props.record.data.in_stock_qty'/> <t t-out='props.record.data.product_uom[1]'/></td>
                    </tr>
                    <tr>
                        <td><strong>En distribución</strong><br/><small>Al <span t-out="props.calcData.delivery_date"/></small></td>
                        <td class="text-end"><b t-out='props.record.data.in_distribution_qty'/> <t t-out='props.record.data.product_uom[1]'/></td>
                    </tr>
                </t>
            </tbody>
        </table>
        </div>
    </t>
</templates>
