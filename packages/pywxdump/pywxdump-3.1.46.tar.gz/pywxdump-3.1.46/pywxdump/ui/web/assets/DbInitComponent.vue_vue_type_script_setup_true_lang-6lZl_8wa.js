import{d as $,r as s,h as D,o,b as u,i as r,v as A,e,w as g,H as x,u as y,I as G,f as p,c as j,k as _,t as Q,N as T,O as B,z as E,K as R,J as K,P as X}from"./index-xAnPWFJT.js";const Z={class:"progress-bar"},P=$({__name:"ProgressBar",props:{startORstop:{type:Number,required:!0}},setup(I){const d=s(0),f=s(500),n=[{color:"#f56c6c",percentage:20},{color:"#e6a23c",percentage:40},{color:"#5cb87a",percentage:60},{color:"#1989fa",percentage:80},{color:"#6f7ad3",percentage:100}],w=s(new Date().getTime()),m=I,b=()=>{if(m.startORstop===1){d.value=100;return}w.value=new Date().getTime(),!(d.value>=99)&&(d.value>=60&&(f.value=f.value+50),d.value=d.value+1,setTimeout(b,f.value))};return b(),(a,k)=>{const c=D("el-progress");return o(),u("div",Z,[r(c,{type:"dashboard",percentage:d.value,color:n},null,8,["percentage"])])}}}),ee={style:{"background-color":"#d2d2fa",height:"100%",display:"flex","justify-content":"center","align-items":"center"}},te={key:0},le={style:{"background-color":"#fff",width:"90%","min-width":"800px",height:"80%","border-radius":"10px",padding:"20px",overflow:"auto"}},ae=e("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[e("div",{style:{"font-size":"20px","font-weight":"bold"}},"选择要查看的微信")],-1),oe={style:{"margin-top":"20px"}},ie={style:{"margin-top":"20px"}},se={key:1},ne={key:0},re={key:1,style:{"background-color":"#fff",width:"90%","min-width":"800px",height:"80%","border-radius":"10px",padding:"20px",overflow:"auto"}},ue=e("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[e("div",{style:{"font-size":"20px","font-weight":"bold"}},"选择要查看的微信(会清空work下对应wxid数据)")],-1),de={style:{"margin-top":"20px"}},ce={style:{"margin-top":"20px"}},pe={key:2},ve={key:0},_e={key:1,style:{"background-color":"#fff",width:"80%","min-width":"800px",height:"70%","border-radius":"10px",padding:"20px",overflow:"auto"}},ye=e("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[e("div",{style:{"font-size":"20px","font-weight":"bold"}},"自定义-文件位置"),e("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}})],-1),fe={style:{"margin-top":"20px"}},he={key:0},me=e("br",null,null,-1),ge=e("br",null,null,-1),xe={key:1},we=e("br",null,null,-1),be=e("br",null,null,-1),ke={key:2},Ve=e("label",null,"密钥key(必填): ",-1),Me=e("br",null,null,-1),Ce={key:3},Te=e("label",null,"merge_all.db 文件路径(必填,非文件夹): ",-1),Be=e("br",null,null,-1),Ee=e("label",null,"微信文件夹路径(必填): ",-1),Oe=e("br",null,null,-1),Ue=e("label",null,"微信原始id(必填): ",-1),je=e("br",null,null,-1),Re={key:3,style:{display:"flex","justify-content":"space-between"}},De={style:{width:"200px",height:"150px","background-color":"#fff",display:"flex","flex-direction":"column","align-items":"center","border-radius":"10px","margin-right":"20px"}},Se=e("div",{style:{display:"flex","flex-direction":"column","justify-content":"center","align-items":"center",height:"100%"}},[e("div",null,"使用历史数据")],-1),Ie={style:{width:"200px",height:"150px","background-color":"#fff",display:"flex","flex-direction":"column","align-items":"center","border-radius":"10px","margin-right":"20px"}},Ne=e("div",{style:{display:"flex","flex-direction":"column","justify-content":"center","align-items":"center",height:"100%"}},[e("div",null,"自动解密已登录微信")],-1),We={style:{width:"200px",height:"150px","background-color":"#fff",display:"flex","flex-direction":"column","align-items":"center","border-radius":"10px"}},qe=e("div",{style:{display:"flex","flex-direction":"column","justify-content":"center","align-items":"center",height:"100%"}},[e("div",null,"自定义文件位置")],-1),Ge=$({__name:"DbInitComponent",setup(I){const d=s(0),f=s(-1),n=s(""),w=s(!1),m=s([]),b=s(""),a=s(!1),k=s(!1),c=s("false"),V=s(""),h=s(""),M=s(""),v=s(""),O=s([]),S=l=>{l&&(localStorage.setItem("isDbInit","t"),X.push("/"),K({type:"success",message:"初始化成功！"}))},N=async()=>{if(a.value){console.log("正在解密中，请稍后再试！");return}a.value=!0;try{a.value=!0,f.value=0;let l={wx_path:h.value,key:M.value,my_wxid:v.value};const t=await E.post("/api/ls/init_key",l);w.value=t.is_init,t.is_init&&(d.value=100),a.value=!1,S(t.is_init)}catch(l){return d.value=0,k.value=!0,a.value=!1,R.alert(l,"error",{confirmButtonText:"确认",callback:t=>{K({type:"error",message:`action: ${t}`})}}),[]}a.value=!1},Y=async()=>{try{let l={wx_path:h.value,merge_path:V.value,my_wxid:v.value};const t=await E.post("/api/ls/init_nokey",l);w.value=t.is_init,t.is_init&&(d.value=100),a.value=!1,S(t.is_init)}catch(l){return d.value=0,k.value=!0,a.value=!1,R.alert(l,"error",{confirmButtonText:"确认",callback:t=>{n.value=""}}),[]}a.value=!1},F=async l=>{v.value=l.wxid},H=async()=>{try{const l=await E.post("/api/ls/init_last_local_wxid");O.value=l.local_wxids.map(t=>({wxid:t})),O.value.length===1&&(v.value=O.value[0].wxid,await W())}catch(l){return console.error("Error fetching data:",l),[]}},W=async()=>{try{let l={wx_path:h.value,merge_path:V.value,my_wxid:v.value};const t=await E.post("/api/ls/init_last",l);w.value=t.is_init,t.is_init?(d.value=100,a.value=!1,S(t.is_init)):(k.value=!0,a.value=!1,R.alert("未发现上次的设置数据！","error",{confirmButtonText:"确认",callback:C=>{n.value=""}})),a.value=!1}catch(l){return k.value=!0,a.value=!1,R.alert(l,"error",{confirmButtonText:"确认",callback:t=>{n.value=""}}),[]}a.value=!1},J=async()=>{try{m.value=await E.post("/api/ls/wxinfo"),m.value.length===1&&(q(m.value[0]),b.value=" (检测到只有一个微信，将在5秒后自动选择) ",setTimeout(z,5e3))}catch(l){return console.error("Error fetching data:",l),[]}},q=async l=>{V.value="",h.value=l.wx_dir,M.value=l.key,v.value=l.wxid},z=()=>{if(h.value===""&&M.value===""&&v.value===""){console.log("请填写完整信息! ");return}if(a.value){console.log("正在解密...，请稍后再试！");return}N()};return A(n,l=>{l==="auto"?J():l==="custom"||l==="last"&&H()}),(l,t)=>{const C=D("el-button"),L=D("el-divider"),U=D("el-input");return o(),u("div",ee,[n.value==="last"?(o(),u("div",te,[e("div",le,[ae,e("div",oe,[r(y(G),{data:O.value,onCurrentChange:F,"highlight-current-row":"",style:{width:"100%"}},{default:g(()=>[r(y(x),{"min-width":50,prop:"wxid",label:"微信原始id"})]),_:1},8,["data"])]),e("div",ie,[r(C,{style:{"margin-right":"10px","margin-top":"10px",width:"100%"},type:"success",onClick:W},{default:g(()=>[p("确定 ")]),_:1})])])])):n.value==="auto"?(o(),u("div",se,[a.value?(o(),u("div",ne,[a.value?(o(),j(P,{key:0,startORstop:f.value},null,8,["startORstop"])):_("",!0)])):(o(),u("div",re,[ue,e("div",de,[r(y(G),{data:m.value,onCurrentChange:q,"highlight-current-row":"",style:{width:"100%"}},{default:g(()=>[r(y(x),{"min-width":30,prop:"pid",label:"进程id"}),r(y(x),{"min-width":40,prop:"version",label:"微信版本"}),r(y(x),{"min-width":40,prop:"account",label:"账号"}),r(y(x),{"min-width":40,prop:"nickname",label:"昵称"}),r(y(x),{"min-width":50,prop:"wxid",label:"微信原始id"})]),_:1},8,["data"])]),e("div",ce,[r(C,{style:{"margin-right":"10px","margin-top":"10px",width:"100%"},type:"success",onClick:z},{default:g(()=>[p("确定"+Q(b.value),1)]),_:1})])]))])):n.value==="custom"?(o(),u("div",pe,[a.value?(o(),u("div",ve,[a.value?(o(),j(P,{key:0,startORstop:f.value},null,8,["startORstop"])):_("",!0)])):(o(),u("div",_e,[ye,e("div",fe,[T(e("input",{type:"radio","onUpdate:modelValue":t[0]||(t[0]=i=>c.value=i),value:"true"},null,512),[[B,c.value]]),p(" 使用 KEY          "),T(e("input",{type:"radio","onUpdate:modelValue":t[1]||(t[1]=i=>c.value=i),value:"false"},null,512),[[B,c.value]]),p(" 不使用 KEY "),c.value=="false"?(o(),u("div",he,[p(" 说明：1、表示数据库已解密并合并"),me,p("2、合并后的数据库需要包含(MediaMSG,MSG,MicroMsg,OpenIMMsg)这些数据库合并的内容"),ge])):_("",!0),c.value=="true"?(o(),u("div",xe,[p(" 说明：1、自动根据key解密微信文件夹下的数据库"),we,p("2、必须保证key正确，否则解密失败"),be])):_("",!0),r(L),c.value=="true"?(o(),u("div",ke,[Ve,r(U,{placeholder:"密钥key (64位)",modelValue:M.value,"onUpdate:modelValue":t[2]||(t[2]=i=>M.value=i),style:{width:"80%"}},null,8,["modelValue"]),Me])):_("",!0),c.value=="false"?(o(),u("div",Ce,[Te,r(U,{placeholder:"(MediaMSG.db,MSG.db,MicroMsg.db,OpenIMMsg.db)合并后的数据库",modelValue:V.value,"onUpdate:modelValue":t[3]||(t[3]=i=>V.value=i),style:{width:"80%"}},null,8,["modelValue"]),Be])):_("",!0),Ee,r(U,{placeholder:"C:\\***\\WeChat Files\\wxid_*******",modelValue:h.value,"onUpdate:modelValue":t[4]||(t[4]=i=>h.value=i),style:{width:"80%"}},null,8,["modelValue"]),Oe,Ue,r(U,{placeholder:"wxid_*******",modelValue:v.value,"onUpdate:modelValue":t[5]||(t[5]=i=>v.value=i),style:{width:"80%"}},null,8,["modelValue"]),je,c.value=="true"?(o(),j(C,{key:4,style:{"margin-top":"10px",width:"100%"},type:"success",onClick:N},{default:g(()=>[p(" 确定 ")]),_:1})):_("",!0),c.value=="false"?(o(),j(C,{key:5,style:{"margin-top":"10px",width:"100%"},type:"success",onClick:Y},{default:g(()=>[p(" 确定 ")]),_:1})):_("",!0)])]))])):n.value===""?(o(),u("div",Re,[e("label",De,[T(e("input",{type:"radio","onUpdate:modelValue":t[6]||(t[6]=i=>n.value=i),value:"last"},null,512),[[B,n.value]]),Se]),e("label",Ie,[T(e("input",{type:"radio","onUpdate:modelValue":t[7]||(t[7]=i=>n.value=i),value:"auto"},null,512),[[B,n.value]]),Ne]),e("label",We,[T(e("input",{type:"radio","onUpdate:modelValue":t[8]||(t[8]=i=>n.value=i),value:"custom"},null,512),[[B,n.value]]),qe])])):_("",!0)])}}});export{Ge as _};
