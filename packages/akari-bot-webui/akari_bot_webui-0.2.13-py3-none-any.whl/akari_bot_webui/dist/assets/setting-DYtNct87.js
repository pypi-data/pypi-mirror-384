import{T as ve,ag as Z,a1 as ut,aF as Te,a9 as ke,p as P,Z as q,j as E,q as ie,z as B,bp as Se,aq as Ie,ar as O,C as ue,X as U,h as F,c as L,o as S,a as v,a2 as r,H as K,n as k,at as ae,aZ as le,aw as W,cc as te,bV as $e,F as ct,y as dt,m as Le,c6 as ht,k as ft,aL as Be,aj as G,G as Me,i as D,x as R,e as m,a4 as pt,L as Ae,a8 as De,aH as me,aQ as mt,cd as vt,bq as oe,aI as gt,aS as _t,aK as bt,ce as wt,aT as Ct,bg as yt,cf as kt,cg as St,w as $,aV as Ee,A as se,a3 as Pe,bu as $t,B as Ve,as as Et,K as Pt,E as Q,d as I,t as T,b_ as Vt,J as Tt,aX as he,ch as fe,aA as ne,_ as j,aC as J,f as H,u as ce,I as Re,ci as It}from"./index-B83Nj5wy.js";import{E as Fe}from"./index-CIlHu57m.js";/* empty css               */import{E as Lt}from"./index-nma4EivO.js";import{h as Bt,a as Mt,E as At}from"./select-DWPJjTK6.js";import{E as Dt,a as Rt}from"./form-item-BTA-ycNk.js";import"./validator-r28DD-hG.js";import"./_baseClone-BOzpZ_uO.js";import"./_initCloneObject-D0WUAqkw.js";const Ft=ve({color:{type:Z(Object),required:!0},vertical:Boolean,disabled:Boolean});let pe=!1;function x(e,t){if(!ut)return;const l=function(a){var s;(s=t.drag)==null||s.call(t,a)},o=function(a){var s;document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",o),document.removeEventListener("touchmove",l),document.removeEventListener("touchend",o),document.onselectstart=null,document.ondragstart=null,pe=!1,(s=t.end)==null||s.call(t,a)},n=function(a){var s;pe||(a.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",l),document.addEventListener("mouseup",o),document.addEventListener("touchmove",l),document.addEventListener("touchend",o),pe=!0,(s=t.start)==null||s.call(t,a))};e.addEventListener("mousedown",n),e.addEventListener("touchstart",n,{passive:!1})}const ge=e=>{let t,l;return e.type==="touchend"?(l=e.changedTouches[0].clientY,t=e.changedTouches[0].clientX):e.type.startsWith("touch")?(l=e.touches[0].clientY,t=e.touches[0].clientX):(l=e.clientY,t=e.clientX),{clientX:t,clientY:l}},Ot=e=>{const t=ue(),{t:l}=Te(),o=ke(),n=ke(),a=P(()=>e.color.get("alpha")),s=P(()=>l("el.colorpicker.alphaLabel"));function d(i){var g;if(e.disabled)return;i.target!==o.value&&h(i),(g=o.value)==null||g.focus()}function h(i){if(!n.value||!o.value||e.disabled)return;const f=t.vnode.el.getBoundingClientRect(),{clientX:u,clientY:_}=ge(i);if(e.vertical){let b=_-f.top;b=Math.max(o.value.offsetHeight/2,b),b=Math.min(b,f.height-o.value.offsetHeight/2),e.color.set("alpha",Math.round((b-o.value.offsetHeight/2)/(f.height-o.value.offsetHeight)*100))}else{let b=u-f.left;b=Math.max(o.value.offsetWidth/2,b),b=Math.min(b,f.width-o.value.offsetWidth/2),e.color.set("alpha",Math.round((b-o.value.offsetWidth/2)/(f.width-o.value.offsetWidth)*100))}}function p(i){if(e.disabled)return;const{shiftKey:g}=i,f=Ie(i),u=g?10:1;switch(f){case O.left:case O.down:i.preventDefault(),i.stopPropagation(),w(-u);break;case O.right:case O.up:i.preventDefault(),i.stopPropagation(),w(u);break}}function w(i){let g=a.value+i;g=g<0?0:g>100?100:g,e.color.set("alpha",g)}return{thumb:o,bar:n,alpha:a,alphaLabel:s,handleDrag:h,handleClick:d,handleKeydown:p}},Kt=(e,{bar:t,thumb:l,handleDrag:o})=>{const n=ue(),a=q("color-alpha-slider"),s=E(0),d=E(0),h=E();function p(){if(!l.value||e.vertical)return 0;const y=n.vnode.el,C=e.color.get("alpha");return y?Math.round(C*(y.offsetWidth-l.value.offsetWidth/2)/100):0}function w(){if(!l.value)return 0;const y=n.vnode.el;if(!e.vertical)return 0;const C=e.color.get("alpha");return y?Math.round(C*(y.offsetHeight-l.value.offsetHeight/2)/100):0}function i(){if(e.color&&e.color.value){const{r:y,g:C,b:X}=e.color.toRgb();return`linear-gradient(to right, rgba(${y}, ${C}, ${X}, 0) 0%, rgba(${y}, ${C}, ${X}, 1) 100%)`}return""}function g(){s.value=p(),d.value=w(),h.value=i()}ie(()=>{if(!t.value||!l.value)return;const y={drag:C=>{o(C)},end:C=>{o(C)}};x(t.value,y),x(l.value,y),g()}),B(()=>e.color.get("alpha"),()=>g()),B(()=>e.color.value,()=>g());const f=P(()=>[a.b(),a.is("vertical",e.vertical),a.is("disabled",e.disabled)]),u=P(()=>a.e("bar")),_=P(()=>a.e("thumb")),b=P(()=>({background:h.value})),M=P(()=>({left:Se(s.value),top:Se(d.value)}));return{rootKls:f,barKls:u,barStyle:b,thumbKls:_,thumbStyle:M,update:g}},Ht="ElColorAlphaSlider",Nt=F({name:Ht}),zt=F({...Nt,props:Ft,setup(e,{expose:t}){const l=e,{alpha:o,alphaLabel:n,bar:a,thumb:s,handleDrag:d,handleClick:h,handleKeydown:p}=Ot(l),{rootKls:w,barKls:i,barStyle:g,thumbKls:f,thumbStyle:u,update:_}=Kt(l,{bar:a,thumb:s,handleDrag:d});return t({update:_,bar:a,thumb:s}),(b,M)=>(S(),L("div",{class:k(r(w))},[v("div",{ref_key:"bar",ref:a,class:k(r(i)),style:K(r(g)),onClick:r(h)},null,14,["onClick"]),v("div",{ref_key:"thumb",ref:s,class:k(r(f)),style:K(r(u)),"aria-label":r(n),"aria-valuenow":r(o),"aria-orientation":b.vertical?"vertical":"horizontal","aria-valuemin":"0","aria-valuemax":"100",role:"slider",tabindex:"0",onKeydown:r(p)},null,46,["aria-label","aria-valuenow","aria-orientation","onKeydown"])],2))}});var Wt=U(zt,[["__file","alpha-slider.vue"]]);const qt=F({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean,disabled:Boolean},setup(e){const t=q("color-hue-slider"),l=ue(),o=E(),n=E(),a=E(0),s=E(0),d=P(()=>e.color.get("hue"));B(()=>d.value,()=>{g()});function h(f){if(e.disabled)return;f.target!==o.value&&p(f)}function p(f){if(!n.value||!o.value||e.disabled)return;const _=l.vnode.el.getBoundingClientRect(),{clientX:b,clientY:M}=ge(f);let y;if(e.vertical){let C=M-_.top;C=Math.min(C,_.height-o.value.offsetHeight/2),C=Math.max(o.value.offsetHeight/2,C),y=Math.round((C-o.value.offsetHeight/2)/(_.height-o.value.offsetHeight)*360)}else{let C=b-_.left;C=Math.min(C,_.width-o.value.offsetWidth/2),C=Math.max(o.value.offsetWidth/2,C),y=Math.round((C-o.value.offsetWidth/2)/(_.width-o.value.offsetWidth)*360)}e.color.set("hue",y)}function w(){if(!o.value)return 0;const f=l.vnode.el;if(e.vertical)return 0;const u=e.color.get("hue");return f?Math.round(u*(f.offsetWidth-o.value.offsetWidth/2)/360):0}function i(){if(!o.value)return 0;const f=l.vnode.el;if(!e.vertical)return 0;const u=e.color.get("hue");return f?Math.round(u*(f.offsetHeight-o.value.offsetHeight/2)/360):0}function g(){a.value=w(),s.value=i()}return ie(()=>{if(!n.value||!o.value||e.disabled)return;const f={drag:u=>{p(u)},end:u=>{p(u)}};x(n.value,f),x(o.value,f),g()}),{bar:n,thumb:o,thumbLeft:a,thumbTop:s,hueValue:d,handleClick:h,update:g,ns:t}}});function Ut(e,t,l,o,n,a){return S(),L("div",{class:k([e.ns.b(),e.ns.is("vertical",e.vertical)])},[v("div",{ref:"bar",class:k(e.ns.e("bar")),onClick:e.handleClick},null,10,["onClick"]),v("div",{ref:"thumb",class:k(e.ns.e("thumb")),style:K({left:e.thumbLeft+"px",top:e.thumbTop+"px"})},null,6)],2)}var jt=U(qt,[["render",Ut],["__file","hue-slider.vue"]]);const Oe=ve({modelValue:{type:Z(String),default:void 0},border:{type:Boolean,default:!0},showAlpha:Boolean,colorFormat:String,disabled:Boolean,predefine:{type:Z(Array)}}),Xt={[W]:e=>ae(e)||le(e)},Ke=Symbol("colorCommonPickerKey"),He=Symbol("colorPickerPanelContextKey");class re{constructor(t={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this._tiny=new te,this._isValid=!1,this.enableAlpha=!1,this.format="",this.value="";for(const l in t)$e(t,l)&&(this[l]=t[l]);t.value?this.fromString(t.value):this.doOnChange()}set(t,l){if(arguments.length===1&&typeof t=="object"){for(const o in t)$e(t,o)&&this.set(o,t[o]);return}this[`_${t}`]=l,this._isValid=!0,this.doOnChange()}get(t){return["hue","saturation","value","alpha"].includes(t)?Math.round(this[`_${t}`]):this[`_${t}`]}toRgb(){return this._isValid?this._tiny.toRgb():{r:255,g:255,b:255,a:0}}fromString(t){const l=new te(t);if(this._isValid=l.isValid,l.isValid){const{h:o,s:n,v:a,a:s}=l.toHsv();this._hue=o,this._saturation=n*100,this._value=a*100,this._alpha=s*100}else this._hue=0,this._saturation=100,this._value=100,this._alpha=100;this.doOnChange()}clear(){this._isValid=!1,this.value="",this._hue=0,this._saturation=100,this._value=100,this._alpha=100}compare(t){const l=new te({h:t._hue,s:t._saturation/100,v:t._value/100,a:t._alpha/100});return this._tiny.equals(l)}doOnChange(){const{_hue:t,_saturation:l,_value:o,_alpha:n,format:a,enableAlpha:s}=this;let d=a||(s?"rgb":"hex");a==="hex"&&s&&(d="hex8"),this._tiny=new te({h:t,s:l/100,v:o/100,a:n/100}),this.value=this._isValid?this._tiny.toString(d):""}}const Yt=F({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0},enableAlpha:{type:Boolean,required:!0},disabled:Boolean},setup(e){const t=q("color-predefine"),{currentColor:l}=Le(He),o=E(a(e.colors,e.color));B(()=>l.value,s=>{const d=new re({value:s});o.value.forEach(h=>{h.selected=d.compare(h)})}),ht(()=>{o.value=a(e.colors,e.color)});function n(s){e.disabled||e.color.fromString(e.colors[s])}function a(s,d){return s.map(h=>{const p=new re({value:h});return p.selected=p.compare(d),p})}return{rgbaColors:o,handleSelect:n,ns:t}}});function Gt(e,t,l,o,n,a){return S(),L("div",{class:k(e.ns.b())},[v("div",{class:k(e.ns.e("colors"))},[(S(!0),L(ct,null,dt(e.rgbaColors,(s,d)=>(S(),L("div",{key:e.colors[d],class:k([e.ns.e("color-selector"),e.ns.is("alpha",s.get("alpha")<100),{selected:s.selected}]),onClick:h=>e.handleSelect(d)},[v("div",{style:K({backgroundColor:s.value})},null,4)],10,["onClick"]))),128))],2)],2)}var Jt=U(Yt,[["render",Gt],["__file","predefine.vue"]]);const Zt=F({name:"ElSlPanel",props:{color:{type:Object,required:!0},disabled:Boolean},setup(e){const t=q("color-svpanel"),l=ue(),o=E(0),n=E(0),a=E("hsl(0, 100%, 50%)"),s=P(()=>{const p=e.color.get("hue"),w=e.color.get("value");return{hue:p,value:w}});function d(){const p=e.color.get("saturation"),w=e.color.get("value"),i=l.vnode.el,{clientWidth:g,clientHeight:f}=i;n.value=p*g/100,o.value=(100-w)*f/100,a.value=`hsl(${e.color.get("hue")}, 100%, 50%)`}function h(p){if(e.disabled)return;const i=l.vnode.el.getBoundingClientRect(),{clientX:g,clientY:f}=ge(p);let u=g-i.left,_=f-i.top;u=Math.max(0,u),u=Math.min(u,i.width),_=Math.max(0,_),_=Math.min(_,i.height),n.value=u,o.value=_,e.color.set({saturation:u/i.width*100,value:100-_/i.height*100})}return B(()=>s.value,()=>{d()}),ie(()=>{x(l.vnode.el,{drag:p=>{h(p)},end:p=>{h(p)}}),d()}),{cursorTop:o,cursorLeft:n,background:a,colorValue:s,handleDrag:h,update:d,ns:t}}});function Qt(e,t,l,o,n,a){return S(),L("div",{class:k(e.ns.b()),style:K({backgroundColor:e.background})},[v("div",{class:k(e.ns.e("white"))},null,2),v("div",{class:k(e.ns.e("black"))},null,2),v("div",{class:k(e.ns.e("cursor")),style:K({top:e.cursorTop+"px",left:e.cursorLeft+"px"})},[v("div")],6)],6)}var xt=U(Zt,[["render",Qt],["__file","sv-panel.vue"]]);const Ne=(e,t)=>{const l=ft(new re({enableAlpha:e.showAlpha,format:e.colorFormat||"",value:e.modelValue}));return B(()=>[e.colorFormat,e.showAlpha],()=>{l.enableAlpha=e.showAlpha,l.format=e.colorFormat||l.format,l.doOnChange(),t(W,l.value)}),{color:l}},eo=F({name:"ElColorPickerPanel"}),to=F({...eo,props:Oe,emits:Xt,setup(e,{expose:t,emit:l}){const o=e,n=q("color-picker-panel"),a=Be(),s=E(),d=E(),h=E(),p=E(),w=E(""),{color:i}=Le(Ke,()=>Ne(o,l),!0);function g(){i.fromString(w.value),i.value!==w.value&&(w.value=i.value)}function f(){var u,_,b;(u=s.value)==null||u.update(),(_=d.value)==null||_.update(),(b=h.value)==null||b.update()}return ie(()=>{o.modelValue&&(w.value=i.value),G(f)}),B(()=>o.modelValue,u=>{u!==i.value&&(u?i.fromString(u):i.clear())}),B(()=>i.value,u=>{l(W,u),w.value=u}),Me(He,{currentColor:P(()=>i.value)}),t({color:i,inputRef:p,update:f}),(u,_)=>(S(),L("div",{class:k([r(n).b(),r(n).is("disabled",r(a)),r(n).is("border",u.border)])},[v("div",{class:k(r(n).e("wrapper"))},[m(jt,{ref_key:"hueRef",ref:s,class:"hue-slider",color:r(i),vertical:"",disabled:r(a)},null,8,["color","disabled"]),m(xt,{ref_key:"svRef",ref:d,color:r(i),disabled:r(a)},null,8,["color","disabled"])],2),u.showAlpha?(S(),D(Wt,{key:0,ref_key:"alphaRef",ref:h,color:r(i),disabled:r(a)},null,8,["color","disabled"])):R("v-if",!0),u.predefine?(S(),D(Jt,{key:1,ref:"predefine","enable-alpha":u.showAlpha,color:r(i),colors:u.predefine,disabled:r(a)},null,8,["enable-alpha","color","colors","disabled"])):R("v-if",!0),v("div",{class:k(r(n).e("footer"))},[m(r(Ae),{ref_key:"inputRef",ref:p,modelValue:w.value,"onUpdate:modelValue":b=>w.value=b,"validate-event":!1,size:"small",disabled:r(a),onChange:g},null,8,["modelValue","onUpdate:modelValue","disabled"]),pt(u.$slots,"footer")],2)],2))}});var oo=U(to,[["__file","color-picker-panel.vue"]]);const ao=De(oo),lo=ve({persistent:{type:Boolean,default:!0},modelValue:{type:Z(String),default:void 0},id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:gt,popperClass:oe.popperClass,popperStyle:oe.popperStyle,tabindex:{type:[String,Number],default:0},teleported:oe.teleported,appendTo:oe.appendTo,predefine:{type:Z(Array)},validateEvent:{type:Boolean,default:!0},...vt,...mt(["ariaLabel"])}),so={[W]:e=>ae(e)||le(e),[me]:e=>ae(e)||le(e),activeChange:e=>ae(e)||le(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},no=F({name:"ElColorPicker"}),ro=F({...no,props:lo,emits:so,setup(e,{expose:t,emit:l}){const o=e,{t:n}=Te(),a=q("color"),{formItem:s}=_t(),d=bt(),h=Be(),{valueOnClear:p,isEmptyValue:w}=wt(o,null),i=Ne(o,l),{inputId:g,isLabeledByFormItem:f}=Ct(o,{formItemContext:s}),u=E(),_=E(),b=E(),M=E(!1),y=E(!1);let C=!0;const{isFocused:X,handleFocus:Xe,handleBlur:Ye}=yt(_,{disabled:h,beforeBlur(c){var V;return(V=u.value)==null?void 0:V.isFocusInsideContent(c)},afterBlur(){var c;Y(!1),N(),o.validateEvent&&((c=s?.validate)==null||c.call(s,"blur").catch(V=>he()))}}),A=kt(()=>{var c,V;return(V=(c=b.value)==null?void 0:c.color)!=null?V:i.color}),Ge=P(()=>St(o,Object.keys(Oe))),Je=P(()=>!o.modelValue&&!y.value?"transparent":tt(A,o.showAlpha)),Ze=P(()=>!o.modelValue&&!y.value?"":A.value),Qe=P(()=>f.value?void 0:o.ariaLabel||n("el.colorpicker.defaultLabel")),xe=P(()=>f.value?s?.labelId:void 0),et=P(()=>[a.b("picker"),a.is("disabled",h.value),a.bm("picker",d.value),a.is("focused",X.value)]);function tt(c,V){const{r:z,g:de,b:ye,a:it}=c.toRgb();return V?`rgba(${z}, ${de}, ${ye}, ${it})`:`rgb(${z}, ${de}, ${ye})`}function Y(c){M.value=c}const ee=Bt(Y,100,{leading:!0});function _e(){h.value||Y(!0)}function be(){ee(!1),N()}function N(){G(()=>{o.modelValue?A.fromString(o.modelValue):(A.value="",G(()=>{y.value=!1}))})}function ot(){h.value||(M.value&&N(),ee(!M.value))}function at(){const c=w(A.value)?p.value:A.value;l(W,c),l(me,c),o.validateEvent&&s?.validate("change").catch(V=>he()),ee(!1),G(()=>{const V=new re({enableAlpha:o.showAlpha,format:o.colorFormat||"",value:o.modelValue});A.compare(V)||N()})}function lt(){ee(!1),l(W,p.value),l(me,p.value),o.modelValue!==p.value&&o.validateEvent&&s?.validate("change").catch(c=>he()),N()}function st(){M.value&&(be(),X.value&&Ce())}function we(c){c.preventDefault(),c.stopPropagation(),Y(!1),N()}function nt(c){var V,z;switch(Ie(c)){case O.enter:case O.numpadEnter:case O.space:c.preventDefault(),c.stopPropagation(),_e(),(z=(V=b?.value)==null?void 0:V.inputRef)==null||z.focus();break;case O.esc:we(c);break}}function Ce(){_.value.focus()}function rt(){_.value.blur()}return B(()=>Ze.value,c=>{C&&l("activeChange",c),C=!0}),B(()=>A.value,()=>{!o.modelValue&&!y.value&&(y.value=!0)}),B(()=>o.modelValue,c=>{c?c&&c!==A.value&&(C=!1,A.fromString(c)):y.value=!1}),B(()=>M.value,()=>{var c;G((c=b.value)==null?void 0:c.update)}),Me(Ke,i),t({color:A,show:_e,hide:be,focus:Ce,blur:rt}),(c,V)=>(S(),D(r(Tt),{ref_key:"popper",ref:u,visible:M.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[r(a).be("picker","panel"),c.popperClass],"popper-style":c.popperStyle,"stop-popper-mouse-event":!1,pure:"",effect:"light",trigger:"click",teleported:c.teleported,transition:`${r(a).namespace.value}-zoom-in-top`,persistent:c.persistent,"append-to":c.appendTo,onHide:z=>Y(!1)},{content:$(()=>[se((S(),D(r(ao),Ee({ref_key:"pickerPanelRef",ref:b},r(Ge),{border:!1,onKeydown:Pt(we,["esc"])}),{footer:$(()=>[v("div",null,[m(r(Q),{class:k(r(a).be("footer","link-btn")),text:"",size:"small",onClick:lt},{default:$(()=>[I(T(r(n)("el.colorpicker.clear")),1)]),_:1},8,["class"]),m(r(Q),{plain:"",size:"small",class:k(r(a).be("footer","btn")),onClick:at},{default:$(()=>[I(T(r(n)("el.colorpicker.confirm")),1)]),_:1},8,["class"])])]),_:1},16,["onKeydown"])),[[r(Vt),st,_.value]])]),default:$(()=>[v("div",Ee({id:r(g),ref_key:"triggerRef",ref:_},c.$attrs,{class:r(et),role:"button","aria-label":r(Qe),"aria-labelledby":r(xe),"aria-description":r(n)("el.colorpicker.description",{color:c.modelValue||""}),"aria-disabled":r(h),tabindex:r(h)?void 0:c.tabindex,onKeydown:nt,onFocus:r(Xe),onBlur:r(Ye)}),[v("div",{class:k(r(a).be("picker","trigger")),onClick:ot},[v("span",{class:k([r(a).be("picker","color"),r(a).is("alpha",c.showAlpha)])},[v("span",{class:k(r(a).be("picker","color-inner")),style:K({backgroundColor:r(Je)})},[se(m(r(Pe),{class:k([r(a).be("picker","icon"),r(a).is("icon-arrow-down")])},{default:$(()=>[m(r($t))]),_:1},8,["class"]),[[Ve,c.modelValue||y.value]]),se(m(r(Pe),{class:k([r(a).be("picker","empty"),r(a).is("icon-close")])},{default:$(()=>[m(r(Et))]),_:1},8,["class"]),[[Ve,!c.modelValue&&!y.value]])],6)],2)],2)],16,["id","aria-label","aria-labelledby","aria-description","aria-disabled","tabindex","onFocus","onBlur"])]),_:1},8,["visible","popper-class","popper-style","teleported","transition","persistent","append-to","onHide"]))}});var io=U(ro,[["__file","color-picker.vue"]]);const uo=De(io),co={install(e){fe._context=e._context,ne._context=e._context,e.directive("loading",ne),e.config.globalProperties.$loading=fe},directive:ne,service:fe},ho={name:"restartBotButton",data(){const{t:e}=ce();return{t:e,pollingTimeout:6e4,pollingInterval:2e3,hasShownTimeoutError:!1}},methods:{async handleRestart(){try{await Fe.confirm(this.t("confirm.message"),this.t("confirm.warning"),{confirmButtonText:this.t("button.confirm"),cancelButtonText:this.t("button.cancel"),type:"warning"}),await this.restartBot()}catch{return}},async restartBot(){try{if((await J.post("/api/restart",{})).status===202){co.service({fullscreen:!0,text:this.t("setting.restart_bot.loading.text")});const t=Date.now(),l=async()=>{try{if((await J.get("/api")).status===200)window.location.href="/";else throw new Error("Not ready")}catch{Date.now()-t>=this.pollingTimeout&&!this.hasShownTimeoutError&&(this.hasShownTimeoutError=!0,H({message:this.t("setting.restart_bot.message.failed"),type:"error",duration:0})),setTimeout(l,this.pollingInterval)}};this.hasShownTimeoutError=!1,setTimeout(l,this.pollingInterval)}}catch(e){H.error(this.t("message.error.fetch")+e.message)}}}};function fo(e,t,l,o,n,a){const s=Q;return S(),L("div",null,[v("h3",null,[t[0]||(t[0]=v("i",{class:"mdi mdi-restart"},null,-1)),I(" "+T(e.$t("setting.restart_bot.title")),1)]),m(s,{type:"danger",onClick:a.handleRestart},{default:$(()=>[I(T(e.$t("setting.restart_bot.button.restart")),1)]),_:1},8,["onClick"])])}const ze=j(ho,[["render",fo]]),po={name:"SwitchDevelopMode",data(){return{value1:!1,loading:!1,showDevelopMode:localStorage.getItem("showDevelopMode")==="true"&&!Re}},mounted(){this.value1=!!localStorage.getItem("isDevelopMode")},methods:{handleSwitchChange(e){this.loading=!0,setTimeout(()=>{e?localStorage.setItem("isDevelopMode","true"):localStorage.removeItem("isDevelopMode"),this.loading=!1,location.reload()},300)}}},mo={key:0},vo={class:"develop-mode-label"};function go(e,t,l,o,n,a){const s=Lt;return n.showDevelopMode?(S(),L("div",mo,[v("h3",null,[t[1]||(t[1]=v("i",{class:"mdi mdi-wrench-cog"},null,-1)),I(" "+T(e.$t("setting.develop_mode.title")),1)]),v("span",vo,T(e.$t("setting.develop_mode.label")),1),m(s,{modelValue:n.value1,"onUpdate:modelValue":t[0]||(t[0]=d=>n.value1=d),loading:n.loading,onChange:a.handleSwitchChange},null,8,["modelValue","loading","onChange"])])):R("",!0)}const We=j(po,[["render",go],["__scopeId","data-v-81611abe"]]),_o={name:"ThemeSelector",data(){const{t:e}=ce();return{presets:{akari:"#edaab3",teahouse:"#0091ff"},customColor:"",showColorPicker:localStorage.getItem("isCustomTheme")==="true",t:e}},methods:{applyPreset(e){const t=this.presets[e];localStorage.setItem("isCustomTheme","false"),localStorage.setItem("themeColor",t),this.showColorPicker=!1,window.dispatchEvent(new Event("theme-change"))},applyCustomColor(e){e?(localStorage.setItem("isCustomTheme","true"),localStorage.setItem("themeColor",e)):(localStorage.removeItem("isCustomTheme","false"),localStorage.removeItem("themeColor","#edaab3")),window.dispatchEvent(new Event("theme-change"))},onCustomButtonClick(){this.applyCustomColor(this.customColor),this.showColorPicker=!0},customButtonStyle(){if(localStorage.getItem("isCustomTheme")==="true"){const t=localStorage.getItem("themeColor");this.customColor=t}return this.customColor?{backgroundColor:this.customColor,borderColor:this.customColor,color:"white"}:{}}}},bo={class:"preset-buttons"},wo={class:"custom-theme"};function Co(e,t,l,o,n,a){const s=Q,d=uo;return S(),L("div",null,[v("h3",null,[t[3]||(t[3]=v("i",{class:"mdi mdi-palette"},null,-1)),I(" "+T(e.$t("setting.theme_setting.title")),1)]),v("div",bo,[m(s,{onClick:t[0]||(t[0]=h=>a.applyPreset("akari")),class:"theme-button akari"},{default:$(()=>[I(T(e.$t("setting.theme_setting.button.pink")),1)]),_:1}),m(s,{onClick:t[1]||(t[1]=h=>a.applyPreset("teahouse")),class:"theme-button teahouse"},{default:$(()=>[I(T(e.$t("setting.theme_setting.button.blue")),1)]),_:1}),v("div",wo,[m(s,{onClick:a.onCustomButtonClick,class:"theme-button custom",style:K(a.customButtonStyle())},{default:$(()=>[I(T(e.$t("setting.theme_setting.button.custom")),1)]),_:1},8,["onClick","style"]),n.showColorPicker?(S(),D(d,{key:0,modelValue:n.customColor,"onUpdate:modelValue":t[2]||(t[2]=h=>n.customColor=h),onChange:a.applyCustomColor,clearable:!0},null,8,["modelValue","onChange"])):R("",!0)])])])}const qe=j(_o,[["render",Co],["__scopeId","data-v-9d617304"]]),yo={name:"LanguageSelector",data(){const{t:e}=ce();return{currentLang:localStorage.getItem("language")||"zh_cn",t:e}},inject:["elementLocale"],methods:{changeLanguage(e){this.currentLang=e,this.$i18n.locale=e,localStorage.setItem("language",e),this.elementLocale.lang=It[e]}}};function ko(e,t,l,o,n,a){const s=Mt,d=At;return S(),L("div",null,[v("h3",null,[t[1]||(t[1]=v("i",{class:"mdi mdi-translate"},null,-1)),I(" "+T(e.$t("setting.select_language.title")),1)]),m(d,{modelValue:n.currentLang,"onUpdate:modelValue":t[0]||(t[0]=h=>n.currentLang=h),onChange:a.changeLanguage,class:"lang-select",style:{width:"100px","margin-right":"10px"}},{default:$(()=>[m(s,{label:"简体中文",value:"zh_cn"}),m(s,{label:"繁體中文",value:"zh_tw"}),m(s,{label:"English",value:"en_us"}),m(s,{label:"日本語",value:"ja_jp"})]),_:1},8,["modelValue","onChange"])])}const Ue=j(yo,[["render",ko],["__scopeId","data-v-4187ee23"]]),So={name:"ChangePasswordForm",data(){const{t:e}=ce();return{loading:!0,form:{old_password:"",new_password:"",confirm_password:""},noPassword:!1,rules:{old_password:[{required:!0,message:this.$t("setting.change_password.validate.old_password"),trigger:"blur"}],new_password:[{required:!0,message:this.$t("setting.change_password.validate.new_password"),trigger:"blur"}],confirm_password:[{required:!0,message:this.$t("setting.change_password.validate.confirm_password"),trigger:"blur"},{validator:(t,l,o)=>{l!==this.form.new_password?o(new Error(this.$t("setting.change_password.validate.inconsistent"))):o()},trigger:"blur"}]},t:e}},async mounted(){const{data:e}=await J.get("/api/password");this.noPassword=!e.have_password,this.loading=!1},methods:{async handleUpdatePassword(){try{try{await this.$refs.formRef.validate()}catch{return}const e={new_password:this.form.new_password};this.noPassword||(e.password=this.form.old_password),(await J.put("/api/password",e)).status===205&&location.reload()}catch(e){e.response?.status===401?H.error(this.$t("setting.change_password.message.failed")):e.response?.status===403&&Re||H.error(this.$t("message.error.fetch")+e.message)}},async handleClearPassword(){try{await this.$refs.formRef.validateField("old_password"),Fe.confirm(this.$t("setting.change_password.confirm.message"),this.$t("confirm.warning"),{confirmButtonText:this.$t("button.confirm"),cancelButtonText:this.$t("button.cancel"),type:"warning"}).then(async()=>{await this.confirmClearPassword()}).catch(()=>{})}catch{return}},async confirmClearPassword(){try{(await J.delete("/api/password",{data:{password:this.form.old_password}})).status===205&&(H.success(this.$t("setting.change_password.message.success.clear")),localStorage.removeItem("noPasswordPromptDisabled"),location.reload())}catch(e){e.response?.status===401?H.error(this.$t("setting.change_password.message.failed")):H.error(this.$t("message.error.fetch")+e.message)}}}},$o={class:"password-buttons"};function Eo(e,t,l,o,n,a){const s=Ae,d=Dt,h=Q,p=Rt,w=ne;return se((S(),L("div",null,[v("h3",null,[t[4]||(t[4]=v("i",{class:"mdi mdi-lock"},null,-1)),I(" "+T(e.$t("setting.change_password.title")),1)]),m(p,{model:n.form,rules:n.rules,ref:"formRef","label-width":"auto"},{default:$(()=>[n.noPassword?R("",!0):(S(),D(d,{key:0,label:e.$t("setting.change_password.input.old_password"),prop:"old_password"},{default:$(()=>[m(s,{modelValue:n.form.old_password,"onUpdate:modelValue":t[0]||(t[0]=i=>n.form.old_password=i),type:"password"},null,8,["modelValue"])]),_:1},8,["label"])),n.noPassword?R("",!0):(S(),D(d,{key:1,label:e.$t("setting.change_password.input.new_password"),prop:"new_password"},{default:$(()=>[m(s,{modelValue:n.form.new_password,"onUpdate:modelValue":t[1]||(t[1]=i=>n.form.new_password=i),type:"password"},null,8,["modelValue"])]),_:1},8,["label"])),n.noPassword?(S(),D(d,{key:2,label:e.$t("setting.change_password.input.set_password"),prop:"new_password"},{default:$(()=>[m(s,{modelValue:n.form.new_password,"onUpdate:modelValue":t[2]||(t[2]=i=>n.form.new_password=i),type:"password"},null,8,["modelValue"])]),_:1},8,["label"])):R("",!0),m(d,{label:e.$t("setting.change_password.input.confirm_password"),prop:"confirm_password"},{default:$(()=>[m(s,{modelValue:n.form.confirm_password,"onUpdate:modelValue":t[3]||(t[3]=i=>n.form.confirm_password=i),type:"password"},null,8,["modelValue"])]),_:1},8,["label"]),n.noPassword?(S(),D(d,{key:3},{default:$(()=>[m(h,{type:"primary",onClick:a.handleUpdatePassword},{default:$(()=>[I(T(e.$t("setting.change_password.button.set_password")),1)]),_:1},8,["onClick"])]),_:1})):R("",!0),n.noPassword?R("",!0):(S(),D(d,{key:4},{default:$(()=>[v("div",$o,[m(h,{type:"primary",onClick:a.handleUpdatePassword},{default:$(()=>[I(T(e.$t("setting.change_password.button.update_password")),1)]),_:1},8,["onClick"]),m(h,{type:"danger",onClick:a.handleClearPassword},{default:$(()=>[I(T(e.$t("setting.change_password.button.clear_password")),1)]),_:1},8,["onClick"])])]),_:1}))]),_:1},8,["model","rules"])])),[[w,n.loading]])}const je=j(So,[["render",Eo],["__scopeId","data-v-b6cbeb7c"]]),Po={name:"SettingPage",components:{ChangePassword:je,SelectLanguage:Ue,RestartBot:ze,SwitchDevelopMode:We,ThemeSetting:qe}};function Vo(e,t,l,o,n,a){const s=je,d=Ue,h=qe,p=We,w=ze;return S(),L("div",null,[m(s),m(d),m(h),m(p),m(w)])}const Oo=j(Po,[["render",Vo]]);export{Oo as default};
