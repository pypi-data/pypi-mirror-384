<!--
Sync Impact Report:
Version change: 1.0.0 → 1.0.1
Modified principles: Updated test count from 2934 to 705 (current accurate count)
Added sections: None
Removed sections: None
Templates requiring updates: ✅ All templates remain aligned with constitution
Follow-up TODOs: None - all placeholders resolved
-->

# Tree-sitter Analyzer Constitution

## Core Principles

### I. AI-First Architecture
すべての機能はAI統合を前提として設計される。MCPプロトコルサポートは必須であり、自然言語インターフェースを通じて複雑な解析タスクを実行可能でなければならない。トークン制限を考慮した効率的なデータ処理と段階的出力制御を提供する。

**根拠**: AI時代のコード解析ツールとして、Claude Desktop、Cursor、Roo Codeなどとのネイティブ統合が競争優位性の源泉である。

### II. 多言語統一アーキテクチャ
Tree-sitterベースの統一要素システムにより、Java、JavaScript、TypeScript、Python、Markdownを一貫したインターフェースで処理する。新しい言語サポートはプラグインアーキテクチャを通じて追加され、既存機能との互換性を保持する。

**根拠**: 企業環境では複数言語が混在するため、統一されたアプローチが開発効率と保守性を向上させる。

### III. 高性能検索・解析 (NON-NEGOTIABLE)
fd（ファイル検索）とripgrep（コンテンツ検索）を活用した2段階検索により、大規模プロジェクトでも高速な解析を実現する。プロジェクト境界保護とセキュリティ制約を自動適用し、安全な操作を保証する。

**根拠**: エンタープライズグレードのパフォーマンスは非交渉事項であり、大規模コードベースでの実用性を決定する。

### IV. 段階的解析戦略
コード規模評価（check_code_scale）による事前評価を必須とし、ファイルサイズに応じて最適な解析戦略を選択する。小規模ファイルは直接読み取り、大規模ファイルは構造解析とトークン最適化を適用する。

**根拠**: AIアシスタントのトークン制限内で効率的に動作するため、適応的なアプローチが必要である。

### V. 品質保証・テスト駆動
705個のテストによる包括的品質保証を維持し、すべての新機能はテストファーストで開発される。エンタープライズグレードの安定性を保証し、後方互換性を厳格に管理する。

**根拠**: 企業環境での信頼性確保と継続的な品質向上のため、妥協のないテスト戦略が必要である。

## 技術制約

### サポート言語
- **完全サポート**: `.java`, `.js`, `.mjs`, `.jsx`, `.ts`, `.tsx`, `.py`, `.md`
- **制限事項**: 上記以外の拡張子は構造解析機能が制限される
- **拡張方針**: 新言語追加時はプラグインアーキテクチャを使用し、既存機能への影響を最小化する

### パフォーマンス要件
- **検索性能**: fd/ripgrepによる高速ファイル・コンテンツ検索
- **メモリ効率**: 大規模ファイルの段階的処理とトークン最適化
- **スケーラビリティ**: プロジェクトサイズに関係なく一貫したレスポンス時間

### セキュリティ境界
- **プロジェクト境界**: 自動的なプロジェクトルート検出と境界保護
- **ファイルアクセス**: 設定されたプロジェクト範囲内でのみ動作
- **権限管理**: 最小権限の原則に基づくファイルアクセス制御

## 開発ワークフロー

### GitFlow準拠
- **ブランチ戦略**: GitFlowに基づく厳格なブランチ管理
- **リリース管理**: セマンティックバージョニング（MAJOR.MINOR.PATCH）
- **品質ゲート**: すべてのPRで自動テスト実行と品質チェック

### MCP統合開発
- **プロトコル準拠**: Model Context Protocolの仕様に厳密に従う
- **ツール設計**: 各MCPツールは単一責任の原則に従い、明確な入力/出力仕様を持つ
- **エラーハンドリング**: 構造化されたエラーレスポンスと適切なフォールバック

### 後方互換性
- **API安定性**: パブリックAPIの破壊的変更は必ずメジャーバージョンアップ
- **移行サポート**: 非推奨機能は最低2バージョン間の移行期間を提供
- **ドキュメント**: 変更点と移行ガイドの包括的な文書化

## Governance

この憲法はすべての開発実践に優先し、プロジェクトの技術的方向性を決定する最高規範である。修正には文書化された提案、承認プロセス、移行計画が必要である。

すべてのPR・レビューは憲法準拠を検証し、複雑性の導入には十分な正当化が必要である。日常的な開発ガイダンスについては`.roo/rules/rules.md`を参照する。

**Version**: 1.0.1 | **Ratified**: 2025-10-12 | **Last Amended**: 2025-10-12