import{l as k,j as N,B,C as A,r,c as _,o as y,w as x,d as L,a as c,g as M,b as T,n as e,A as q}from"./index-B5gNOk1p.js";import{u as F,T as U,P as z}from"./useProjects-DaVtx0RW.js";import"./datasources-B0x4KOZU.js";import"./loading-yltfngwl.js";const I={class:"text-h6 my-4 d-flex align-center"},H={__name:"ListView",setup(R){const{isLoading:m,page:v,pages:g,filters:p,alert:o,modal:f,openCreateModal:O,fetchProjectChildren:P,createProject:C}=F(),j=k(),u=N([]),V=B(()=>!m.value&&u.value.length===0);async function l(i,t=p){try{const n=Object.assign({page:i},t.value),s=await q.project.list(j.query.ecosystem,n);s.data.results&&(u.value=s.data.results.map(d=>Object.assign(d,{type:"project"})),g.value=s.data.total_pages,v.value=s.data.page,o.value.isOpen=!1)}catch(n){Object.assign(o.value,{isOpen:!0,text:n.toString()})}}function b(i){p.value=i,l(1,p)}return A(()=>j.query.ecosystem,async()=>await l(),{immediate:!0}),(i,t)=>{const n=r("v-btn"),s=r("v-alert"),d=r("v-icon"),h=r("v-empty-state"),w=r("v-container");return y(),_(w,null,{default:x(()=>[L("h1",I,[t[4]||(t[4]=T(" Projects and repositories ",-1)),c(n,{class:"ml-auto",color:"secondary","prepend-icon":"mdi-plus",text:"Add",variant:"flat",onClick:e(O)},null,8,["onClick"])]),c(U,{projects:u.value,page:e(v),pages:e(g),"fetch-children":e(P),"is-loading":e(m),"onPage:update":t[0]||(t[0]=a=>l(a)),"onFilters:update":t[1]||(t[1]=a=>b(a))},null,8,["projects","page","pages","fetch-children","is-loading"]),c(s,{modelValue:e(o).isOpen,"onUpdate:modelValue":t[2]||(t[2]=a=>e(o).isOpen=a),text:e(o).text,icon:e(o).icon,color:e(o).color,density:"compact",class:"mb-6"},null,8,["modelValue","text","icon","color"]),V.value?(y(),_(h,{key:0,title:"No projects or repositories found",icon:"mdi-magnify"},{media:x(()=>[c(d,{color:"canceled",size:"x-large"})]),_:1})):M("",!0),c(z,{"is-open":e(f).isOpen,"onUpdate:isOpen":t[3]||(t[3]=a=>e(f).isOpen=a),"create-project":e(C),"onProjects:update":l},null,8,["is-open","create-project"])]),_:1})}}};export{H as default};
