import{D as J,l as K,j as Q,B as C,E as W,k as X,r as a,c as V,o as k,w as n,d as g,a as o,g as Y,t as Z,n as t,b as u,m as M,A as w}from"./index-B5gNOk1p.js";import{u as h,C as ee}from"./ConfirmModal-DmJufS9P.js";import{u as te,T as oe,P as se}from"./useProjects-DaVtx0RW.js";import"./datasources-B0x4KOZU.js";import"./loading-yltfngwl.js";const ne={class:"mb-8 d-flex align-center"},re={class:"text-h5"},ae={class:"text-h6 mb-4 d-flex align-center"},me={__name:"DetailView",setup(le){const{isLoading:x,children:P,page:N,pages:A,modal:c,alert:i,openCreateModal:B,openEditModal:D,fetchChildren:_,setFilters:$,fetchProjectChildren:U,createProject:z,editProject:E}=te(),b=J(),v=K(),{modalProps:f,confirmDelete:F}=h(),m=Q({}),p=C(()=>v.query.project),R=C(()=>!x.value&&P.value.length===0);async function y(l){var e;try{const r=await w.project.get(v.query.ecosystem,l);r.status===200&&(m.value=r.data,_(l,1))}catch(r){((e=r.response)==null?void 0:e.status)===404&&b.push({name:"notFound"});const d=r.response.data.detail?r.response.data.detail:r.toString();Object.assign(i.value,{isOpen:!0,text:d})}}async function S(l){var e;try{await w.project.delete(v.query.ecosystem,l),b.replace({name:"ecosystems",query:{ecosystem:v.query.ecosystem}})}catch(r){const d=(e=r.response)!=null&&e.data.detail?r.response.data.detail:r.toString();Object.assign(i.value,{isOpen:!0,text:d})}}return W(async(l,e)=>{l.query.project&&l.query.project!==e.query.project&&y(l.query.project)}),X(async()=>{await y(p.value)}),(l,e)=>{const r=a("v-spacer"),d=a("v-btn"),j=a("v-icon"),O=a("v-list-item-title"),q=a("v-list-item"),T=a("v-list"),L=a("v-menu"),I=a("v-alert"),G=a("v-empty-state"),H=a("v-container");return k(),V(H,null,{default:n(()=>[g("div",ne,[g("h1",re,Z(m.value.title||m.value.name),1),o(r),o(d,{variant:"outlined",class:"mr-4 text-subtitle-2 border","prepend-icon":"mdi-pencil",onClick:e[0]||(e[0]=s=>t(D)(m.value))},{default:n(()=>e[10]||(e[10]=[u(" Edit ",-1)])),_:1,__:[10]}),o(d,{variant:"outlined",class:"text-subtitle-2 border","prepend-icon":"mdi-delete",onClick:e[1]||(e[1]=s=>t(F)(S,p.value))},{default:n(()=>e[11]||(e[11]=[u(" Delete ",-1)])),_:1,__:[11]})]),g("h2",ae,[e[16]||(e[16]=u(" Projects and repositories ",-1)),o(L,null,{activator:n(({props:s})=>[o(d,M(s,{class:"ml-auto",color:"secondary","prepend-icon":"mdi-plus",text:"Add",variant:"flat"}),null,16)]),default:n(()=>[o(T,{density:"compact",color:"primary",nav:""},{default:n(()=>[o(q,{onClick:e[2]||(e[2]=s=>t(B)(m.value))},{prepend:n(()=>[o(j,{size:"small"},{default:n(()=>e[12]||(e[12]=[u("mdi-folder-plus-outline",-1)])),_:1,__:[12]})]),default:n(()=>[o(O,null,{default:n(()=>e[13]||(e[13]=[u("Add project",-1)])),_:1,__:[13]})]),_:1}),o(q,{exact:!0,to:{name:"ecosystems",query:{ecosystem:t(v).query.ecosystem,project:p.value,create:"repo"}}},{prepend:n(()=>[o(j,{size:"small"},{default:n(()=>e[14]||(e[14]=[u("mdi-source-branch-plus",-1)])),_:1,__:[14]})]),default:n(()=>[o(O,null,{default:n(()=>e[15]||(e[15]=[u("Add repository",-1)])),_:1,__:[15]})]),_:1},8,["to"])]),_:1})]),_:1})]),o(oe,{projects:t(P),"is-loading":t(x),page:t(N),pages:t(A),"fetch-children":t(U),"onPage:update":e[3]||(e[3]=s=>t(_)(p.value,s)),"onFilters:update":e[4]||(e[4]=s=>t($)(p.value,s))},null,8,["projects","is-loading","page","pages","fetch-children"]),o(I,{modelValue:t(i).isOpen,"onUpdate:modelValue":e[5]||(e[5]=s=>t(i).isOpen=s),text:t(i).text,icon:t(i).icon,color:t(i).color,density:"compact",class:"mb-6"},null,8,["modelValue","text","icon","color"]),R.value?(k(),V(G,{key:0,title:"No projects or repositories found",icon:"mdi-magnify"},{media:n(()=>[o(j,{color:"canceled",size:"x-large"})]),_:1})):Y("",!0),o(se,{"is-open":t(c).isOpen,"onUpdate:isOpen":e[6]||(e[6]=s=>t(c).isOpen=s),edit:t(c).edit,name:t(c).name,title:t(c).title,"create-project":t(z),"edit-project":t(E),parent:t(c).parentProject,id:m.value.id,"onProject:update":e[7]||(e[7]=s=>y(p.value)),"onProjects:update":e[8]||(e[8]=s=>t(_)(p.value))},null,8,["is-open","edit","name","title","create-project","edit-project","parent","id"]),o(ee,M({"is-open":t(f).isOpen,"onUpdate:isOpen":e[9]||(e[9]=s=>t(f).isOpen=s)},t(f)),null,16,["is-open"])]),_:1})}}};export{me as default};
