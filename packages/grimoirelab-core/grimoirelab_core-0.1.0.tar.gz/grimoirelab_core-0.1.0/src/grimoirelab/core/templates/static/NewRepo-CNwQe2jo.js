import{_,r as a,c as f,o as v,w as r,a as o,d as y,q as S,H as h,I as w,m as b,b as C,t as I,A as U}from"./index-B5gNOk1p.js";import{I as B}from"./IntervalSelector-DRcs0Vny.js";const N={name:"FormDialog",components:{IntervalSelector:B},emits:["create"],data(){return{isOpen:!1,formData:{uri:"",datasource_type:"git",category:"commit",scheduler:{job_interval:"604800",job_max_retries:1}},customInterval:""}},methods:{onSave(){this.$emit("create",this.formData),this.isOpen=!1}}};function O(s,e,l,g,t,d){const i=a("v-btn"),p=a("v-select"),u=a("v-col"),m=a("v-row"),c=a("v-text-field"),V=a("interval-selector"),x=a("v-card-text"),D=a("v-spacer"),j=a("v-card-actions"),k=a("v-card"),q=a("v-dialog");return v(),f(q,{modelValue:t.isOpen,"onUpdate:modelValue":e[5]||(e[5]=n=>t.isOpen=n),"max-width":"600"},{activator:r(({props:n})=>[S(s.$slots,"activator",h(w({props:n})),()=>[o(i,b({class:"ml-auto",color:"secondary","prepend-icon":"mdi-plus",text:"Add",variant:"flat"},n),null,16)])]),default:r(()=>[o(k,{title:"Add repository"},{default:r(()=>[o(x,{class:"mt-4"},{default:r(()=>[o(m,{dense:""},{default:r(()=>[o(u,{cols:"6"},{default:r(()=>[o(p,{modelValue:t.formData.datasource_type,"onUpdate:modelValue":e[0]||(e[0]=n=>t.formData.datasource_type=n),items:["git"],color:"primary",label:"Backend","hide-details":"",required:""},null,8,["modelValue"])]),_:1}),o(u,{cols:"6"},{default:r(()=>[o(p,{modelValue:t.formData.category,"onUpdate:modelValue":e[1]||(e[1]=n=>t.formData.category=n),items:["commit"],color:"primary",label:"Category","hide-details":"",required:""},null,8,["modelValue"])]),_:1})]),_:1}),o(m,null,{default:r(()=>[o(u,{cols:"12"},{default:r(()=>[o(c,{modelValue:t.formData.uri,"onUpdate:modelValue":e[2]||(e[2]=n=>t.formData.uri=n),color:"primary",label:"URI","hide-details":"",required:""},null,8,["modelValue"])]),_:1})]),_:1}),o(m,null,{default:r(()=>[o(u,null,{default:r(()=>[e[6]||(e[6]=y("p",{class:"text-subtitle-2 mb-4"},"Schedule",-1)),o(V,{modelValue:t.formData.scheduler.job_interval,"onUpdate:modelValue":e[3]||(e[3]=n=>t.formData.scheduler.job_interval=n),density:"comfortable"},null,8,["modelValue"])]),_:1,__:[6]})]),_:1})]),_:1}),o(j,{class:"pt-0 pb-4 pr-4"},{default:r(()=>[o(D),o(i,{text:"Cancel",variant:"plain",onClick:e[4]||(e[4]=n=>t.isOpen=!1)}),o(i,{color:"primary",text:"Save",variant:"flat",onClick:d.onSave},null,8,["onClick"])]),_:1})]),_:1})]),_:3},8,["modelValue"])}const R=_(N,[["render",O]]),A={name:"NewRepo",components:{FormDialog:R},computed:{ecosystem(){var s;return(s=this.$route.query)==null?void 0:s.ecosystem},project(){var s;return(s=this.$route.query)==null?void 0:s.project}},data(){return{snackbar:{open:!1,color:"success",text:""}}},methods:{async createRepository(s){var e;try{const l=await U.repository.create(this.ecosystem,this.project,s);l.status===201&&this.$router.push({name:"ecosystems",query:{ecosystem:this.ecosystem,project:this.project,repo:l.data.uuid}})}catch(l){Object.assign(this.snackbar,{open:!0,color:"error",text:((e=l.response)==null?void 0:e.data)||l})}}}};function P(s,e,l,g,t,d){const i=a("v-card"),p=a("form-dialog"),u=a("v-snackbar"),m=a("v-container");return v(),f(m,null,{default:r(()=>[e[2]||(e[2]=y("h1",{class:"text-h6 my-4"},"New repository",-1)),o(p,{onCreate:e[0]||(e[0]=c=>d.createRepository(c))},{activator:r(({props:c})=>[o(i,b(c,{title:"Add a repository",subtitle:"Collect data from a single git repository","prepend-icon":"mdi-git",variant:"outlined"}),null,16)]),_:1}),o(i,{to:{name:"ecosystems",query:{ecosystem:s.$route.query.ecosystem,project:s.$route.query.project,create:"sbom"}},title:"Load SPDX SBoM file",subtitle:"Load repositories from an SBoM file in SPDX format","prepend-icon":"mdi-file-upload-outline",variant:"outlined"},null,8,["to"]),o(i,{to:{name:"ecosystems",query:{ecosystem:s.$route.query.ecosystem,project:s.$route.query.project,create:"github"}},title:"GitHub",subtitle:"Load repositories from a GitHub user or organization","prepend-icon":"mdi-github",variant:"outlined"},null,8,["to"]),o(u,{modelValue:t.snackbar.open,"onUpdate:modelValue":e[1]||(e[1]=c=>t.snackbar.open=c),color:t.snackbar.color},{default:r(()=>[C(I(t.snackbar.text),1)]),_:1},8,["modelValue","color"])]),_:1,__:[2]})}const $=_(A,[["render",P],["__scopeId","data-v-a6be73ff"]]);export{$ as default};
