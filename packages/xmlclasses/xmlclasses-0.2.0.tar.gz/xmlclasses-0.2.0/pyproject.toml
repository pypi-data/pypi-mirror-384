[project]
name = "xmlclasses"
version = "0.2.0"
description = "Simple, fast, lightweight xml parser and validator defined by classes."
readme = "README.md"
authors = [
    { name = "Michael Bach Kristensen", email = "tacoz666@gmail.com" }
]
requires-python = ">=3.11"
dependencies = []

[dependency-groups]
dev = [
    "ipython>=8.37.0",
    "pytest>=8.4.1",
    "rich>=14.0.0",
    "taskipy>=1.14.1",
    "tox>=4.27.0",
    "tox-uv>=1.26.1",
]

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[project.urls]
repository = "https://github.com/tacozMacleo/xmlClasses"
"Bug Tracker" = "https://github.com/tacozMacleo/xmlClasses/issues"
# homepage = "https://xmlClasses.org/"
# documentation = ""

################################### Ruff ###################################

[tool.ruff]
line-length = 120
lint.select = ["ALL"]
lint.ignore = [
    "SIM118",  # False positive when we work with xml.etree.ElementTree.
    "TC006",
    "TRY003",
    "D100", "D101", "D102", "D103", "D104", "D105", "D106", "D107",
    "D203", "D212",
    "I001"
]

[tool.ruff.per-file-ignores]
"test/*.py" = [
    "S101",
    "INP001",
]
"xml_elementTree_utils.py" = [
    "N999",
]

################################## PyTest ##################################
[tool.pytest.ini_options]
minversion = "8.0"
addopts = "-ra -q -vv"
testpaths = [
    "test",
]

log_level = "DEBUG"
log_file = "test.log"
log_file_level = "DEBUG"
log_file_format = "%(asctime)s.%(msecs)03d - %(levelname)s - %(name)s - %(message)s"
log_file_date_format = "%Y-%m-%dT%H:%M:%S"


################################### Tox ####################################
[tool.tox]
minversion = "3.4.0"
envlist = [
    "py311", "py312", 
    # "ruff", "mypy",
    "report",
]

[tool.tox.env_run_base]

deps = [
    "pytest",
    "coverage",
]
commands = [
    ["coverage", "run"],
]

[tool.tox.env.ruff]
deps = "ruff"
commands = [
    ["ruff", "check"],
]

[tool.tox.env.mypy]
deps = "mypy"
commands = [
    ["mypy", "--strict", "--python-version", "3.10.18", "{toxinidir}/src/xmlclasses"],
]

[tool.tox.env.report]
commands = [
    # ["coverage", "combine"],
    ["coverage", "report", "-m"],
]

############################## coverage #############################

[tool.coverage.run]
branch = true
# parallel = true
source = [
    "xmlclasses",
    # "test",
]
command_line = "-m pytest"

[tool.coverage.paths]
source = [
    "src/xmlclasses",
    ".tox/*/lib/python*/site-packages/xmlclasses",
]

[tool.coverage.report]
skip_covered = false
show_missing = true
ignore_errors = true
# omit = [
#     ".tox/*",
# ]

################################## Taskipy #################################
[tool.taskipy.settings]
use_vars = true

[tool.taskipy.variables]
testbasic = "test/test_attribute_values.py test/test_elements.py test/test_text_field_values.py"

[tool.taskipy.tasks]
basicTest = {cmd = "pytest -v {testbasic}", help = "Run the basic tests for current development."}


############################## Bump My Version #############################
[tool.bumpversion]
current_version = "0.2.0"
tag = true
commit = true
message = "Bump version: {current_version} â†’ {new_version}"

[[tool.bumpversion.files]]
filename = "src/xmlclasses/__init__.py"
search = '__version__ = "v{current_version}"'
replace = '__version__ = "v{new_version}"'
