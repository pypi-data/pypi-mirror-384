when:
  - branch: [main]
    event: [pull_request, push]

steps:
  build:
    image: ghcr.io/astral-sh/uv:python3.12-alpine
    commands:
      - apk add curl
      - uv sync
      - ./resources/download_test_data.sh
  test_pytest:
    image: ghcr.io/astral-sh/uv:python3.12-alpine
    commands:
      - uv run pytest muck_out/transform muck_out/process muck_out/types muck_out/validators muck_out/test_*
