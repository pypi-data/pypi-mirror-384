"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[5675],{5675:(t,e,s)=>{s.d(e,{A:()=>Wt});var o=s(641),a=s(33);const r={class:"text-instructions"},i={key:0,class:"alert alert-info"},d={key:1,class:"alert alert-dark"},l={key:2,class:"group-card-list"},n={class:"group-card--details"},u={key:0,class:"group-card--remove"},c={key:0,class:"group-card"},p=[(0,o.Lk)("div",{class:"group-card--details"},"++ Adding New Group ++",-1)],m=(0,o.Lk)("div",{class:"spacer"},null,-1),g={class:"row submit-row"},h={class:"col-md-12"},b=(0,o.Lk)("hr",null,null,-1),L={class:"text-instructions"},k={key:3,class:"alert alert-info"},v={key:4,class:"alert alert-dark"},U={key:5,class:"user-card-list"},y=["src"],f={class:"user-card--details"},G={class:"user-card--name"},_={class:"user-card--email"},C={key:0,class:"user-card--remove"},w={key:0,class:"user-card"},A=[(0,o.Lk)("div",{class:"user-card--details"},"++ Adding User(s) ++",-1)],D=(0,o.Lk)("div",{class:"spacer"},null,-1),S={key:6,class:"row submit-row"},j={class:"col-md-12"};var $=s(2243),I=s(2321),E=s(9336);const x={class:"modal fade",id:"addGroupModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},F={class:"modal-dialog modal-lg"},M={class:"modal-content"},T={class:"modal-header"},X=(0,o.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"addGroupCloseButton"},[(0,o.Lk)("span",{"aria-hidden":"true"})],-1),B={class:"modal-body"},N={key:0,class:"row"},O={class:"col-md-4"},R=(0,o.Lk)("strong",null,"Add Groups",-1),Q={class:"text-instructions"},P={class:"text-instructions"},W={class:"col-md-8"},z={key:1,class:"row"},K=(0,o.Lk)("div",{class:"col-md-6"},[(0,o.Lk)("strong",null,"Sorry - no results"),(0,o.Lk)("p",{class:"text-instructions"}," This could be because "),(0,o.Lk)("ul",{class:"text-instructions"},[(0,o.Lk)("li",null,"There are no more groups left to add")])],-1),q={class:"col-md-6 no-search"},Y=["src"],H={class:"modal-footer"},J=(0,o.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),V=["disabled"];var Z=s(1080),tt=s(2124);const et={name:"AddGroupWizard",components:{Icon:I.In,NSelect:Z.A},computed:{...(0,tt.L8)({destination:"getDestination",locationId:"getLocationId",potentialGroupList:"getPotentialGroupList",rootUrl:"getRootUrl",staticUrl:"getStaticUrl"})},watch:{potentialGroupList(t){void 0!==t&&(this.groupFixList=t.map((t=>({value:t.group_id,label:t.group_name}))))}},mixins:[$.A],data:()=>({groupFixList:[],groupModel:[]}),methods:{addGroup(){this.$store.commit("updateAddingGroupStatus",{addingGroupStatus:!0});const t=new FormData;this.groupModel.forEach((e=>{t.append("group_list",e)})),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/add_group/`,t).then((t=>{this.$store.commit("updateGroupsAndUsers",{objectGroupList:t.data.object_group_list,objectUserList:t.data.object_user_list,potentialGroupList:t.data.potential_group_list,potentialUserList:t.data.potential_user_list}),this.$store.commit("updateAddingGroupStatus",{addingGroupStatus:!1}),this.groupModel=[],document.getElementById("addGroupCloseButton").click()})).catch((t=>{this.$store.dispatch("newToast",{header:`Error adding group to ${this.destination}`,message:`Sorry, we could not add the group to the ${this.destination}. Error -> ${t}`,extra_classes:"bd-danger",delay:0})}))}}};var st=s(6262);const ot=(0,st.A)(et,[["render",function(t,e,s,r,i,d){const l=(0,o.g2)("Icon"),n=(0,o.g2)("n-select");return(0,o.uX)(),(0,o.CE)("div",x,[(0,o.Lk)("div",F,[(0,o.Lk)("div",M,[(0,o.Lk)("div",T,[(0,o.Lk)("h2",null,[(0,o.bF)(l,{icon:t.icons.groupPresentation},null,8,["icon"]),(0,o.eW)(" Add Group Wizard ")]),X]),(0,o.Lk)("div",B,[i.groupFixList.length>0?((0,o.uX)(),(0,o.CE)("div",N,[(0,o.Lk)("div",O,[R,(0,o.Lk)("p",Q," Use the following multiple select to select which groups you want to add to this "+(0,a.toDisplayString)(t.destination)+". ",1),(0,o.Lk)("p",P," Please note: A user's group has to be added to the "+(0,a.toDisplayString)(t.destination)+" before the user can be added. ",1)]),(0,o.Lk)("div",W,[(0,o.bF)(n,{options:i.groupFixList,value:i.groupModel,"onUpdate:value":e[0]||(e[0]=t=>i.groupModel=t),multiple:""},null,8,["options","value"])])])):((0,o.uX)(),(0,o.CE)("div",z,[K,(0,o.Lk)("div",q,[(0,o.Lk)("img",{src:`${t.staticUrl}NearBeach/images/placeholder/questions.svg`,alt:"Sorry - there are no results"},null,8,Y)])]))]),(0,o.Lk)("div",H,[J,(0,o.Lk)("button",{type:"button",class:"btn btn-primary",disabled:0==i.groupModel.length,onClick:e[1]||(e[1]=(...t)=>d.addGroup&&d.addGroup(...t))}," Add Group(s) ",8,V)])])])])}]]),at={class:"modal fade",id:"addUserModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},rt={class:"modal-dialog modal-lg"},it={class:"modal-content"},dt={class:"modal-header"},lt=(0,o.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"addUserCloseButton"},[(0,o.Lk)("span",{"aria-hidden":"true"})],-1),nt={class:"modal-body"},ut={key:0,class:"row"},ct={class:"col-md-4"},pt=(0,o.Lk)("strong",null,"Add Users",-1),mt={class:"text-instructions"},gt={class:"text-instructions"},ht={class:"col-md-8"},bt={key:1,class:"row"},Lt={class:"col-md-6"},kt=(0,o.Lk)("strong",null,"Sorry - no results",-1),vt=(0,o.Lk)("p",{class:"text-instructions"}," This could be because ",-1),Ut={class:"text-instructions"},yt=(0,o.Lk)("li",null,"There are no more users left to add",-1),ft={class:"col-md-6 no-search"},Gt=["src"],_t={class:"modal-footer"},Ct=(0,o.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),wt=["disabled"],At={name:"AddUserWizard",components:{Icon:I.In,NSelect:Z.A},mixins:[$.A],computed:{...(0,tt.L8)({destination:"getDestination",locationId:"getLocationId",potentialUserList:"getPotentialUserList",rootUrl:"getRootUrl",staticURL:"getStaticUrl",userLevel:"getUserLevel"})},data:()=>({userFixList:[],userModel:[]}),watch:{potentialUserList(t){void 0!==t&&(this.userFixList=t.map((t=>({value:t.id,label:`${t.username}: ${t.first_name} ${t.last_name}`}))))}},methods:{addUser(){this.$store.commit("updateAddingUserStatus",{addingUserStatus:!0});const t=new FormData;this.userModel.forEach((e=>{t.append("user_list",e)})),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/add_user/`,t).then((t=>{document.getElementById("addUserCloseButton").click(),this.userModel=[],this.$store.commit("updateGroupsAndUsers",{objectGroupList:t.data.object_group_list,objectUserList:t.data.object_user_list,potentialGroupList:t.data.potential_group_list,potentialUserList:t.data.potential_user_list}),this.$store.commit("updateAddingUserStatus",{addingUserStatus:!1})})).catch((t=>{this.$store.dispatch("newToast",{header:"Failed to add user",message:`Failed to add user. Error -> ${t}`,extra_classes:"bg-danger",delay:0})}))}}},Dt=(0,st.A)(At,[["render",function(t,e,s,r,i,d){const l=(0,o.g2)("Icon"),n=(0,o.g2)("n-select");return(0,o.uX)(),(0,o.CE)("div",at,[(0,o.Lk)("div",rt,[(0,o.Lk)("div",it,[(0,o.Lk)("div",dt,[(0,o.Lk)("h2",null,[(0,o.bF)(l,{icon:t.icons.userIcon},null,8,["icon"]),(0,o.eW)(" Add User Wizard ")]),lt]),(0,o.Lk)("div",nt,[i.userFixList.length>0?((0,o.uX)(),(0,o.CE)("div",ut,[(0,o.Lk)("div",ct,[pt,(0,o.Lk)("p",mt," Use the following multiple select to select which users you want to add to this "+(0,a.toDisplayString)(t.destination)+". ",1),(0,o.Lk)("p",gt," Please note: A user's group has to be added to the "+(0,a.toDisplayString)(t.destination)+" before the user can be added. ",1)]),(0,o.Lk)("div",ht,[(0,o.bF)(n,{options:i.userFixList,value:i.userModel,"onUpdate:value":e[0]||(e[0]=t=>i.userModel=t),multiple:""},null,8,["options","value"])])])):((0,o.uX)(),(0,o.CE)("div",bt,[(0,o.Lk)("div",Lt,[kt,vt,(0,o.Lk)("ul",Ut,[yt,(0,o.Lk)("li",null," The user you are after is in a group not current added to this "+(0,a.toDisplayString)(t.destination),1)])]),(0,o.Lk)("div",ft,[(0,o.Lk)("img",{src:`${t.staticURL}NearBeach/images/placeholder/questions.svg`,alt:"Sorry - there are no results"},null,8,Gt)])]))]),(0,o.Lk)("div",_t,[Ct,(0,o.Lk)("button",{type:"button",class:"btn btn-primary",disabled:0===i.userModel.length,onClick:e[1]||(e[1]=(...t)=>d.addUser&&d.addUser(...t))}," Add User(s) ",8,wt)])])])])}]]),St={class:"modal fade",id:"confirmGroupDeleteModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"confirmGroupDelete","aria-hidden":"true"},jt={class:"modal-dialog"},$t={class:"modal-content"},It=(0,o.Lk)("div",{class:"modal-header"},[(0,o.Lk)("h5",{class:"modal-title",id:"confirmGroupDelete"}," Please confirm Group Deletion "),(0,o.Q3)(" TASK INFORMATION "),(0,o.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmGroupDeleteButton"})],-1),Et=(0,o.Lk)("div",{class:"modal-body"}," Are you sure you want to delete the Group from the object? ",-1),xt={class:"modal-footer"},Ft={name:"ConfirmGroupDelete",props:{groupId:{type:Number,default:0}},computed:{...(0,tt.L8)({destination:"getDestination",locationId:"getLocationId",objectGroupList:"getObjectGroupList",rootUrl:"getRootUrl"})},methods:{deleteGroup(){this.$store.commit("updateGroupsAndUsers",{objectGroupList:this.objectGroupList.filter((t=>t.group_id!==this.groupId))});const t=new FormData;t.set("group_id",`${this.groupId}`),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/remove_group/`,t).then((t=>{this.$store.commit("updateGroupsAndUsers",{objectGroupList:t.data.object_group_list,objectUserList:t.data.object_user_list,potentialGroupList:t.data.potential_group_list,potentialUserList:t.data.potential_user_list})})).catch((t=>{this.$store.dispatch("newToast",{header:"Error removing group from object",message:`We encounted an error moving the group from the object. Error -> ${t}`,extra_classes:"bg-danger",delay:0})})),this.closeModal()},closeModal(){document.getElementById("confirmGroupDeleteButton").click()}}},Mt=(0,st.A)(Ft,[["render",function(t,e,s,a,r,i){return(0,o.uX)(),(0,o.CE)("div",St,[(0,o.Lk)("div",jt,[(0,o.Lk)("div",$t,[It,Et,(0,o.Lk)("div",xt,[(0,o.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:e[0]||(e[0]=(...t)=>i.closeModal&&i.closeModal(...t))}," No "),(0,o.Lk)("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=(...t)=>i.deleteGroup&&i.deleteGroup(...t))}," Yes ")])])])])}]]),Tt={class:"modal fade",id:"confirmUserDeleteModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"confirmUserDelete","aria-hidden":"true"},Xt={class:"modal-dialog"},Bt={class:"modal-content"},Nt=(0,o.Lk)("div",{class:"modal-header"},[(0,o.Lk)("h5",{class:"modal-title",id:"confirmUserDelete"}," Please confirm User Deletion "),(0,o.Q3)(" TASK INFORMATION "),(0,o.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmUserDeleteButton"})],-1),Ot=(0,o.Lk)("div",{class:"modal-body"}," Are you sure you want to delete the User from the object? ",-1),Rt={class:"modal-footer"},Qt={name:"ConfirmUserDelete",props:{username:{type:String,default:""}},computed:{...(0,tt.L8)({destination:"getDestination",locationId:"getLocationId",objectUserList:"getObjectUserList",rootUrl:"getRootUrl"})},methods:{deleteUser(){this.$store.commit("updateGroupsAndUsers",{objectUserList:this.objectUserList.filter((t=>t.username!==this.username))});const t=new FormData;t.set("username",this.username),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/remove_user/`,t).then((t=>{this.$store.commit("updateGroupsAndUsers",{objectGroupList:t.data.object_group_list,objectUserList:t.data.object_user_list,potentialGroupList:t.data.potential_group_list,potentialUserList:t.data.potential_user_list})})).catch((t=>{this.$store.dispatch("newToast",{header:"Error removing user from object",message:`We encounted an error moving the user from the object. Error -> ${t}`,extra_classes:"bg-danger",delay:0})})),this.closeModal()},closeModal(){document.getElementById("confirmUserDeleteButton").click()}}},Pt={name:"GroupsAndUsersModule",components:{AddGroupWizard:ot,AddUserWizard:Dt,ConfirmGroupDelete:Mt,ConfirmUserDelete:(0,st.A)(Qt,[["render",function(t,e,s,a,r,i){return(0,o.uX)(),(0,o.CE)("div",Tt,[(0,o.Lk)("div",Xt,[(0,o.Lk)("div",Bt,[Nt,Ot,(0,o.Lk)("div",Rt,[(0,o.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:e[0]||(e[0]=(...t)=>i.closeModal&&i.closeModal(...t))}," No "),(0,o.Lk)("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=(...t)=>i.deleteUser&&i.deleteUser(...t))}," Yes ")])])])])}]]),Icon:I.In},props:{isReadOnly:{type:Boolean,default:!1}},data:()=>({deleteGroupId:0,deleteUsername:"",destinationTitle:"",loadingData:!0}),computed:{...(0,tt.L8)({addingGroupStatus:"getAddingGroupStatus",addingUserStatus:"getAddingUserStatus",destination:"getDestination",locationId:"getLocationId",objectGroupList:"getObjectGroupList",objectUserList:"getObjectUserList",rootUrl:"getRootUrl",staticUrl:"getStaticUrl",userLevel:"getUserLevel"})},mixins:[$.A],methods:{addNewGroup(){new E.aF(document.getElementById("addGroupModal")).show()},addNewUser(){new E.aF(document.getElementById("addUserModal")).show()},getGroupAndUserData(){this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/group_and_user_data/`).then((t=>{this.$store.commit("updateGroupsAndUsers",{objectGroupList:t.data.object_group_list,objectUserList:t.data.object_user_list,potentialGroupList:t.data.potential_group_list,potentialUserList:t.data.potential_user_list}),this.loadingData=!1})).catch((t=>{this.$store.dispatch("newToast",{header:"Error fetching group and user data",message:`Sorry we could not get any group or user data. Error -> ${t}`,extra_classes:"bd-danger",delay:0})}))},profilePicture(t){return null!==t&&""!==t?`${this.rootUrl}private/${t}/`:`${this.staticUrl}NearBeach/images/placeholder/people_tax.svg`},removeGroup(t){this.deleteGroupId=t,new E.aF(document.getElementById("confirmGroupDeleteModal")).show()},removeUser(t){this.deleteUsername=t,new E.aF(document.getElementById("confirmUserDeleteModal")).show()}},mounted(){this.$nextTick((()=>{if(0===this.locationId)return void setTimeout((()=>{this.getGroupAndUserData()}),500);this.getGroupAndUserData();let t=this.destination;t=t.replaceAll("_"," "),this.destinationTitle=t.replace(/\w\S*/g,(t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()))}))}},Wt=(0,st.A)(Pt,[["render",function(t,e,s,$,I,E){const x=(0,o.g2)("Icon"),F=(0,o.g2)("add-group-wizard"),M=(0,o.g2)("add-user-wizard"),T=(0,o.g2)("confirm-group-delete"),X=(0,o.g2)("confirm-user-delete");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Q3)(" GROUPS "),(0,o.Lk)("h2",null,[(0,o.bF)(x,{icon:t.icons.groupPresentation},null,8,["icon"]),(0,o.eW)(" Groups ")]),(0,o.Lk)("p",r," The following list are all the Groups connected to this "+(0,a.toDisplayString)(I.destinationTitle)+". Users will have to be included in these groups to be added to this "+(0,a.toDisplayString)(I.destinationTitle),1),I.loadingData?((0,o.uX)(),(0,o.CE)("div",i," Currently loading group data. ")):0!==t.objectGroupList.length||t.addingGroupStatus?((0,o.uX)(),(0,o.CE)("div",l,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.objectGroupList,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.group_id,class:"group-card"},[(0,o.Lk)("div",n,(0,a.toDisplayString)(e.group_name),1),t.userLevel>=3&&t.objectGroupList.length>1?((0,o.uX)(),(0,o.CE)("div",u,[(0,o.bF)(x,{icon:t.icons.trashCan,onClick:t=>E.removeGroup(e.group_id)},null,8,["icon","onClick"])])):(0,o.Q3)("v-if",!0)])))),128)),t.addingGroupStatus?((0,o.uX)(),(0,o.CE)("div",c,p)):(0,o.Q3)("v-if",!0)])):((0,o.uX)(),(0,o.CE)("div",d," Sorry - there are no groups active. ")),m,(0,o.Q3)(" ADD GROUP "),(0,o.Q3)(" TO DO - limit it to certain users "),(0,o.Lk)("div",g,[(0,o.Lk)("div",h,[t.userLevel>1&&!s.isReadOnly?((0,o.uX)(),(0,o.CE)("a",{key:0,href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:e[0]||(e[0]=(...t)=>E.addNewGroup&&E.addNewGroup(...t))},"Add Group to "+(0,a.toDisplayString)(I.destinationTitle),1)):(0,o.Q3)("v-if",!0)])]),b,(0,o.Q3)(" USERS "),(0,o.Lk)("h2",null,[(0,o.bF)(x,{icon:t.icons.userIcon},null,8,["icon"]),(0,o.eW)(" Users ")]),(0,o.Lk)("p",L," The following are a list of users who are connected to this "+(0,a.toDisplayString)(I.destinationTitle)+". Please note - users have to be a part of the groups list above. ",1),I.loadingData?((0,o.uX)(),(0,o.CE)("div",k," Currently loading User Data. ")):0!==t.objectUserList.length||t.addingUserStatus?((0,o.uX)(),(0,o.CE)("div",U,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.objectUserList,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.username,class:"user-card"},[(0,o.Lk)("img",{src:E.profilePicture(e.profile_picture),alt:"default profile",class:"user-card--profile"},null,8,y),(0,o.Lk)("div",f,[(0,o.Lk)("div",G,(0,a.toDisplayString)(e.first_name)+" "+(0,a.toDisplayString)(e.last_name),1),(0,o.Lk)("div",_,(0,a.toDisplayString)(e.email),1)]),t.userLevel>=3?((0,o.uX)(),(0,o.CE)("div",C,[(0,o.bF)(x,{icon:t.icons.trashCan,onClick:t=>E.removeUser(e.username)},null,8,["icon","onClick"])])):(0,o.Q3)("v-if",!0)])))),128)),t.addingUserStatus?((0,o.uX)(),(0,o.CE)("div",w,A)):(0,o.Q3)("v-if",!0)])):((0,o.uX)(),(0,o.CE)("div",v," Sorry - there are no current users active. ")),D,(0,o.Q3)(" TO DO - limit it to certain users "),t.userLevel>1&&!s.isReadOnly?((0,o.uX)(),(0,o.CE)("div",S,[(0,o.Lk)("div",j,[(0,o.Lk)("a",{href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:e[1]||(e[1]=(...t)=>E.addNewUser&&E.addNewUser(...t))},"Add User to "+(0,a.toDisplayString)(I.destinationTitle),1)])])):(0,o.Q3)("v-if",!0),(0,o.Q3)(" MODALS "),(0,o.bF)(F),(0,o.bF)(M),(0,o.bF)(T,{"group-id":I.deleteGroupId},null,8,["group-id"]),(0,o.bF)(X,{username:I.deleteUsername},null,8,["username"])])}]])}}]);