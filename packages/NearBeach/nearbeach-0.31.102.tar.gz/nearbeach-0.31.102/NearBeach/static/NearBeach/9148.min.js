"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[9148],{9148:(t,e,s)=>{s.d(e,{Z:()=>zt});var o=s(6252),a=s(3577);const i={class:"text-instructions"},r={key:0,class:"alert alert-info"},d={key:1,class:"alert alert-dark"},l={key:2,class:"group-card-list"},n={class:"group-card--details"},u={key:0,class:"group-card--remove"},c={key:0,class:"group-card"},p=[(0,o._)("div",{class:"group-card--details"},"++ Adding New Group ++",-1)],m=(0,o._)("div",{class:"spacer"},null,-1),g={class:"row submit-row"},h={class:"col-md-12"},b=(0,o._)("hr",null,null,-1),_={class:"text-instructions"},v={key:3,class:"alert alert-info"},U={key:4,class:"alert alert-dark"},y={key:5,class:"user-card-list"},f=["src"],G={class:"user-card--details"},w={class:"user-card--name"},D={class:"user-card--email"},L={key:0,class:"user-card--remove"},k={key:0,class:"user-card"},S=[(0,o._)("div",{class:"user-card--details"},"++ Adding User(s) ++",-1)],j=(0,o._)("div",{class:"spacer"},null,-1),$={key:6,class:"row submit-row"},A={class:"col-md-12"};var I=s(5808),x=s(6542),M=s(3138);const C={class:"modal fade",id:"addGroupModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},T={class:"modal-dialog modal-lg"},O={class:"modal-content"},B={class:"modal-header"},E=(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"addGroupCloseButton"},[(0,o._)("span",{"aria-hidden":"true"})],-1),W={class:"modal-body"},N={key:0,class:"row"},q={class:"col-md-4"},R=(0,o._)("strong",null,"Add Groups",-1),F={class:"text-instructions"},P={class:"text-instructions"},Z={class:"col-md-8"},z={key:1,class:"row"},K=(0,o._)("div",{class:"col-md-6"},[(0,o._)("strong",null,"Sorry - no results"),(0,o._)("p",{class:"text-instructions"}," This could be because "),(0,o._)("ul",{class:"text-instructions"},[(0,o._)("li",null,"There are no more groups left to add")])],-1),Y={class:"col-md-6 no-search"},J=["src"],H={class:"modal-footer"},Q=(0,o._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),V=["disabled"];var X=s(2001),tt=s(989);const et={name:"AddGroupWizard",components:{Icon:x.JO,NSelect:X.Z},computed:{...(0,tt.Se)({destination:"getDestination",locationId:"getLocationId",potentialGroupList:"getPotentialGroupList",rootUrl:"getRootUrl",staticUrl:"getStaticUrl"})},watch:{potentialGroupList(t){void 0!==t&&(this.groupFixList=t.map((t=>({value:t.group_id,label:t.group_name}))))}},mixins:[I.Z],data:()=>({groupFixList:[],groupModel:[]}),methods:{addGroup(){this.$store.commit("updateAddingGroupStatus",{addingGroupStatus:!0});const t=new FormData;this.groupModel.forEach((e=>{t.append("group_list",e)})),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/add_group/`,t).then((t=>{this.$store.commit("updateGroupsAndUsers",{objectGroupList:t.data.object_group_list,objectUserList:t.data.object_user_list,potentialGroupList:t.data.potential_group_list,potentialUserList:t.data.potential_user_list}),this.$store.commit("updateAddingGroupStatus",{addingGroupStatus:!1}),this.groupModel=[],document.getElementById("addGroupCloseButton").click()})).catch((t=>{this.$store.dispatch("newToast",{header:`Error adding group to ${this.destination}`,message:`Sorry, we could not add the group to the ${this.destination}. Error -> ${t}`,extra_classes:"bd-danger",delay:0})}))}}};var st=s(3744);const ot=(0,st.Z)(et,[["render",function(t,e,s,i,r,d){const l=(0,o.up)("Icon"),n=(0,o.up)("n-select");return(0,o.wg)(),(0,o.iD)("div",C,[(0,o._)("div",T,[(0,o._)("div",O,[(0,o._)("div",B,[(0,o._)("h2",null,[(0,o.Wm)(l,{icon:t.icons.groupPresentation},null,8,["icon"]),(0,o.Uk)(" Add Group Wizard ")]),E]),(0,o._)("div",W,[r.groupFixList.length>0?((0,o.wg)(),(0,o.iD)("div",N,[(0,o._)("div",q,[R,(0,o._)("p",F," Use the following multiple select to select which groups you want to add to this "+(0,a.toDisplayString)(t.destination)+". ",1),(0,o._)("p",P," Please note: A user's group has to be added to the "+(0,a.toDisplayString)(t.destination)+" before the user can be added. ",1)]),(0,o._)("div",Z,[(0,o.Wm)(n,{options:r.groupFixList,value:r.groupModel,"onUpdate:value":e[0]||(e[0]=t=>r.groupModel=t),multiple:""},null,8,["options","value"])])])):((0,o.wg)(),(0,o.iD)("div",z,[K,(0,o._)("div",Y,[(0,o._)("img",{src:`${t.staticUrl}NearBeach/images/placeholder/questions.svg`,alt:"Sorry - there are no results"},null,8,J)])]))]),(0,o._)("div",H,[Q,(0,o._)("button",{type:"button",class:"btn btn-primary",disabled:0==r.groupModel.length,onClick:e[1]||(e[1]=(...t)=>d.addGroup&&d.addGroup(...t))}," Add Group(s) ",8,V)])])])])}]]),at={class:"modal fade",id:"addUserModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},it={class:"modal-dialog modal-lg"},rt={class:"modal-content"},dt={class:"modal-header"},lt=(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"addUserCloseButton"},[(0,o._)("span",{"aria-hidden":"true"})],-1),nt={class:"modal-body"},ut={key:0,class:"row"},ct={class:"col-md-4"},pt=(0,o._)("strong",null,"Add Users",-1),mt={class:"text-instructions"},gt={class:"text-instructions"},ht={class:"col-md-8"},bt={key:1,class:"row"},_t={class:"col-md-6"},vt=(0,o._)("strong",null,"Sorry - no results",-1),Ut=(0,o._)("p",{class:"text-instructions"}," This could be because ",-1),yt={class:"text-instructions"},ft=(0,o._)("li",null,"There are no more users left to add",-1),Gt={class:"col-md-6 no-search"},wt=["src"],Dt={class:"modal-footer"},Lt=(0,o._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),kt=["disabled"];var St=s(3058);const jt={name:"AddUserWizard",components:{Icon:x.JO,NSelect:X.Z},mixins:[St.Z,I.Z],computed:{...(0,tt.Se)({destination:"getDestination",locationId:"getLocationId",potentialUserList:"getPotentialUserList",rootUrl:"getRootUrl",staticURL:"getStaticUrl",userLevel:"getUserLevel"})},data:()=>({userFixList:[],userModel:[]}),watch:{potentialUserList(t){void 0!==t&&(this.userFixList=t.map((t=>({value:t.id,label:`${t.username}: ${t.first_name} ${t.last_name}`}))))}},methods:{addUser(){this.$store.commit("updateAddingUserStatus",{addingUserStatus:!0});const t=new FormData;this.userModel.forEach((e=>{t.append("user_list",e)})),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/add_user/`,t).then((t=>{document.getElementById("addUserCloseButton").click(),this.userModel=[],this.$store.commit("updateGroupsAndUsers",{objectGroupList:t.data.object_group_list,objectUserList:t.data.object_user_list,potentialGroupList:t.data.potential_group_list,potentialUserList:t.data.potential_user_list}),this.$store.commit("updateAddingUserStatus",{addingUserStatus:!1})})).catch((t=>{this.showErrorModal(t,this.destination)}))}}},$t=(0,st.Z)(jt,[["render",function(t,e,s,i,r,d){const l=(0,o.up)("Icon"),n=(0,o.up)("n-select");return(0,o.wg)(),(0,o.iD)("div",at,[(0,o._)("div",it,[(0,o._)("div",rt,[(0,o._)("div",dt,[(0,o._)("h2",null,[(0,o.Wm)(l,{icon:t.icons.userIcon},null,8,["icon"]),(0,o.Uk)(" Add User Wizard ")]),lt]),(0,o._)("div",nt,[r.userFixList.length>0?((0,o.wg)(),(0,o.iD)("div",ut,[(0,o._)("div",ct,[pt,(0,o._)("p",mt," Use the following multiple select to select which users you want to add to this "+(0,a.toDisplayString)(t.destination)+". ",1),(0,o._)("p",gt," Please note: A user's group has to be added to the "+(0,a.toDisplayString)(t.destination)+" before the user can be added. ",1)]),(0,o._)("div",ht,[(0,o.Wm)(n,{options:r.userFixList,value:r.userModel,"onUpdate:value":e[0]||(e[0]=t=>r.userModel=t),multiple:""},null,8,["options","value"])])])):((0,o.wg)(),(0,o.iD)("div",bt,[(0,o._)("div",_t,[vt,Ut,(0,o._)("ul",yt,[ft,(0,o._)("li",null," The user you are after is in a group not current added to this "+(0,a.toDisplayString)(t.destination),1)])]),(0,o._)("div",Gt,[(0,o._)("img",{src:`${t.staticURL}NearBeach/images/placeholder/questions.svg`,alt:"Sorry - there are no results"},null,8,wt)])]))]),(0,o._)("div",Dt,[Lt,(0,o._)("button",{type:"button",class:"btn btn-primary",disabled:0===r.userModel.length,onClick:e[1]||(e[1]=(...t)=>d.addUser&&d.addUser(...t))}," Add User(s) ",8,kt)])])])])}]]),At={class:"modal fade",id:"confirmGroupDeleteModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"confirmGroupDelete","aria-hidden":"true"},It={class:"modal-dialog"},xt={class:"modal-content"},Mt=(0,o._)("div",{class:"modal-header"},[(0,o._)("h5",{class:"modal-title",id:"confirmGroupDelete"}," Please confirm Group Deletion "),(0,o.kq)(" TASK INFORMATION "),(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmGroupDeleteButton"})],-1),Ct=(0,o._)("div",{class:"modal-body"}," Are you sure you want to delete the Group from the object? ",-1),Tt={class:"modal-footer"},Ot={name:"ConfirmGroupDelete",props:{groupId:{type:Number,default:0}},computed:{...(0,tt.Se)({destination:"getDestination",locationId:"getLocationId",objectGroupList:"getObjectGroupList",rootUrl:"getRootUrl"})},methods:{deleteGroup(){this.$store.commit("updateGroupsAndUsers",{objectGroupList:this.objectGroupList.filter((t=>t.group_id!==this.groupId))});const t=new FormData;t.set("group_id",`${this.groupId}`),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/remove_group/`,t).then((t=>{this.$store.commit("updateGroupsAndUsers",{objectGroupList:t.data.object_group_list,objectUserList:t.data.object_user_list,potentialGroupList:t.data.potential_group_list,potentialUserList:t.data.potential_user_list})})).catch((t=>{this.$store.dispatch("newToast",{header:"Error removing group from object",message:`We encounted an error moving the group from the object. Error -> ${t}`,extra_classes:"bg-danger",delay:0})})),this.closeModal()},closeModal(){document.getElementById("confirmGroupDeleteButton").click()}}},Bt=(0,st.Z)(Ot,[["render",function(t,e,s,a,i,r){return(0,o.wg)(),(0,o.iD)("div",At,[(0,o._)("div",It,[(0,o._)("div",xt,[Mt,Ct,(0,o._)("div",Tt,[(0,o._)("button",{type:"button",class:"btn btn-secondary",onClick:e[0]||(e[0]=(...t)=>r.closeModal&&r.closeModal(...t))}," No "),(0,o._)("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=(...t)=>r.deleteGroup&&r.deleteGroup(...t))}," Yes ")])])])])}]]),Et={class:"modal fade",id:"confirmUserDeleteModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"confirmUserDelete","aria-hidden":"true"},Wt={class:"modal-dialog"},Nt={class:"modal-content"},qt=(0,o._)("div",{class:"modal-header"},[(0,o._)("h5",{class:"modal-title",id:"confirmUserDelete"}," Please confirm User Deletion "),(0,o.kq)(" TASK INFORMATION "),(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmUserDeleteButton"})],-1),Rt=(0,o._)("div",{class:"modal-body"}," Are you sure you want to delete the User from the object? ",-1),Ft={class:"modal-footer"},Pt={name:"ConfirmUserDelete",props:{username:{type:String,default:""}},computed:{...(0,tt.Se)({destination:"getDestination",locationId:"getLocationId",objectUserList:"getObjectUserList",rootUrl:"getRootUrl"})},methods:{deleteUser(){this.$store.commit("updateGroupsAndUsers",{objectUserList:this.objectUserList.filter((t=>t.username!==this.username))});const t=new FormData;t.set("username",this.username),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/remove_user/`,t).then((t=>{this.$store.commit("updateGroupsAndUsers",{objectGroupList:t.data.object_group_list,objectUserList:t.data.object_user_list,potentialGroupList:t.data.potential_group_list,potentialUserList:t.data.potential_user_list})})).catch((t=>{this.$store.dispatch("newToast",{header:"Error removing user from object",message:`We encounted an error moving the user from the object. Error -> ${t}`,extra_classes:"bg-danger",delay:0})})),this.closeModal()},closeModal(){document.getElementById("confirmUserDeleteButton").click()}}},Zt={name:"GroupsAndUsersModule",components:{AddGroupWizard:ot,AddUserWizard:$t,ConfirmGroupDelete:Bt,ConfirmUserDelete:(0,st.Z)(Pt,[["render",function(t,e,s,a,i,r){return(0,o.wg)(),(0,o.iD)("div",Et,[(0,o._)("div",Wt,[(0,o._)("div",Nt,[qt,Rt,(0,o._)("div",Ft,[(0,o._)("button",{type:"button",class:"btn btn-secondary",onClick:e[0]||(e[0]=(...t)=>r.closeModal&&r.closeModal(...t))}," No "),(0,o._)("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=(...t)=>r.deleteUser&&r.deleteUser(...t))}," Yes ")])])])])}]]),Icon:x.JO},props:{isReadOnly:{type:Boolean,default:!1}},data:()=>({deleteGroupId:0,deleteUsername:"",destinationTitle:"",loadingData:!0}),computed:{...(0,tt.Se)({addingGroupStatus:"getAddingGroupStatus",addingUserStatus:"getAddingUserStatus",destination:"getDestination",locationId:"getLocationId",objectGroupList:"getObjectGroupList",objectUserList:"getObjectUserList",rootUrl:"getRootUrl",staticUrl:"getStaticUrl",userLevel:"getUserLevel"})},mixins:[I.Z],methods:{addNewGroup(){new M.u_(document.getElementById("addGroupModal")).show()},addNewUser(){new M.u_(document.getElementById("addUserModal")).show()},getGroupAndUserData(){this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/group_and_user_data/`).then((t=>{this.$store.commit("updateGroupsAndUsers",{objectGroupList:t.data.object_group_list,objectUserList:t.data.object_user_list,potentialGroupList:t.data.potential_group_list,potentialUserList:t.data.potential_user_list}),this.loadingData=!1})).catch((t=>{this.$store.dispatch("newToast",{header:"Error fetching group and user data",message:`Sorry we could not get any group or user data. Error -> ${t}`,extra_classes:"bd-danger",delay:0})}))},profilePicture(t){return null!==t&&""!==t?`${this.rootUrl}private/${t}/`:`${this.staticUrl}NearBeach/images/placeholder/people_tax.svg`},removeGroup(t){this.deleteGroupId=t,new M.u_(document.getElementById("confirmGroupDeleteModal")).show()},removeUser(t){this.deleteUsername=t,new M.u_(document.getElementById("confirmUserDeleteModal")).show()}},mounted(){this.$nextTick((()=>{if(0===this.locationId)return void setTimeout((()=>{this.getGroupAndUserData()}),100);this.getGroupAndUserData();let t=this.destination;t=t.replaceAll("_"," "),this.destinationTitle=t.replace(/\w\S*/g,(t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()))}))}},zt=(0,st.Z)(Zt,[["render",function(t,e,s,I,x,M){const C=(0,o.up)("Icon"),T=(0,o.up)("add-group-wizard"),O=(0,o.up)("add-user-wizard"),B=(0,o.up)("confirm-group-delete"),E=(0,o.up)("confirm-user-delete");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.kq)(" GROUPS "),(0,o._)("h2",null,[(0,o.Wm)(C,{icon:t.icons.groupPresentation},null,8,["icon"]),(0,o.Uk)(" Groups ")]),(0,o._)("p",i," The following list are all the Groups connected to this "+(0,a.toDisplayString)(x.destinationTitle)+". Users will have to be included in these groups to be added to this "+(0,a.toDisplayString)(x.destinationTitle),1),x.loadingData?((0,o.wg)(),(0,o.iD)("div",r," Currently loading group data. ")):0!==t.objectGroupList.length||t.addingGroupStatus?((0,o.wg)(),(0,o.iD)("div",l,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.objectGroupList,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.group_id,class:"group-card"},[(0,o._)("div",n,(0,a.toDisplayString)(e.group_name),1),t.userLevel>=3&&t.objectGroupList.length>1?((0,o.wg)(),(0,o.iD)("div",u,[(0,o.Wm)(C,{icon:t.icons.trashCan,onClick:t=>M.removeGroup(e.group_id)},null,8,["icon","onClick"])])):(0,o.kq)("v-if",!0)])))),128)),t.addingGroupStatus?((0,o.wg)(),(0,o.iD)("div",c,p)):(0,o.kq)("v-if",!0)])):((0,o.wg)(),(0,o.iD)("div",d," Sorry - there are no groups active. ")),m,(0,o.kq)(" ADD GROUP "),(0,o.kq)(" TO DO - limit it to certain users "),(0,o._)("div",g,[(0,o._)("div",h,[t.userLevel>1&&!s.isReadOnly?((0,o.wg)(),(0,o.iD)("a",{key:0,href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:e[0]||(e[0]=(...t)=>M.addNewGroup&&M.addNewGroup(...t))},"Add Group to "+(0,a.toDisplayString)(x.destinationTitle),1)):(0,o.kq)("v-if",!0)])]),b,(0,o.kq)(" USERS "),(0,o._)("h2",null,[(0,o.Wm)(C,{icon:t.icons.userIcon},null,8,["icon"]),(0,o.Uk)(" Users ")]),(0,o._)("p",_," The following are a list of users who are connected to this "+(0,a.toDisplayString)(x.destinationTitle)+". Please note - users have to be a part of the groups list above. ",1),x.loadingData?((0,o.wg)(),(0,o.iD)("div",v," Currently loading User Data. ")):0!==t.objectUserList.length||t.addingUserStatus?((0,o.wg)(),(0,o.iD)("div",y,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.objectUserList,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.username,class:"user-card"},[(0,o._)("img",{src:M.profilePicture(e.profile_picture),alt:"default profile",class:"user-card--profile"},null,8,f),(0,o._)("div",G,[(0,o._)("div",w,(0,a.toDisplayString)(e.first_name)+" "+(0,a.toDisplayString)(e.last_name),1),(0,o._)("div",D,(0,a.toDisplayString)(e.email),1)]),t.userLevel>=3?((0,o.wg)(),(0,o.iD)("div",L,[(0,o.Wm)(C,{icon:t.icons.trashCan,onClick:t=>M.removeUser(e.username)},null,8,["icon","onClick"])])):(0,o.kq)("v-if",!0)])))),128)),t.addingUserStatus?((0,o.wg)(),(0,o.iD)("div",k,S)):(0,o.kq)("v-if",!0)])):((0,o.wg)(),(0,o.iD)("div",U," Sorry - there are no current users active. ")),j,(0,o.kq)(" TO DO - limit it to certain users "),t.userLevel>1&&!s.isReadOnly?((0,o.wg)(),(0,o.iD)("div",$,[(0,o._)("div",A,[(0,o._)("a",{href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:e[1]||(e[1]=(...t)=>M.addNewUser&&M.addNewUser(...t))},"Add User to "+(0,a.toDisplayString)(x.destinationTitle),1)])])):(0,o.kq)("v-if",!0),(0,o.kq)(" MODALS "),(0,o.Wm)(T),(0,o.Wm)(O),(0,o.Wm)(B,{"group-id":x.deleteGroupId},null,8,["group-id"]),(0,o.Wm)(E,{username:x.deleteUsername},null,8,["username"])])}]])}}]);