"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[2866],{8838:(t,e,o)=>{o.d(e,{A:()=>f});var n,s=o(641),i=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCommentChange","onCompositionEnd","onCompositionStart","onCompositionUpdate","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onInput","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],a=function(t){return-1!==i.map((function(t){return t.toLowerCase()})).indexOf(t.toLowerCase())},r=0,l=function(t){var e=Date.now();return t+"_"+Math.floor(1e9*Math.random())+ ++r+String(e)},c=function(t){return void 0===t||""===t?[]:Array.isArray(t)?t:t.split(" ")},d=function(){return{listeners:[],scriptId:l("tiny-script"),scriptLoaded:!1}},u=(n=d(),{load:function(t,e,o){n.scriptLoaded?o():(n.listeners.push(o),t.getElementById(n.scriptId)||function(t,e,o,s){var i=e.createElement("script");i.referrerPolicy="origin",i.type="application/javascript",i.id=t,i.src=o;var a=function(){i.removeEventListener("load",a),n.listeners.forEach((function(t){return t()})),n.scriptLoaded=!0};i.addEventListener("load",a),e.head&&e.head.appendChild(i)}(n.scriptId,t,e))},reinitialize:function(){n=d()}}),m=function(){var t="undefined"!=typeof window?window:o.g;return t&&t.tinymce?t.tinymce:null},g={apiKey:String,licenseKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(t){return"html"===t||"text"===t}}},p=o(953),h=function(){return h=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var s in e=arguments[o])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t},h.apply(this,arguments)},v={selector:void 0,target:void 0};const f=(0,s.pM)({props:g,setup:function(t,e){var o=t.init?h(h({},t.init),v):h({},v),n=(0,p.QW)(t),i=n.disabled,r=n.modelValue,d=n.tagName,g=(0,p.KR)(null),f=null,b=t.id||l("tiny-vue"),y=t.init&&t.init.inline||t.inline,L=!!e.attrs["onUpdate:modelValue"],k=!0,C=t.initialValue?t.initialValue:"",_="",S=function(){var n,i,l,d=(n=k,L?function(){return(null==r?void 0:r.value)?r.value:""}:function(){return n?C:_}),u=h(h({},o),{readonly:t.disabled,target:g.value,plugins:(i=o.plugins,l=t.plugins,c(i).concat(c(l))),toolbar:t.toolbar||o.toolbar,inline:y,setup:function(n){f=n,n.on("init",(function(o){return function(t,e,o,n,i,r){n.setContent(r()),o.attrs["onUpdate:modelValue"]&&function(t,e,o,n){var i=t.modelEvents?t.modelEvents:null,a=Array.isArray(i)?i.join(" "):i;(0,s.wB)(n,(function(e,n){o&&"string"==typeof e&&e!==n&&e!==o.getContent({format:t.outputFormat})&&o.setContent(e)})),o.on(a||"change input undo redo",(function(){e.emit("update:modelValue",o.getContent({format:t.outputFormat}))}))}(e,o,n,i),function(t,e,o){Object.keys(e).filter(a).forEach((function(n){var s=e[n];"function"==typeof s&&("onInit"===n?s(t,o):o.on(n.substring(2),(function(t){return s(t,o)})))}))}(t,o.attrs,n)}(o,t,e,n,r,d)})),"function"==typeof o.setup&&o.setup(n)}});(function(t){return null!==t&&"textarea"===t.tagName.toLowerCase()})(g.value)&&(g.value.style.visibility=""),m().init(u),k=!1};return(0,s.wB)(i,(function(t){var e;null!==f&&("function"==typeof(null===(e=f.mode)||void 0===e?void 0:e.set)?f.mode.set(t?"readonly":"design"):f.setMode(t?"readonly":"design"))})),(0,s.wB)(d,(function(t){var e;L||(_=f.getContent()),null===(e=m())||void 0===e||e.remove(f),(0,s.dY)((function(){return S()}))})),(0,s.sV)((function(){if(null!==m())S();else if(g.value&&g.value.ownerDocument){var e=t.cloudChannel?t.cloudChannel:"7",o=t.apiKey?t.apiKey:"no-api-key",n=null==t.tinymceScriptSrc?"https://cdn.tiny.cloud/1/".concat(o,"/tinymce/").concat(e,"/tinymce.min.js"):t.tinymceScriptSrc;u.load(g.value.ownerDocument,n,S)}})),(0,s.xo)((function(){null!==m()&&m().remove(f)})),y||((0,s.n)((function(){k||S()})),(0,s.Y4)((function(){var t;L||(_=f.getContent()),null===(t=m())||void 0===t||t.remove(f)}))),e.expose({rerender:function(t){var e;_=f.getContent(),null===(e=m())||void 0===e||e.remove(f),o=h(h(h({},o),t),v),(0,s.dY)((function(){return S()}))},getEditor:function(){return f}}),function(){return y?function(t,e,o,n){return t(n||"div",{id:e,ref:o})}(s.h,b,g,t.tagName):(0,s.h)("textarea",{id:b,visibility:"hidden",ref:g})}}})},3812:(t,e,o)=>{o.d(e,{A:()=>E});var n=o(641),s=o(33);const i={class:"customer-list"},a=["src"],r={class:"customer-card--details"},l={class:"customer-card--name"},c=["href"],d={class:"customer-card--email"},u={key:0,class:"customer-card--remove"};var m=o(9336),g=o(2321);const p={class:"modal fade",id:"confirmCustomerRemoveModal",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"confirmCustomerRemove","aria-hidden":"true"},h={class:"modal-dialog"},v={class:"modal-content"},f=(0,n.Lk)("div",{class:"modal-header"},[(0,n.Lk)("h5",{class:"modal-title",id:"confirmCustomerRemove"}," Please confirm Customer Removal "),(0,n.Q3)(" TASK INFORMATION "),(0,n.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"confirmCustomerRemoveButton"})],-1),b={class:"modal-body"},y={class:"customer-card--details"},L={class:"customer-card--name"},k=["href"],C={class:"customer-card--email"},_={class:"modal-footer"};var S=o(2124);const I={name:"ConfirmCustomerRemoval",emits:["remove_customer"],props:{customerObject:{type:Object,default:()=>({customer_id:0,customer_email:"",customer_first_name:"",customer_last_name:"",customer_profile_picture:""})}},computed:{...(0,S.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl"})},methods:{closeModal(){document.getElementById("confirmCustomerRemoveButton").click()},removeCustomer(){const t=new FormData;t.set("customer_id",this.customerObject.customer_id);let e=`${this.rootUrl}object_data/${this.destination}/${this.locationId}/remove_customer/`;"organisation"===this.destination&&(e=`${this.rootUrl}customer_information/${this.locationId}/delete/`),this.axios.post(e,t).then((()=>{this.$emit("remove_customer",this.customerObject.customer_id)})).catch((t=>{this.$store.dispatch("newToast",{header:"Can't remove customer",message:`Sorry, could not remove customer. Error -> ${t}`,extra_classes:"bg-warning text-dark",delay:0})})),this.closeModal()}}};var A=o(6262);const w=(0,A.A)(I,[["render",function(t,e,o,i,a,r){return(0,n.uX)(),(0,n.CE)("div",p,[(0,n.Lk)("div",h,[(0,n.Lk)("div",v,[f,(0,n.Lk)("div",b,[(0,n.Lk)("div",y,[(0,n.Lk)("div",L,[(0,n.Lk)("a",{href:`${t.rootUrl}customer_information/${o.customerObject.customer_id}/`,target:"_blank"},(0,s.toDisplayString)(o.customerObject.customer_first_name)+" "+(0,s.toDisplayString)(o.customerObject.customer_last_name),9,k)]),(0,n.Lk)("div",C,(0,s.toDisplayString)(o.customerObject.customer_email),1)])]),(0,n.Lk)("div",_,[(0,n.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:e[0]||(e[0]=(...t)=>r.closeModal&&r.closeModal(...t))}," No "),(0,n.Lk)("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=(...t)=>r.removeCustomer&&r.removeCustomer(...t))}," Yes ")])])])])}]]);var T=o(2243);const D={name:"CustomersListModule",components:{ConfirmCustomerRemoval:w,Icon:g.In},props:{customerResults:{type:Array,default:()=>[]}},computed:{...(0,S.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl",staticUrl:"getStaticUrl",userLevel:"getUserLevel"}),defaultCustomerImage(){return`${this.staticUrl}/NearBeach/images/placeholder/people_tax.svg`}},mixins:[T.A],data:()=>({customerObject:{customer_id:0,customer_email:"",customer_first_name:"",customer_last_name:"",customer_profile_picture:""}}),emits:["remove_customer"],methods:{confirmRemoveCustomer(t){const e=this.customerResults.filter((e=>parseInt(e.pk)===parseInt(t)));1===e.length?(this.customerObject=e.map((t=>({customer_id:t.pk,customer_email:t.fields.customer_email,customer_first_name:t.fields.customer_first_name,customer_last_name:t.fields.customer_last_name,customer_profile_picture:t.fields.customer_profile_picture})))[0],new m.aF(document.getElementById("confirmCustomerRemoveModal")).show()):this.$store.dispatch("newToast",{header:"Error Deleting Customer",message:"Could not select the correct ID of the customer. Something went wrong",extra_classes:"bg-danger",delay:0})},getCustomerImage(t){const e=t.fields.customer_profile_picture;return""===e||null===e?this.defaultCustomerImage:`${this.rootUrl}private/${e}`},removeCustomer(t){this.$emit("remove_customer",t)}}},E=(0,A.A)(D,[["render",function(t,e,o,m,g,p){const h=(0,n.g2)("Icon"),v=(0,n.g2)("confirm-customer-removal");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("div",i,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.customerResults,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.pk,class:"customer-card"},[(0,n.Q3)(" CUSOMER PROFILE "),(0,n.Lk)("img",{src:p.getCustomerImage(e),alt:"default profile picture"},null,8,a),(0,n.Q3)(" CUSTOMER DETAILS "),(0,n.Lk)("div",r,[(0,n.Lk)("div",l,[(0,n.Lk)("a",{href:`${t.rootUrl}customer_information/${e.pk}/`},(0,s.toDisplayString)(e.fields.customer_first_name)+" "+(0,s.toDisplayString)(e.fields.customer_last_name),9,c)]),(0,n.Lk)("div",d,[(0,n.bF)(h,{icon:t.icons.mailIcon},null,8,["icon"]),(0,n.eW)(" "+(0,s.toDisplayString)(e.fields.customer_email),1)])]),t.userLevel>=2?((0,n.uX)(),(0,n.CE)("div",u,[(0,n.bF)(h,{icon:t.icons.trashCan,onClick:t=>p.confirmRemoveCustomer(e.pk)},null,8,["icon","onClick"])])):(0,n.Q3)("v-if",!0)])))),128))]),(0,n.bF)(v,{"customer-object":g.customerObject,onRemove_customer:e[0]||(e[0]=t=>p.removeCustomer(t))},null,8,["customer-object"])],64)}]])},7214:(t,e,o)=>{o.d(e,{A:()=>x});var n=o(641),s=o(33);const i=(0,n.Lk)("h2",null,"Assigned Tags",-1),a={class:"text-instructions"},r={class:"tag-list"},l=["onClick"],c={class:"row submit-row"},d={class:"col-md-12"};var u=o(9336),m=o(2321),g=o(2243);const p={class:"modal fade",id:"addTagModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},h={class:"modal-dialog"},v={class:"modal-content"},f={class:"modal-header"},b=(0,n.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"addTagsCloseButton"},[(0,n.Lk)("span",{"aria-hidden":"true"})],-1),y={class:"modal-body"},L={class:"row"},k={class:"col-md-4"},C=(0,n.Lk)("strong",null,"Add Tag",-1),_={class:"text-instructions"},S={class:"col-md-8"},I=(0,n.Lk)("label",null,"All Tag List",-1),A={class:"modal-footer"},w=(0,n.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1);var T=o(1080),D=o(2124);const E={name:"AddTagWizard",components:{Icon:m.In,NSelect:T.A},props:{assignedTags:{type:Array,default:()=>[]},destination:{type:String,default:""},locationId:{type:Number,default:0}},mixins:[g.A],data:()=>({allTagList:[],tagModel:[]}),computed:{...(0,D.L8)({rootUrl:"getRootUrl"}),tagList(){return this.allTagList.filter((t=>this.assignedTags.findIndex((e=>e.pk===parseInt(t.value)))<0))}},methods:{addTag(){const t=new FormData;this.tagModel.forEach((e=>{t.append("tag_id",e)})),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/add_tags/`,t).then((t=>{this.$emit("add_tags",t.data),document.getElementById("addTagsCloseButton").click(),this.tagModel=[]})).catch((t=>{this.$store.dispatch("newToast",{header:"Failed to add tag",message:`Sorry, we could not add tag. Errors -> ${t}`,extra_classes:"bg-danger",delay:0})}))},getTagList(){this.axios.post(`${this.rootUrl}object_data/tag_list_all/`).then((t=>{this.allTagList=t.data.map((t=>({value:t.pk,label:t.fields.tag_name})))})).catch((t=>{this.$store.dispatch("newToast",{header:"Failed to get tag list",message:`Sorry, we could not get the tag list. Errors -> ${t}`,extra_classes:"bg-danger",delay:0})}))}},mounted(){["requirement_item"].indexOf(this.destination)>=0||this.$nextTick((()=>{this.getTagList()}))}};var $=o(6262);const U={name:"ListTagsModule",components:{AddTagWizard:(0,$.A)(E,[["render",function(t,e,o,i,a,r){const l=(0,n.g2)("Icon"),c=(0,n.g2)("n-select");return(0,n.uX)(),(0,n.CE)("div",p,[(0,n.Lk)("div",h,[(0,n.Lk)("div",v,[(0,n.Lk)("div",f,[(0,n.Lk)("h2",null,[(0,n.bF)(l,{icon:t.icons.usersIcon},null,8,["icon"]),(0,n.eW)(" Add Tags Wizard ")]),b]),(0,n.Lk)("div",y,[(0,n.Lk)("div",L,[(0,n.Lk)("div",k,[C,(0,n.Lk)("p",_," Use the dropdown to select one or many lables to add to the "+(0,s.toDisplayString)(o.destination)+". ",1)]),(0,n.Lk)("div",S,[I,(0,n.bF)(c,{label:"tag",multiple:"",options:r.tagList,value:a.tagModel,"onUpdate:value":e[0]||(e[0]=t=>a.tagModel=t)},null,8,["options","value"])])])]),(0,n.Lk)("div",A,[w,(0,n.Lk)("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=(...t)=>r.addTag&&r.addTag(...t))}," Add Tag ")])])])])}]]),Icon:m.In},data:()=>({tagList:[]}),mixins:[g.A],computed:{...(0,D.L8)({destination:"getDestination",locationId:"getLocationId",rootUrl:"getRootUrl",userLevel:"getUserLevel"})},methods:{addTags(t){this.tagList=t},createNewTag(){new u.aF(document.getElementById("addTagModal")).show()},getAssignedTags(){this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/tag_list/`).then((t=>{this.tagList=t.data})).catch((t=>{}))},removeTag(t){if(this.userLevel<=1)return;const e=new FormData;e.set("tag",t),e.set("object_enum",this.destination),e.set("object_id",this.locationId),this.axios.post(`${this.rootUrl}object_data/delete_tag/`,e).then((e=>{this.tagList=this.tagList.filter((e=>e.pk!==t))})).catch((t=>{}))}},mounted(){["requirement_item"].indexOf(this.destination)>=0||this.$nextTick((()=>{this.getAssignedTags()}))}},x=(0,$.A)(U,[["render",function(t,e,o,u,m,g){const p=(0,n.g2)("Icon"),h=(0,n.g2)("add-tag-wizard");return(0,n.uX)(),(0,n.CE)("div",null,[i,(0,n.Lk)("p",a," Here are all tags associated with this "+(0,s.toDisplayString)(t.destination)+'. You can add more tags by clicking on the "Add Tag" button. ',1),(0,n.Lk)("div",r,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(m.tagList,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.pk,class:"single-tag",style:(0,s.normalizeStyle)(`background-color: ${e.fields.tag_colour};color: ${e.fields.tag_text_colour};`)},[(0,n.eW)((0,s.toDisplayString)(e.fields.tag_name)+" ",1),(0,n.Lk)("span",{onClick:t=>g.removeTag(e.pk)},[t.userLevel>1?((0,n.uX)(),(0,n.Wv)(p,{key:0,icon:t.icons.xCircle},null,8,["icon"])):(0,n.Q3)("v-if",!0)],8,l)],4)))),128))]),(0,n.Q3)(" ADD TAG BUTTON "),(0,n.Lk)("div",c,[(0,n.Lk)("div",d,[t.userLevel>1?((0,n.uX)(),(0,n.CE)("a",{key:0,href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:e[0]||(e[0]=(...t)=>g.createNewTag&&g.createNewTag(...t))},"Add Tag to "+(0,s.toDisplayString)(t.destination),1)):(0,n.Q3)("v-if",!0)])]),(0,n.Q3)(" ADD TAG MODULE "),(0,n.bF)(h,{destination:t.destination,"location-id":t.locationId,"assigned-tags":m.tagList,onAdd_tags:e[1]||(e[1]=t=>g.addTags(t))},null,8,["destination","location-id","assigned-tags"])])}]])},7889:(t,e,o)=>{o.d(e,{A:()=>v});var n=o(641),s=o(33);const i={class:"text-instructions"},a=(0,n.Lk)("hr",null,null,-1),r={class:"row submit-row"},l={class:"col-md-12"};var c=o(9336),d=o(2243),u=o(2321),m=o(531),g=o(4371),p=o(2124);const h={name:"NotesModule",components:{Icon:u.In,ListNotes:m.A,NewHistoryNoteWizard:g.A},mixins:[d.A],computed:{...(0,p.L8)({destination:"getDestination",locationId:"getLocationId",userLevel:"getUserLevel",rootUrl:"getRootUrl"})},methods:{createNewNote(){new c.aF(document.getElementById("newNoteModal")).show()},getNoteHistoryResults(){let t="note_list";"organisation"===this.destination&&(t="organisation_note_list"),this.axios.post(`${this.rootUrl}object_data/${this.destination}/${this.locationId}/${t}/`).then((t=>{this.$store.commit({type:"initNoteList",noteList:t.data})})).catch((t=>{this.$store.dispatch("newToast",{header:"Error Getting Note History",message:`Can not retrieve the note history. Error -> ${t}`,extra_classes:"bg-danger",delay:0})}))}},mounted(){this.$nextTick((()=>{this.getNoteHistoryResults()}))}},v=(0,o(6262).A)(h,[["render",function(t,e,o,c,d,u){const m=(0,n.g2)("Icon"),g=(0,n.g2)("list-notes");return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("h2",null,[(0,n.bF)(m,{icon:t.icons.noteAdd},null,8,["icon"]),(0,n.eW)(" Note History ")]),(0,n.Lk)("p",i," The following are saved notes against this "+(0,s.toDisplayString)(t.destination)+". Add notes by clicking on the button below. ",1),(0,n.bF)(g,{destination:t.destination},null,8,["destination"]),(0,n.Q3)(" ADD NOTE HISTORY "),(0,n.Q3)(" TO DO - limit it to certain users "),a,(0,n.Lk)("div",r,[(0,n.Lk)("div",l,[t.userLevel>1?((0,n.uX)(),(0,n.CE)("button",{key:0,class:"btn btn-primary save-changes",onClick:e[0]||(e[0]=(...t)=>u.createNewNote&&u.createNewNote(...t))}," Add Note to "+(0,s.toDisplayString)(t.destination),1)):(0,n.Q3)("v-if",!0)])])])}]])},469:(t,e,o)=>{o.d(e,{A:()=>f});var n=o(641),s=o(33);const i={class:"object-card-list"},a={class:"object-card--detail"},r=["href"],l={class:"object-card--detail--link"},c={class:"object-card--detail--description"},d={class:"object-card--status"},u=["href"],m={class:"object-card--status--status"},g={class:"small-text"};var p=o(8083),h=o(2124);const v={name:"RenderObjectCard",props:{destination:{type:String,default:""},importVariables:{type:Object,default:()=>({header:"",prefix:"",id:0,title:"",status:""})},searchResults:{type:Array,default:()=>[]}},mixins:[p.A],computed:{...(0,h.L8)({rootUrl:"getRootUrl"})}},f=(0,o(6262).A)(v,[["render",function(t,e,o,p,h,v){return(0,n.uX)(),(0,n.CE)("div",i,[(0,n.Lk)("h2",null,(0,s.toDisplayString)(o.importVariables.header),1),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.searchResults,(e=>((0,n.uX)(),(0,n.CE)("div",{class:"object-card",key:e.pk},[(0,n.Lk)("div",a,[(0,n.Lk)("a",{href:`${t.rootUrl}${o.destination}_information/${e[o.importVariables.id]}/`},[(0,n.Lk)("div",l,(0,s.toDisplayString)(o.importVariables.prefix)+(0,s.toDisplayString)(e[o.importVariables.id]),1),(0,n.Lk)("div",c,(0,s.toDisplayString)(e[o.importVariables.title]),1)],8,r)]),(0,n.Lk)("div",d,[(0,n.Lk)("a",{href:`${t.rootUrl}${o.destination}_information/${e[o.importVariables.id]}/`},[(0,n.Lk)("div",m,(0,s.toDisplayString)(e[o.importVariables.status]),1),(0,n.Lk)("p",g,(0,s.toDisplayString)(t.getNiceDatetime(e[o.importVariables.end_date])),1)],8,u)])])))),128))])}]])}}]);