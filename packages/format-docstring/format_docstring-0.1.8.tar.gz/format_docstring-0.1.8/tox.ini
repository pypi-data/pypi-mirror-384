[tox]
envlist =
    py310
    py311
    py312
    py313
    mypy
    muff-lint
    muff-format
    flake8-misc
    pre-commit


[gh-actions]
python =
    3.10: py310, mypy, muff, check-self, flake8-basic, flake8-misc, flake8-docstrings, pre-commit
    3.11: py311, mypy, muff, check-self, flake8-basic, flake8-misc, flake8-docstrings, pre-commit
    3.12: py311, mypy, muff, check-self, flake8-basic, flake8-misc, flake8-docstrings, pre-commit
    3.13: py311, mypy, muff, check-self, flake8-basic, flake8-misc, flake8-docstrings, pre-commit


[testenv:mypy]
deps =
    mypy
commands =
    mypy format_docstring/


[testenv:muff-lint]
deps =
    muff
skip_install = true
commands =
    muff check --fix --config=muff.toml format_docstring tests


[testenv:muff-format]
deps =
    muff
skip_install = true
commands =
    # use the '--diff' flag to avoid accidentally formatting code
    muff format --diff --config=muff.toml format_docstring tests


[testenv:flake8-misc]
skip_install = true
deps =
    flake8-clean-block
    flake8-picky-parentheses
    flake8-broken-line
commands =
    flake8 --select CLB,PAR,N400 .


[testenv]
deps =
    pytest
commands =
    pytest --tb=long


[testenv:pre-commit]
skip_install = true
deps =
    pre-commit
set_env =
    # Skipping auto-formatter here to avoid accidentally formatting code
    SKIP = muff
commands =
    pre-commit run -a


[flake8]
exclude =
    .*,
    build/*,
    venv/*,
    tests/test_data/*,
