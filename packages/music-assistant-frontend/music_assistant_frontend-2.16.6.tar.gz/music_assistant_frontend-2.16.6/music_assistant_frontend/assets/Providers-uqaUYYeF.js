import{d as F,r as b,v as i,a$ as G,q as O,ae as q,c as M,a as V,b as a,w as s,u as o,f as X,t as m,$ as d,F as E,cf as l,o as c,b5 as u,g as j,h as v,x as J,b4 as Q,bJ as H,n as K,e as I,j as f,bt as W,b1 as Z,z as ee,cg as te,P as ne,p as ie}from"./index-BhOyEZK_.js";import{C as se}from"./Container-CLJQvqnD.js";import{P as ae}from"./ProviderFilters-xxDNHjuL.js";import{z}from"./index-CBho6rsP.js";import{V as p}from"./VBtn-BOIOydWK.js";import{V as re,a as oe}from"./VRow-CoIuIaw9.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VContainer-DKHNP7rI.js";/* empty css              */import"./VTextField-Sp-MxMBq.js";import"./VInput-CthlhD7f.js";const de={class:"providers-header w-100"},ce={class:"pl-5 font-weight-medium"},ue=F({__name:"Providers",setup(pe){const y=X(),g=b([]),h=b(""),P=b([]),C=b([]),U=i.subscribe(G.PROVIDERS_UPDATED,()=>{x()});O(U);const x=async function(){g.value=await i.getProviderConfigs()},L=function(t){i.removeProviderConfig(t),g.value=g.value.filter(e=>e.instance_id!=t)},A=function(t){y.push(`/settings/editprovider/${t}`)},N=function(t){t.enabled=!t.enabled,i.saveProviderConfig(t.domain,{enabled:t.enabled},t.instance_id)},$=function(t){i.sendCommand("config/providers/reload",{instance_id:t}).catch(e=>alert(e))},R=function(t,e){const n=i.providerManifests[e.domain],r=i.getProvider(e.instance_id),k=[{label:"settings.configure",labelArgs:[],action:()=>{A(e.instance_id)},icon:"mdi-cog"},{label:e.enabled?"settings.disable":"settings.enable",labelArgs:[],action:()=>{N(e)},icon:"mdi-cancel",disabled:!n.allow_disable},{label:"settings.documentation",labelArgs:[],action:()=>{te(n.documentation)},icon:"mdi-bookshelf",disabled:!n.documentation},{label:"settings.sync",labelArgs:[],action:()=>{i.startSync(void 0,[e.instance_id])},icon:"mdi-sync",hide:!r?.available||e.type!=l.MUSIC},{label:"settings.delete",labelArgs:[],action:()=>{L(e.instance_id)},icon:"mdi-delete",hide:n.builtin},{label:"settings.reload",labelArgs:[],action:()=>{$(e.instance_id)},icon:"mdi-refresh"}];r?.available&&r.supported_features.includes(ne.CREATE_GROUP_PLAYER)&&k.push({label:"settings.add_group_player",labelArgs:[],action:()=>{y.push(`/settings/addgroup/${r.lookup_key}`)},icon:"mdi-speaker-multiple"}),ie.emit("contextmenu",{items:k,posX:t.clientX,posY:t.clientY})};q(()=>i.providers,t=>{t&&x()},{immediate:!0});const _=function(t){const e=i.providerManifests[t.domain].name;if(t.name)return`${e} [${t.name}]`;const n=i.getProvider(t.instance_id);return n&&n.instance_name_postfix?`${e} [${n.instance_name_postfix}]`:e},S=function(t){return t&&t.length>150},B=function(t){return z(t).with("stable",()=>"green").with("beta",()=>"blue").with("alpha",()=>"purple").with("experimental",()=>"orange").with("unmaintained",()=>"grey").with("deprecated",()=>"red").otherwise(()=>"green")},D=function(t){return z(t).with(l.MUSIC,()=>d("settings.music")).with(l.PLAYER,()=>d("settings.player")).with(l.METADATA,()=>d("settings.metadata")).with(l.PLUGIN,()=>d("settings.plugin")).otherwise(()=>d("settings.player"))},Y=function(t){return{[l.MUSIC]:"mdi-music",[l.PLAYER]:"mdi-speaker",[l.METADATA]:"mdi-file-code",[l.PLUGIN]:"mdi-puzzle"}[t]||"mdi-help-circle"},T=function(t){return{[l.PLAYER]:1,[l.MUSIC]:2,[l.METADATA]:3,[l.PLUGIN]:4}[t]||999},w=function(){let t=[...g.value];if(h.value){const e=h.value.toLowerCase();t=t.filter(n=>_(n).toLowerCase().includes(e))}return P.value.length>0&&(t=t.filter(e=>P.value.includes(e.type))),C.value.length>0&&(t=t.filter(e=>{const n=i.providerManifests[e.domain];return n&&C.value.includes(n.stage)})),t.sort((e,n)=>{const r=T(e.type)-T(n.type);return r!==0?r:_(e).localeCompare(_(n))})};return(t,e)=>(c(),M(E,null,[V("div",de,[a(ae,{"show-stage-filter":"","onUpdate:search":e[0]||(e[0]=n=>h.value=n),"onUpdate:types":e[1]||(e[1]=n=>P.value=n),"onUpdate:stages":e[2]||(e[2]=n=>C.value=n)}),a(p,{color:"primary",variant:"outlined",height:"40",class:"add-provider-btn",onClick:e[3]||(e[3]=n=>o(y).push("/settings/addprovider"))},{default:s(()=>[u(m(o(d)("settings.add_provider")),1)]),_:1})]),V("div",ce,m(o(d)("settings.providers_total",[w().length,w().length>1?"s":""])),1),a(se,{variant:"comfortable",class:"mt-4"},{default:s(()=>[a(re,null,{default:s(()=>[(c(!0),M(E,null,j(w(),n=>(c(),v(oe,{key:n.instance_id,cols:"12",md:"6",lg:"4",class:"d-flex"},{default:s(()=>[a(J,{class:"flex-fill rounded-lg","min-height":"200px",onClick:r=>A(n.instance_id)},{prepend:s(()=>[a(ee,{domain:n.domain,size:50,class:"listitem-media-thumb",style:{"margin-top":"5px","margin-bottom":"5px"}},null,8,["domain"])]),append:s(()=>[o(i).syncTasks.value.filter(r=>r.provider_instance==n.instance_id).length>0?(c(),v(p,{key:0,variant:"text",size:"small",icon:"",title:o(d)("settings.sync_running")},{default:s(()=>[a(f,{color:"grey"},{default:s(()=>[...e[4]||(e[4]=[u(" mdi-sync ",-1)])]),_:1})]),_:1},8,["title"])):I("",!0),n.enabled?n.last_error?(c(),v(p,{key:2,variant:"text",size:"small",icon:"",title:n.last_error},{default:s(()=>[a(f,{color:"red"},{default:s(()=>[...e[6]||(e[6]=[u(" mdi-alert-circle ",-1)])]),_:1})]),_:1},8,["title"])):o(i).providers[n.instance_id]?.available?I("",!0):(c(),v(p,{key:3,variant:"text",size:"small",icon:"",title:o(d)("settings.not_loaded")},{default:s(()=>[a(f,{icon:"mdi-timer-sand"})]),_:1},8,["title"])):(c(),v(p,{key:1,variant:"text",size:"small",icon:"",title:o(d)("settings.provider_disabled")},{default:s(()=>[a(f,{color:"grey"},{default:s(()=>[...e[5]||(e[5]=[u(" mdi-cancel ",-1)])]),_:1})]),_:1},8,["title"])),a(p,{variant:"text",size:"small",icon:"",title:D(n.type)},{default:s(()=>[a(f,{icon:Y(n.type)},null,8,["icon"])]),_:2},1032,["title"]),a(W,{size:"x-small",variant:"flat",class:"mx-1 text-uppercase",color:B(o(i).providerManifests[n.domain]?.stage)},{default:s(()=>[u(m(o(d)(String(o(i).providerManifests[n.domain]?.stage||"").toLowerCase())),1)]),_:2},1032,["color"]),a(p,{icon:"mdi-dots-vertical",size:"small",variant:"text",onClick:Z(r=>R(r,n),["stop"])},null,8,["onClick"])]),default:s(()=>[a(Q,null,{default:s(()=>[u(m(_(n)),1)]),_:2},1024),a(H,{class:K(["provider-description",{"truncated-text":S(o(i).providerManifests[n.domain].description)}])},{default:s(()=>[u(m(o(i).providerManifests[n.domain].description),1)]),_:2},1032,["class"])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]),_:1})],64))}}),xe=le(ue,[["__scopeId","data-v-85ca2635"]]);export{xe as default};
