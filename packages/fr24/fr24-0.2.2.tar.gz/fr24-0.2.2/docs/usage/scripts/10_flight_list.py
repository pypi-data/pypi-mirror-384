# ruff: noqa
# fmt: off
# mypy: disable-error-code="top-level-await, no-redef"
#%%
# --8<-- [start:script0]
from fr24 import FR24, FR24Cache

async def my_list() -> None:
    async with FR24() as fr24:
        result = await fr24.flight_list.fetch(reg="B-LRA", filter_by="historic")
        print(result.to_polars())
        result.write_table(FR24Cache.default())

await my_list()
# --8<-- [end:script0]
#%%
"""
# --8<-- [start:df0]
shape: (10, 15)
┌────────────┬────────┬──────────┬─────────┬───┬────────────┬────────────┬────────────┬────────────┐
│ flight_id  ┆ number ┆ callsign ┆ icao24  ┆ … ┆ ATOD       ┆ STOA       ┆ ETOA       ┆ ATOA       │
│ ---        ┆ ---    ┆ ---      ┆ ---     ┆   ┆ ---        ┆ ---        ┆ ---        ┆ ---        │
│ u64        ┆ str    ┆ str      ┆ u32     ┆   ┆ datetime[m ┆ datetime[m ┆ datetime[m ┆ datetime[m │
│            ┆        ┆          ┆         ┆   ┆ s, UTC]    ┆ s, UTC]    ┆ s, UTC]    ┆ s, UTC]    │
╞════════════╪════════╪══════════╪═════════╪═══╪════════════╪════════════╪════════════╪════════════╡
│ 1011667820 ┆ CX170  ┆ CPA170   ┆ 7867035 ┆ … ┆ 2025-09-20 ┆ 2025-09-20 ┆ null       ┆ 2025-09-21 │
│            ┆        ┆          ┆         ┆   ┆ 16:46:55   ┆ 23:55:00   ┆            ┆ 00:21:13   │
│            ┆        ┆          ┆         ┆   ┆ UTC        ┆ UTC        ┆            ┆ UTC        │
│ 1011554520 ┆ CX171  ┆ CPA171   ┆ 7867035 ┆ … ┆ 2025-09-20 ┆ 2025-09-20 ┆ null       ┆ 2025-09-20 │
│            ┆        ┆          ┆         ┆   ┆ 07:20:40   ┆ 14:40:00   ┆            ┆ 14:21:27   │
│            ┆        ┆          ┆         ┆   ┆ UTC        ┆ UTC        ┆            ┆ UTC        │
│ 1011435329 ┆ CX648  ┆ CPA648   ┆ 7867035 ┆ … ┆ 2025-09-19 ┆ 2025-09-20 ┆ null       ┆ 2025-09-20 │
│            ┆        ┆          ┆         ┆   ┆ 18:23:36   ┆ 02:55:00   ┆            ┆ 02:52:15   │
│            ┆        ┆          ┆         ┆   ┆ UTC        ┆ UTC        ┆            ┆ UTC        │
│ 1011284495 ┆ CX647  ┆ CPA647   ┆ 7867035 ┆ … ┆ 2025-09-19 ┆ 2025-09-19 ┆ null       ┆ 2025-09-19 │
│            ┆        ┆          ┆         ┆   ┆ 07:20:48   ┆ 16:10:00   ┆            ┆ 15:42:45   │
│            ┆        ┆          ┆         ┆   ┆ UTC        ┆ UTC        ┆            ┆ UTC        │
│ 1011171753 ┆ CX648  ┆ CPA648   ┆ 7867035 ┆ … ┆ 2025-09-18 ┆ 2025-09-19 ┆ null       ┆ 2025-09-19 │
│            ┆        ┆          ┆         ┆   ┆ 19:38:57   ┆ 04:05:00   ┆            ┆ 03:59:35   │
│            ┆        ┆          ┆         ┆   ┆ UTC        ┆ UTC        ┆            ┆ UTC        │
│ 1011026581 ┆ CX647  ┆ CPA647   ┆ 7867035 ┆ … ┆ 2025-09-18 ┆ 2025-09-18 ┆ null       ┆ 2025-09-18 │
│            ┆        ┆          ┆         ┆   ┆ 09:07:57   ┆ 17:25:00   ┆            ┆ 17:44:23   │
│            ┆        ┆          ┆         ┆   ┆ UTC        ┆ UTC        ┆            ┆ UTC        │
│ 1010931855 ┆ CX110  ┆ CPA110   ┆ 7867035 ┆ … ┆ 2025-09-17 ┆ 2025-09-18 ┆ null       ┆ 2025-09-18 │
│            ┆        ┆          ┆         ┆   ┆ 22:11:58   ┆ 07:15:00   ┆            ┆ 06:51:33   │
│            ┆        ┆          ┆         ┆   ┆ UTC        ┆ UTC        ┆            ┆ UTC        │
│ 1010788305 ┆ CX111  ┆ CPA111   ┆ 7867035 ┆ … ┆ 2025-09-17 ┆ 2025-09-17 ┆ null       ┆ 2025-09-17 │
│            ┆        ┆          ┆         ┆   ┆ 11:44:15   ┆ 20:10:00   ┆            ┆ 20:34:57   │
│            ┆        ┆          ┆         ┆   ┆ UTC        ┆ UTC        ┆            ┆ UTC        │
│ 1010538830 ┆ CX300  ┆ CPA300   ┆ 7867035 ┆ … ┆ 2025-09-16 ┆ 2025-09-16 ┆ null       ┆ 2025-09-16 │
│            ┆        ┆          ┆         ┆   ┆ 12:53:57   ┆ 22:50:00   ┆            ┆ 23:01:10   │
│            ┆        ┆          ┆         ┆   ┆ UTC        ┆ UTC        ┆            ┆ UTC        │
│ 1010340276 ┆ CX301  ┆ CPA301   ┆ 7867035 ┆ … ┆ 2025-09-15 ┆ 2025-09-16 ┆ null       ┆ 2025-09-16 │
│            ┆        ┆          ┆         ┆   ┆ 17:30:58   ┆ 05:55:00   ┆            ┆ 06:24:16   │
│            ┆        ┆          ┆         ┆   ┆ UTC        ┆ UTC        ┆            ┆ UTC        │
└────────────┴────────┴──────────┴─────────┴───┴────────────┴────────────┴────────────┴────────────┘
# --8<-- [end:df0]
"""
# %%
# --8<-- [start:script1]
from fr24 import FR24, FR24Cache

cache = FR24Cache.default()

async def my_full_list() -> None:
    async with FR24() as fr24:
        results = fr24.flight_list.new_result_collection()  # (1)!
        async for result in fr24.flight_list.fetch_all(reg="B-LRA"):
            results.append(result)  # (2)!
            if input() == "x":
                break
            results.write_table(cache)
        print(results.to_polars()) # (3)!

await my_full_list()
# --8<-- [end:script1]
#%%
"""
# --8<-- [start:df1]
shape: (22, 15)
┌───────────┬────────┬──────────┬─────────┬───┬─────────────┬────────────┬────────────┬────────────┐
│ flight_id ┆ number ┆ callsign ┆ icao24  ┆ … ┆ ATOD        ┆ STOA       ┆ ETOA       ┆ ATOA       │
│ ---       ┆ ---    ┆ ---      ┆ ---     ┆   ┆ ---         ┆ ---        ┆ ---        ┆ ---        │
│ u64       ┆ str    ┆ str      ┆ u32     ┆   ┆ datetime[ms ┆ datetime[m ┆ datetime[m ┆ datetime[m │
│           ┆        ┆          ┆         ┆   ┆ , UTC]      ┆ s, UTC]    ┆ s, UTC]    ┆ s, UTC]    │
╞═══════════╪════════╪══════════╪═════════╪═══╪═════════════╪════════════╪════════════╪════════════╡
│ 952283415 ┆ CX382  ┆ CPA382   ┆ 7867035 ┆ … ┆ 2025-01-17  ┆ 2025-01-17 ┆ null       ┆ 2025-01-17 │
│           ┆        ┆          ┆         ┆   ┆ 11:14:41    ┆ 22:25:00   ┆            ┆ 22:15:37   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 952264050 ┆ CX383  ┆ CPA383   ┆ 7867035 ┆ … ┆ null        ┆ null       ┆ null       ┆ null       │
│ 952125211 ┆ CX383  ┆ CPA383   ┆ 7867035 ┆ … ┆ 2025-01-16  ┆ 2025-01-17 ┆ null       ┆ 2025-01-17 │
│           ┆        ┆          ┆         ┆   ┆ 17:57:05    ┆ 06:30:00   ┆            ┆ 06:53:54   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 951961210 ┆ CX710  ┆ CPA710   ┆ 7867035 ┆ … ┆ 2025-01-16  ┆ 2025-01-16 ┆ null       ┆ 2025-01-16 │
│           ┆        ┆          ┆         ┆   ┆ 00:15:55    ┆ 03:55:00   ┆            ┆ 03:38:15   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 951777224 ┆ CX735  ┆ CPA735   ┆ 7867035 ┆ … ┆ 2025-01-15  ┆ 2025-01-15 ┆ null       ┆ 2025-01-15 │
│           ┆        ┆          ┆         ┆   ┆ 06:44:49    ┆ 10:25:00   ┆            ┆ 10:31:32   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ …         ┆ …      ┆ …        ┆ …       ┆ … ┆ …           ┆ …          ┆ …          ┆ …          │
│ 951229708 ┆ CX624  ┆ CPA624   ┆ 7867035 ┆ … ┆ 2025-01-12  ┆ 2025-01-13 ┆ null       ┆ 2025-01-13 │
│           ┆        ┆          ┆         ┆   ┆ 20:15:14    ┆ 01:30:00   ┆            ┆ 00:59:37   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 951146643 ┆ CX623  ┆ CPA623   ┆ 7867035 ┆ … ┆ 2025-01-12  ┆ 2025-01-12 ┆ null       ┆ 2025-01-12 │
│           ┆        ┆          ┆         ┆   ┆ 12:57:58    ┆ 18:55:00   ┆            ┆ 18:23:19   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 951012767 ┆ CX714  ┆ CPA714   ┆ 7867035 ┆ … ┆ 2025-01-11  ┆ 2025-01-11 ┆ null       ┆ 2025-01-11 │
│           ┆        ┆          ┆         ┆   ┆ 18:55:20    ┆ 21:10:00   ┆            ┆ 22:05:36   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 950956719 ┆ CX715  ┆ CPA715   ┆ 7867035 ┆ … ┆ 2025-01-11  ┆ 2025-01-11 ┆ null       ┆ 2025-01-11 │
│           ┆        ┆          ┆         ┆   ┆ 13:03:44    ┆ 16:25:00   ┆            ┆ 16:29:15   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
│ 950873921 ┆ CX162  ┆ CPA162   ┆ 7867035 ┆ … ┆ 2025-01-11  ┆ 2025-01-11 ┆ null       ┆ 2025-01-11 │
│           ┆        ┆          ┆         ┆   ┆ 01:09:49    ┆ 09:30:00   ┆            ┆ 09:41:27   │
│           ┆        ┆          ┆         ┆   ┆ UTC         ┆ UTC        ┆            ┆ UTC        │
└───────────┴────────┴──────────┴─────────┴───┴─────────────┴────────────┴────────────┴────────────┘

# --8<-- [end:df1]
"""
