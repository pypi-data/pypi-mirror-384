import{a as I}from"./D5w4xp5l.js";import{w as s,m as g}from"./Frwd2CjB.js";function d(n,o){const i=s((()=>{if(typeof sessionStorage>"u")return o;try{const a=sessionStorage.getItem(n);if(a)return JSON.parse(a)}catch(a){console.warn(`Failed to read ${n} from sessionStorage`,a)}return o})());return i.subscribe(a=>{if(!(typeof sessionStorage>"u"))try{sessionStorage.setItem(n,JSON.stringify(a))}catch(h){console.warn(`Failed to write ${n} to sessionStorage`,h)}}),i}const r=s([]),B=()=>({reversibleActions:r,addReversibleAction:n=>{r.update(o=>[n,...o].slice(0,50))},executeReversibleAction:async n=>{const o=g(r),l=o.find(i=>i.id===n);if(l){await l.execute();const i=o.findIndex(a=>a.id===n);r.update(a=>a.slice(i+1))}},clearReversibleActions:()=>{r.set([])},clearReversibleActionsByGroupId:n=>{r.update(o=>o.filter(l=>l.groupId!==n))},hasReversibleActions:()=>g(r).length>0}),b=s("samples"),u=s(new Set),p=s(new Set),S=s(new Set),w=s(0),v=s(0),y=s(!1),C=s(void 0),f=s(null),_=d("lightlyStudio_sampleSize",{width:200,height:200}),T=d("lightlyStudio_metadata_bounds",{}),x=d("lightlyStudio_metadata_values",{}),M=d("lightlyStudio_metadata_info",[]),G=s(void 0),V=s([]),m=s({}),z=s(!1),D=n=>{z.set(n)},R=s(!1),N=()=>{const n=B();return{tags:G,textEmbedding:C,setTextEmbedding:e=>{C.set(e)},selectedSampleIds:u,selectedSampleAnnotationCropIds:p,selectedAnnotationFilterIds:S,annotationsTotalCount:w,samplesTotalCount:v,datasetVersions:m,hideAnnotations:y,classifiers:V,classifierSamples:f,setClassifierSamples:e=>{f.set(e)},clearClassifierSamples:()=>{f.set(null)},metadataBounds:T,metadataValues:x,metadataInfo:M,updateMetadataValues:e=>{x.set(e)},updateMetadataBounds:e=>{T.set(e)},updateMetadataInfo:e=>{M.set(e)},setHideAnnotations:e=>{y.set(e)},getDatasetVersion:async e=>{const t=g(m);if(t[e])return t[e];const{data:c}=await I({path:{dataset_id:e}});if(c!=null&&c.created_at){const A=new Date(c.created_at).getTime().toString();return m.update(E=>({...E,[e]:A})),A}return""},toggleSampleSelection:e=>{u.update(t=>(t.has(e)?t.delete(e):t.add(e),t))},clearSelectedSamples:()=>{u.update(e=>(e.clear(),e))},toggleSampleAnnotationCropSelection:e=>{p.update(t=>(t.has(e)?t.delete(e):t.add(e),t))},clearSelectedSampleAnnotationCrops:()=>{p.update(e=>(e.clear(),e))},lastGridType:b,setLastGridType:e=>{b.set(e)},setSelectedAnnotationFilterIds:e=>{S.update(t=>(t.has(e)?t.delete(e):t.add(e),t))},clearSelectedAnnotationFilterIds:()=>{S.update(e=>(e.clear(),e))},setAnnotationsTotalCount:e=>{w.set(e)},setSamplesTotalCount:e=>{v.set(e)},sampleSize:_,updateSampleSize:e=>{_.set({width:e,height:e})},isEditingMode:z,setIsEditingMode:D,showPlot:R,setShowPlot:e=>{R.set(e)},...n}};export{d as a,N as u};
