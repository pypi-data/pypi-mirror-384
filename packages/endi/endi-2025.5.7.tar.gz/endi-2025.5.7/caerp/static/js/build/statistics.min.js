var statistics;(()=>{var e,t={29963:(e,t,i)=>{"use strict";var n=i(74692),o=i.n(n),l=i(74125),s=i.n(l),r=i(83719),a=i(21391),c=i.n(a),d=i(78603),h=i.n(d);const u=i(33588).A.extend({appRoutes:{index:"index","":"index",addentry:"addEntry","editentry/:id":"editEntryMainData","entries/:id":"editEntry"}});var p=i(92022),m=i(35804),f=i.n(m),g=(i(62125),i(83200));const v=h().View.extend({tagName:"tr",template:g,regions:{},ui:{edit:"button.edit",delete:"button.delete",csv_export:"button.csv_export",duplicate:"button.duplicate"},triggers:{"click @ui.edit":"model:edit","click @ui.delete":"model:delete","click @ui.csv_export":"model:export","click @ui.duplicate":"model:duplicate"},childViewEvents:{},childViewTriggers:{},initialize:function(){this.config=f().channel("config"),this.facade=f().channel("facade")}});var w=i(98395);const y=h().View.extend({template:w}),b=h().CollectionView.extend({childView:v,emptyView:y,tagName:"tbody",childViewTriggers:{"model:edit":"model:edit","model:delete":"model:delete","model:export":"model:export","model:duplicate":"model:duplicate"},initialize:function(){this.config=f().channel("config"),this.facade=f().channel("facade")}});var _=i(45652);const C=h().View.extend({template:_,regions:{list:{el:"tbody",replaceElement:!0}},childViewEvents:{"model:edit":"onModelEdit","model:delete":"onModelDelete","model:export":"onModelExport","model:duplicate":"onModelDuplicate"},childViewTriggers:{},initialize:function(){this.config=f().channel("config"),this.app=f().channel("app")},onRender:function(){this.showChildView("list",new b({collection:this.collection}))},onModelEdit:function(e){console.log("onModelEdit "+e.model.get("id")),this.app.trigger("navigate","/entries/"+e.model.get("id"))},onModelDelete:function(e){this.app.trigger("entry:delete",e)},onModelExport:function(e){this.app.trigger("entry:export",e.model)},onModelDuplicate:function(e){console.log("Duplicate"),this.app.trigger("entry:duplicate",e.model)}});var x,A=i(54091),k=i(70015),V=i(64467),E=i(89394),S=i(64996),D=i(29179),M=i(89919);const O=h().View.extend((x={template:M,className:"main_content",behaviors:[S.A]},(0,V.A)((0,V.A)((0,V.A)((0,V.A)((0,V.A)((0,V.A)((0,V.A)((0,V.A)((0,V.A)((0,V.A)(x,"template",M),"regions",{entityField:".field-entity",keyField:".field-key"}),"ui",{form:"form",submit:"button[type=submit]",reset:"button[type=reset]"}),"events",{"submit @ui.form":"onSubmitForm","click @ui.reset":"onCancelClick","click @ui.submit":"onSubmitForm"}),"childViewEvents",{"finish:relationship":"onRelationshipFinish"}),"childViewTriggers",{}),"initialize",(function(e){this.statService=f().channel("stat"),this.facade=f().channel("facade"),this.mergeOptions(e,["attributePath","parentPath"]),console.log("Add Criterion form"),console.log("Attribute tree path"),console.log(this.attributePath),console.log(this.parentPath)})),"getFieldValue",(function(e){var t,i=(0,p.n_)(this.getUI("form"));return e in i&&(t=i[e]),t})),"getPath",(function(e){e||(e=this.parentPath||this.getFieldValue("relationship"));var t=(0,E.A)(this.attributePath);return e&&t.push(e),t})),"onSubmitForm",(function(e){e.preventDefault(),console.log("Submitting");var t=(0,p.n_)(this.getUI("form")),i=t.key,n=this.getPath();console.log("   Path of the current model %s",n);var o=this.statService.request("find:column",i,n);this.model.set(t),console.log(this.model.attributes),this.model.set(o),console.log(this.model.attributes),this.facade.trigger("criterion:add",this.model),this.trigger("modal:close")})),(0,V.A)((0,V.A)((0,V.A)((0,V.A)(x,"onCancelClick",(function(){console.log("Cancel clicked"),this.triggerMethod("reset:model"),this.triggerMethod("modal:close")})),"showKeySelect",(function(e){console.log("showKeySelect");var t=this.getPath(e),i=this.statService.request("get:attributes",t);console.log(i);var n=new D.A({options:i,label:"Type de critère",id_key:"name",field_name:"key"});this.showChildView("keyField",n)})),"onRelationshipFinish",(function(e){console.log("onRelationshipFinish"),this.getPath(e),this.model.set("relationship",e),this.showKeySelect(e)})),"onRender",(function(){console.log(this.statService);var e=Object.values(this.statService.request("get:relationships",this.attributePath));console.log(e),e.splice(0,0,{label:"Entité",name:""});var t={options:e,label:"Type de critère",id_key:"name",field_name:"relationship"};this.parentPath&&(console.log(""),t.editable=!1,t.value=this.parentPath);var i=new D.A(t);this.showChildView("entityField",i),this.showKeySelect()}))));var q=i(76004);const F=q.A.extend({props:["id","key","method","type","entry_id","parent_id","relationship"]});var P=i(13658);const T=h().View.extend({template:P,regions:{},ui:{button:"input[type=radio]"},events:{"click @ui.button":"onClick"},modelEvents:{saved:"render"},childViewEvents:{"add:click":"onAddClick"},initialize:function(){this.config=f().channel("config"),this.facade=f().channel("facade")},onAddClick:function(){console.log("CombinationView.onAddClick"),this.trigger("add:click",this.model)},onClick:function(e){var t=e.target.value;this.model.set({type:t}),this.model.save({patch:!0,wait:!0})},templateContext:function(){return{is_and_clause:"and"==this.model.get("type"),is_or_clause:"or"==this.model.get("type")}}});var j=i(82897);const R=h().View.extend({tagName:"li",template:j,regions:{children:{el:".children",replaceElement:!0},combination:".combination"},childViewEvents:{"action:clicked":"onAddClick"},childViewTriggers:{"criterion:delete":"criterion:delete","add:click":"add:click"},initialize:function(){this.config=f().channel("config"),this.facade=f().channel("facade")},templateContext:function(){return{}},onAddClick:function(e){"add"==e&&(console.log("ClauseCriteriaView.onAddClick"),console.log(this.model),this.trigger("add:click",this.model))},showCombination:function(){if(this.model.collection.indexOf(this.model)>=1&&0==this.model.collection.path.length){var e=new T({model:this.model.collection._parent});this.showChildView("combination",e)}},onRender:function(){this.showCombination(),this.model.children.length>0&&this.showChildView("children",new this.__parentclass__({collection:this.model.children,parent:this}))}});var N=i(18111),z=i(77719),L=i(21533);const B=h().View.extend({template:L,tagName:"li",regions:{combination:".combination",selector:".form-group.selector",method:".form-group.method",search1:".form-group.search1",search2:".form-group.search2",deleteButton:{el:".delbutton-container",replaceElement:!0},addButton:".addbutton-container"},ui:{form:"form"},events:{"submit @ui.form":"onFormSubmit"},childViewEvents:{finish:"onFieldSelect","action:clicked":"onActionClicked"},childViewTriggers:{},modelEvents:{saved:"onModelSaved"},initialize:function(){this.config=f().channel("config"),this.facade=f().channel("facade"),this.service=f().channel("stat"),this.attributes=this.service.request("get:attributes",this.model)},templateContext:function(){return{label:this.service.request("find:label",this.model)}},onFormSubmit:function(e){e.preventDefault(),document.activeElement.blur()},onActionClicked:function(e){console.log("CommonCriteriaView.onActionClicked '%s'",e),"add"==e?this.triggerMethod("add:click",this.model):"delete"==e&&this.triggerMethod("criterion:delete",this.model)},onModelSaved:function(e){},showSelector:function(){var e=new D.A({title:"Champ",options:this.attributes,id_key:"name",value:this.model.get("key"),field_name:"key"});this.showChildView("selector",e)},showMethod:function(){console.log("showMethod"),console.log(this.model);var e=this.service.request("find:methods",this.model.get("type")),t=!1;this.model.get("method")||(t=!0);var i=new D.A({title:"Filtre",options:e,value:this.model.get("method"),field_name:"method",placeholder:t?"":void 0});this.showChildView("method",i)},_showStaticOptFields:function(){var e=this.service.request("find:static_options",this.model.get("key")),t=new D.A({title:"Valeur",value:this.model.get("searches"),field_name:"searches",options:e,placeholder:"",multiple:!0});this.showChildView("search1",t)},_showManyToOneFields:function(){var e=this.service.request("find:manytoone_options",this.model.get("key")),t=new D.A({title:"Valeur",value:this.model.get("searches"),field_name:"searches",options:e,placeholder:"",multiple:!0});this.showChildView("search1",t)},_showStringField:function(){var e=new z.A({title:"Libellé",value:this.model.get("search1"),field_name:"search1"});this.showChildView("search1",e)},_showNumberField:function(){var e=this.model.get("method"),t="Valeur à comparer";["bw","nbw"].includes(e)&&(t="Entre");var i=new z.A({title:"",ariaLabel:t,value:this.model.get("search1"),field_name:"search1"});if(this.showChildView("search1",i),["bw","nbw"].includes(e)){var n=new z.A({title:"Et",value:this.model.get("search2"),field_name:"search2"});this.showChildView("search2",n)}},_showDateField:function(){var e=this.model.get("method");if(["dr","ndr"].includes(e)){var t=new N.A({title:"Entre le",value:this.model.get("date_search1"),field_name:"date_search1"});this.showChildView("search1",t);var i=new N.A({title:"Et le",value:this.model.get("date_search2"),field_name:"date_search2"});this.showChildView("search2",i)}},showSearches:function(){if(this.detachChildView("search1"),this.detachChildView("search2"),this.model.get("method")&&!["nll","nnll"].includes(this.model.get("method"))){var e=this.model.get("type");"static_opt"==e?this._showStaticOptFields():"manytoone"==e?this._showManyToOneFields():"string"==e?this._showStringField():"number"==e?this._showNumberField():"date"==e&&this._showDateField()}},onFieldSelect:function(e,t){var i=this;if(this.model.get(e)!=t){var n,o={};if(o[e]=t,"key"==e){var l=this.attributes[t];o.type=l.type,n=function(){i.showMethod(),i.showFields()}}else"method"==e&&(n=function(){i.showFields()});this.model.save(o,{wait:!0,patch:!0,success:n})}},showFields:function(){this.showSelector(),this.showMethod(),this.showSearches()},showButtons:function(){var e=new A.A({label:"Supprimer",showLabel:!1,action:"delete",icon:"trash-alt"}),t=new k.A({model:e,surroundingTagName:"div",surroundingCss:"actions"});if(this.showChildView("deleteButton",t),0==this.model.collection.path&&this.model.collection.length>1){var i=new A.A({label:"Ajouter un critère à ce niveau de la hiérarchie",showLabel:!1,icon:"plus",action:"add"}),n=new k.A({model:i,surroundingTagName:"div",surroundingCss:"actions"});this.showChildView("addButton",n)}else this.$el.find("ul").hide()},showCombination:function(){if(this.model.collection.indexOf(this.model)>=1&&0==this.model.collection.path.length){var e=new T({model:this.model.collection._parent});this.showChildView("combination",e)}},onRender:function(){this.showButtons(),this.showCombination(),this.showFields()}});var I=i(99630),U={string:B,date:B,multidate:B,number:B,static_opt:B,bool:B,manytoone:B,or:R,and:R,onetomany:h().View.extend({tagName:"li",template:I,regions:{children:{el:".children",replaceElement:!0},combination:".combination",deleteButton:{el:".delbutton-container",replaceElement:!0}},childViewEvents:{"add:click":"onAddClick","action:clicked":"onActionClicked"},childViewTriggers:{"criterion:delete":"criterion:delete"},initialize:function(){this.config=f().channel("config"),this.facade=f().channel("facade"),this.statService=f().channel("stat"),this.relationshipConfig=this.statService.request("find:column",this.model.get("key"),this.model.collection.path),console.log(this.relationshipConfig)},onAddClick:function(){console.log("ClauseCriteriaView.onAddClick"),console.log(this.model),this.trigger("add:click",this.model)},onActionClicked:function(e){console.log("OneToMany.onActionClicked"),"delete"==e?this.trigger("criterion:delete",this.model):"add"==e&&this.trigger("add:click",this.model)},templateContext:function(){return{label:this.relationshipConfig.label}},showButtons:function(){var e=new A.A({label:"Supprimer",showLabel:!1,action:"delete",icon:"trash-alt"}),t=new k.A({model:e,surroundingTagName:"div",surroundingCss:"actions"});this.showChildView("deleteButton",t)},onRender:function(){if(this.showButtons(),console.log(this.model),this.model.collection.indexOf(this.model)>=1&&0==this.model.collection.path.length){var e=new T({model:this.model.collection._parent});this.showChildView("combination",e)}this.model.children.length>0&&this.showChildView("children",new this.__parentclass__({collection:this.model.children,parent:this}))}})},$=h().View.extend({template:s().template("<div></div>")}),K=h().CollectionView.extend({tagName:"ul",emptyView:$,childViewTriggers:{"action:clicked":"action:clicked","add:click":"add:click","criterion:delete":"criterion:delete"},collectionEvents:{fetch:"render"},initialize:function(){this.config=f().channel("config"),this.facade=f().channel("facade")},childView:function(e){var t=U[e.get("type")];return t.prototype.__parentclass__=K,t},onRender:function(){var e=new A.A({label:"Ajouter un critère à ce niveau de la hiérarchie",showLabel:!1,icon:"plus",event:"add:click"}),t=new k.A({model:e,surroundingTagName:"li"});console.log("Add the add button to the collection view"),this.addChildView(t,this.children.length)}});const J=K;var Q=i(4765);const Y=h().View.extend({template:Q,regions:{editButton:{el:".edit-btn-container",replaceElement:!0},criteria:".criteria-container",popup:".popup"},childViewEvents:{"edit:entry:click":"onEditClicked","add:click":"onAddClicked","criterion:delete":"onCriterionDelete"},initialize:function(e){this.config=f().channel("config"),this.facade=f().channel("facade"),this.listenTo(this.facade,"criterion:added",this.renderList.bind(this)),console.log(e),this.mergeOptions(e,["criteriaCollection"]),console.log(this.criteriaCollection)},onButtonClicked:function(e){"editentry"==e?this.onEditClicked():this.onAddClicked(this.getRootCriterion())},onEditClicked:function(){f().channel("app").trigger("navigate","editentry/"+this.model.get("id"))},getRootCriterion:function(){return this.criteriaCollection.models[0]},onAddClicked:function(e){console.log("EntryFormComponent"),e=e||this.getRootCriterion();var t,i=new F({parent_id:e.get("id"),entry_id:this.model.get("id")});"onetomany"===e.get("type")&&(t=e.get("key"));var n=new O({model:i,attributePath:e.collection.path,parentPath:t});this.showChildView("popup",n)},onCriterionDelete:function(e){var t=this;window.confirm("Êtes-vous sûr de vouloir supprimer cet élément ?")&&e.destroy({wait:!0,success:function(){return t.criteriaCollection.fetch({reset:!0,success:function(){return t.render()}})}})},renderList:function(){this.showChildView("criteria",new J({collection:this.getRootCriterion().children}))},renderAddButton:function(){var e=new A.A({label:"Nouveau critère",css:"btn icon",icon:"plus",event:"add:click"}),t=new k.A({model:e});this.showChildView("criteria",t)},onRender:function(){this.showChildView("editButton",new k.A({model:new A.A({label:"edit",showLabel:!1,css:"btn icon only unstyled",icon:"pen",event:"edit:entry:click"})})),this.getRootCriterion().children.length>0?this.renderList():this.renderAddButton()}});var G=i(90201),H=i(49083),W=i(62353),X=i(1102);const Z=h().View.extend({template:X,className:"main_content",behaviors:[H.A],regions:{title:".field-title",description:".field-description"},initialize:function(){this.config=f().channel("config")},onSuccessSync:function(){f().channel("app").trigger("navigate","entries/"+this.model.get("id"))},onCancelForm:function(){var e=f().channel("app");this.getOption("add")?e.trigger("navigate","index"):e.trigger("navigate","entries/"+this.model.get("id"))},templateContext:function(){return{title:this.getOption("add")?"Ajouter une entrée statistique":"Modifier une entrée statistique"}},onRender:function(){console.log(this.model),this.showChildView("title",new z.A({field_name:"title",label:"Intitulé de l'entrée statistique",description:"Intitulé de l'entrée statistique tel qu'il figurera dans l'export",required:!0,value:this.model.get("title")})),this.showChildView("description",new W.A({field_name:"description",label:"Description de l'entrée statistique",description:"Description de l'entrée statistique tel qu'elle figurera dans l'export",value:this.model.get("description"),required:!1}))}});var ee=i(47800),te=h().View.extend({template:s().template('<div class="alert alert-error"><%- message %></div>'),templateContext:function(){return{message:this.getOption("message")}}});const ie=h().View.extend({behaviors:[S.A],template:ee,regions:{message:".message-container",sheets:".field-sheets"},ui:{form:"form",submit:"button[type=submit]",cancel:"button[type=reset]"},events:{"click @ui.submit":"onSubmit","submit @ui.form":"onSubmit","click @ui.cancel":"onCancelForm"},childViewEvents:{},childViewTriggers:{},initialize:function(){this.config=f().channel("config"),this.facade=f().channel("facade")},onSubmit:function(e){var t=this;e.preventDefault();var i=this.getChildView("sheets").getCurrentValue();i?this.facade.request("entry:duplicate",this.model,i).then((function(){return t.onSuccessSync()})):this.showChildView("message",new te({message:"Veuillez choisir une feuille statistiques"}))},onSuccessSync:function(){this.triggerMethod("modal:close")},onCancelForm:function(){this.triggerMethod("modal:close")},templateContext:function(){return{title:"Dupliquer l'entrée statistique "+this.model.get("title")}},onRender:function(){this.showChildView("sheets",new D.A({label:"Vers la feuille de statistiques",options:this.getOption("sheets"),field_name:"sheet",required:!0,id_key:"id",label_key:"title",placeholder:""}))}}),ne=h().View.extend({template:i(28998),regions:{toolbar:"#toolbar",main:"#main",popup:".entry-popup"},initialize:function(){this.facade=f().channel("facade"),this.config=f().channel("config"),this.app=f().channel("app")},_showSheetToolbar:function(){var e=this.config.request("get:form_actions");e.main=[{option:{url:"#addentry",label:"Ajouter une entrée",icon:"plus",title:"Ajouter une entrée statistiques",css:"btn btn-primary icon"},widget:"anchor"}];var t=new G.A(e);this.showChildView("toolbar",t)},_triggerEntryDelete:function(e){console.log("Trigger entry delete"),this.app.trigger("entry:delete",this.getChildView("main"))},_showEntryToolbar:function(e){var t=this,i={main:[{option:{label:"Revenir à la liste",icon:"arrow-left",title:"Revenir à la liste des entrées",url:"#index",css:"btn icon"},widget:"anchor"}],more:[{option:{icon:"copy",title:"Dupliquer cette entrée statistiques",onclick:function(i){return t.app.trigger("entry:duplicate",e)},css:"btn icon only"},widget:"button"},{option:{icon:"file-csv",title:"Exporter les données de gestion sociale associée à cette entrée",onclick:function(i){return t.app.trigger("entry:export",e)},css:"btn icon only"},widget:"button"},{option:{icon:"trash-alt",title:"Supprimer cette entrée statistiques",onclick:function(e){return t._triggerEntryDelete(e)},css:"btn icon only"},widget:"button"}]};console.log("Show entry toolbar"),console.log(i);var n=new G.A(i);this.showChildView("toolbar",n)},showEntryDuplicateForm:function(e){var t=this.config.request("get:options","sheet_list"),i=new ie({model:e,sheets:t});this.showChildView("popup",i)},_showEntryAdd:function(e,t){var i=new Z({model:e,destCollection:t,add:!0});this.showChildView("main",i)},_showEntryEditMainData:function(e,t){var i=new Z({model:e,destCollection:t,add:!1});this.showChildView("main",i)},_showEntryEdit:function(e,t){var i=new Y({model:e,criteriaCollection:t});this.showChildView("main",i)},_showEntryList:function(){var e=this.facade.request("get:collection","entries"),t=new C({collection:e});this.showChildView("main",t)},entryAdd:function(e,t){this._showEntryAdd(e,t)},entryEdit:function(e,t){this._showEntryToolbar(e),this._showEntryEdit(e,t)},entryEditMainData:function(e,t){this._showEntryEditMainData(e,t)},index:function(){console.log("Index view"),this._showSheetToolbar(),this._showEntryList()}}),oe=q.A.extend({props:["id","title","description","sheet_id","criteria"],defaults:{criteria:[]},validation:{title:{required:!0,msg:"est requis"}},exportUrl:function(){return"/statistics/entries/"+this.get("id")+".csv"},criteria_url:function(){return this.url()+"/criteria"},duplicateUrl:function(){return this.url()+"?action=duplicate"}}),le=h().Object.extend({initialize:function(e){this.facade=f().channel("facade"),this.config=f().channel("config"),this.app=f().channel("app"),console.log("Controller.initialize"),this.rootView=e.rootView,this.productDefaults=this.config.request("get:options","defaults")},index:function(){console.log("Controller.index"),this.rootView.index()},showModal:function(e){this.rootView.showModal(e)},editEntry:function(e){var t=this,i=this.facade.request("get:entry",e);(0,p.ro)(),this.facade.request("load:criteria",i).then((function(e){(0,p.yr)(),t.rootView.entryEdit(i,e)}))},addEntry:function(){var e=this.facade.request("get:collection","entries"),t=new oe;this.rootView.entryAdd(t,e)},editEntryMainData:function(e){var t=this.facade.request("get:collection","entries"),i=t.get(e);this.rootView.entryEditMainData(i,t)},showEntryExport:function(e){var t=e.exportUrl();window.openPopup(t)},showEntryDuplicate:function(e){this.rootView.showEntryDuplicateForm(e)},_onModelDeleteSuccess:function(){f().channel("message").trigger("success",this,"Vos données ont bien été supprimées"),this.app.trigger("navigate","index")},_onModelDeleteError:function(){f().channel("message").trigger("error",this,"Une erreur a été rencontrée lors de la suppression de cet élément")},modelDelete:function(e){console.log("Controller.modelDelete"),window.confirm("Êtes-vous sûr de vouloir supprimer cet élément ?")&&e.model.destroy({success:this._onModelDeleteSuccess.bind(this),error:this._onModelDeleteError.bind(this),wait:!0})}});var se=i(74125);const re=new(h().Application.extend({channelName:"app",radioEvents:{navigate:"onNavigate","show:modal":"onShowModal","entry:delete":"onDelete","entry:export":"onEntryExport","entry:duplicate":"onEntryDuplicate","criterion:delete":"onDelete"},region:"#js-main-area",onBeforeStart:function(e,t){console.log(" - AppClass : Initializing UI components"),this.rootView=new ne,this.controller=new le({rootView:this.rootView}),this.router=new u({controller:this.controller})},onStart:function(e,t){this.showView(this.rootView),console.log(" - AppClass : Starting the js history"),(0,p.yr)(),c().history.start()},onEntryExport:function(e){this.controller.showEntryExport(e)},onEntryDuplicate:function(e){this.controller.showEntryDuplicate(e)},onNavigate:function(e,t){console.log(" - AppClass.onNavigate : %s",e);var i=e;se.isUndefined(t)||(i+="/"+t),window.location.hash=i,c().history.loadUrl(i)},onShowModal:function(e){this.controller.showModal(e)},onDelete:function(e){this.controller.modelDelete(e)}}));var ae=i(66536),ce=i(74692);function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}const he=new(h().Object.extend({channelName:"stat",radioRequests:{"find:column":"findModelColumn","find:methods":"findMethods","get:attributes":"_getAttributes","get:relationships":"_getRelationships","find:static_options":"findStaticOptions","find:manytoone_options":"findManyToOneOptions"},_getColumnLevel:function(e){var t=[];if(console.log("Looking for column level informations"),console.log(e),Array.isArray(e))t=e;else{var i=e;i&&i.collection&&i.collection.path&&(t=i.collection.path)}var n=this.columns;t?Array.isArray(t)||(t=[t]):t=[];var o,l=function(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return de(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?de(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,s=!0,r=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return s=e.done,e},e:function(e){r=!0,l=e},f:function(){try{s||null==i.return||i.return()}finally{if(r)throw l}}}}(t);try{for(l.s();!(o=l.n()).done;)parent=o.value,n=n.relationships[parent]}catch(e){l.e(e)}finally{l.f()}return n},_clone:function(e){return JSON.parse(JSON.stringify(e))},_getAttributes:function(e){var t=this._getColumnLevel(e);return this._clone(t.attributes)},_getRelationships:function(e){var t=this._getColumnLevel(e);return this._clone(t.relationships)},findModelColumn:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];console.log("Find the model for a given column %s %s",e,t);var i,n=this._getColumnLevel(t);return e in n.attributes?i=n.attributes[e]:n.relationships&&e in n.relationships?i=n.relationships[e]:console.error("Erreur, il y a des anciennes options statistiques qui ne sont plus supportées %s",e),console.log(i),this._clone(i)},findMethods:function(e){return this._clone(this.form_config.options.methods[e])},findStaticOptions:function(e){return this._clone(this.form_config.options.static_opt_options[e])},findManyToOneOptions:function(e){return this._clone(this.form_config.options.manytoone_options[e])},setFormConfig:function(e){this.form_config=e,this.columns=e.options.columns},setup:function(e){},start:function(){this.setFormConfig(ae.A.form_config);var e=ce.Deferred();return e.resolve(ae.A.form_config,null,null),e}})),ue=c().Model.extend({validation:{title:{required:!0,msg:"est requis"}},exportUrl:function(){return this.url()+".csv"}});var pe=i(46174);const me=c().Collection.extend({model:oe});var fe=F.extend({props:["searches","search1","search2","date_search1","date_search2"]});fe.prototype.props=fe.prototype.props.concat(F.prototype.props);const ge=fe;var ve=F.extend({props:["children"],initialize:function(){this.populate()},populate:function(){if(this.has("children")){var e=this.collection.path.concat([]);this.has("key")&&e.push(this.get("key")),this.children=new this.collection.__class__(this.get("children"),{path:e,url:this.collection.url})}this.children._parent=this,this.children.url=this.collection.url}});ve.prototype.props=ve.prototype.props.concat(F.prototype.props);const we=ve;var ye=we.extend({}),be={manytoone:ge,static_opt:ge,or:we,and:we,onetomany:ye,bool:ge,string:ge,date:ge,multidate:ge,number:ge},_e=c().Collection.extend({initialize:function(e,t){t=t||{},this.path="path"in t?t.path:[],"url"in t&&(this.url=t.url)},model:function(e,t){var i=e.type;return!i in be&&console.error("Unknown model typ %s",i),new be[i](e,t)}});_e.prototype.__class__=_e;const Ce=_e;var xe=i(74692);const Ae=new(h().Object.extend(pe.A).extend({radioEvents:{"criterion:add":"onAddCriterion"},radioRequests:{"get:model":"getModelRequest","get:collection":"getCollectionRequest","get:entry":"getEntry","load:collection":"loadCollection","is:valid":"isDatasValid","load:criteria":"loadCriteriaCollection","entry:duplicate":"onEntryDuplicate"},initialize:function(e){var t;this.models={},this.models.sheet=new ue({}),this.collections={},t=new me,this.collections.entries=t},setup:function(e){this.setModelUrl("sheet",e.context_url),this.setCollectionUrl("entries",e.entries_url)},getEntry:function(e){return console.log(" - Facade : Retrieving entry "+e),this.collections.entries.get(e)},loadCriteriaCollection:function(e){return console.log(" - Facade : Retrieving the criteria defining the entry "+e.get("id")),(this.collections.criteria=new Ce).url=e.criteria_url(),this.loadCollection("criteria")},onAddCriterion:function(e){var t=this;e.url=this.collections.criteria.url;var i=f().channel("facade");e.save({wait:!0,sort:!0}).then((function(e){return t.collections.criteria.fetch({reset:!0,success:function(e){return i.trigger("criterion:added")}})}))},onEntryDuplicate:function(e,t){var i=this,n=parseInt(e.get("sheet_id"))==parseInt(t),o=(0,p.m)(e.duplicateUrl(),{sheet_id:t},"POST");return n&&(o=o.then((function(e){return i.collections.entries.fetch()}))),o},start:function(){var e=this.loadModel("sheet"),t=this.loadCollection("entries");return xe.when(e,t)}}));o()((function(){console.log(" # Page Loaded : starting the js code #"),(0,r.YQ)(AppOption,re,Ae,{customServices:[he]})}))},89919:(e,t,i)=>{var n=i(93633);e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var l,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<section id="work_form" class="size_middle">\n    <form>\n    <div role="dialog" id="work-forms" aria-modal="true" aria-labelledby="work-forms_title">\n        <div class=\'modal_layout\'>\n            <header>\n                <button class="icon only unstyled close" title="Fermer cette fenêtre" aria-label="Fermer cette fenêtre"  type=\'button\'>\n                    <svg><use href="/static/icons/icones.svg#times"></use></svg>\n                </button>\n                <h2>Ajouter un critère</h2>\n            </header>\n            <div class="modal_content_layout">\n                <input type=\'hidden\' name=\'parent_id\' value=\''+e.escapeExpression("function"==typeof(l=null!=(l=s(i,"parent_id")||(null!=t?s(t,"parent_id"):t))?l:e.hooks.helperMissing)?l.call(null!=t?t:e.nullContext||{},{name:"parent_id",hash:{},data:o,loc:{start:{line:12,column:61},end:{line:12,column:74}}}):l)+"' />\n                <div class='modal_content'>\n                    <div class='message-container'></div>\n                    <div class='errors'></div>\n                    <fieldset>\n                        <div class='field-entity'></div>\n                        <div class='field-key'></div>\n                    </fieldset>\n                </div>\n                <footer>\n                    <button\n                        class='btn btn-primary'\n                        type='submit'\n                        value='submit'>\n                        Valider\n                    </button>\n                    <button\n                        class='btn'\n                        type='reset'\n                        value='submit'\n                        title=\"Annuler et fermer cette fenêtre\">\n                        Annuler\n                    </button>\n                </footer>\n            </div>\n        </div>\n    </div>\n    </form>\n</section>\n"},useData:!0})},82897:(e,t,i)=>{var n=i(93633);e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return"<div class='combination'>\n</div>\n<div class='children'>\n</div>"},useData:!0})},13658:(e,t,i)=>{var n=i(93633);e.exports=(n.default||n).template({1:function(e,t,i,n,o){return'                checked="checked" \n'},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var l,s=null!=t?t:e.nullContext||{},r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<fieldset class="icon_choice" title="Combinaison des critères">\n    <div class="layout flex">\n        <h6 class="screen-reader-text">\n            Combinaison des critères\n        </h6>\n        <label>\n            <input \n                type="radio"\n'+(null!=(l=r(i,"if").call(s,null!=t?r(t,"is_and_clause"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:9,column:16},end:{line:11,column:23}}}))?l:"")+'                value=\'and\'\n                class="visuallyhidden">\n            <span>\n                et\n            </span>\n        </label>\n        <label>\n            <input \n                type="radio" \n'+(null!=(l=r(i,"if").call(s,null!=t?r(t,"is_or_clause"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:21,column:16},end:{line:23,column:23}}}))?l:"")+"                value='or'\n                class=\"visuallyhidden\">\n            <span>\n                ou\n            </span>\n        </label>\n    </div>\n</fieldset>"},useData:!0})},21533:(e,t,i)=>{var n=i(93633);e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return"<form>\n    <fieldset>\n        <div class='combination'>\n        </div>\n        <div class='layout flex'>\n        <div class='form-group selector'></div>\n            <div class='form-group method'></div>\n            <div class='form-group search1'></div>\n            <div class='form-group search2'></div>\n        </div>\n    </fieldset>\n    <div class='delbutton-container'></div>\n    <ul><li class='add_line addbutton-container'></li></ul>\n</form>"},useData:!0})},4765:(e,t,i)=>{var n=i(93633);e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var l,s=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,a="function",c=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<div class='tree_view with_actions first_level'>\n   <h1>\n       "+c(typeof(l=null!=(l=d(i,"title")||(null!=t?d(t,"title"):t))?l:r)===a?l.call(s,{name:"title",hash:{},data:o,loc:{start:{line:3,column:7},end:{line:3,column:16}}}):l)+"\n        <span class='edit-btn-container'></span>\n   </h1>\n   <p>"+c(typeof(l=null!=(l=d(i,"description")||(null!=t?d(t,"description"):t))?l:r)===a?l.call(s,{name:"description",hash:{},data:o,loc:{start:{line:6,column:6},end:{line:6,column:21}}}):l)+"</p>\n    <form>\n        <h2 class='title'>Choix des critères</h2>\n        <div class='search_filters content vertical_padding criteria-container'>\n        </div>\n    </form>\n</div>  \n<div class='popup'></div>"},useData:!0})},99630:(e,t,i)=>{var n=i(93633);e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var l,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<fieldset>\n    <div class='combination'></div>\n    <div class='layout flex'>\n    <div class='form-group'>\n        <label for=\"criterion_type\">Type de critère</label>\n        <select disabled id=\"criterion_type\">\n            <option>"+e.escapeExpression("function"==typeof(l=null!=(l=s(i,"label")||(null!=t?s(t,"label"):t))?l:e.hooks.helperMissing)?l.call(null!=t?t:e.nullContext||{},{name:"label",hash:{},data:o,loc:{start:{line:7,column:20},end:{line:7,column:29}}}):l)+"</option>\n        </select>\n    </div>\n    </div>\n\n</fieldset>\n    <div class='delbutton-container'></div>\n\n<div class='children'>\n</div>"},useData:!0})},1102:(e,t,i)=>{var n=i(93633);e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var l,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<form name=\"current\">\n\t<div class='limited_width width40'>\n\t\t<div class='message-container'></div>\n\t\t<div class='errors'></div>\n\t\t<fieldset>\n\t\t\t<h2 class=\"title\">"+e.escapeExpression("function"==typeof(l=null!=(l=s(i,"title")||(null!=t?s(t,"title"):t))?l:e.hooks.helperMissing)?l.call(null!=t?t:e.nullContext||{},{name:"title",hash:{},data:o,loc:{start:{line:6,column:21},end:{line:6,column:32}}}):l)+"</h2>\n\t\t\t<div class='field-title'></div>\n\t\t\t<div class='field-description'></div>\n\t\t</fieldset>\n\n        <div class=\"layout flex main_actions\">\n            <div role='group'>\n                <button class='btn btn-primary icon' type='submit' value='submit'>\n                    <svg><use href=\"/static/icons/icones.svg#save\"></use></svg>Enregistrer\n                </button>\n                <button class='icon' type='reset' value='submit' title=\"Annuler et revenir en arrière\" aria-label=\"Annuler et revenir en arrière\">\n                    <svg><use href=\"/static/icons/icones.svg#times\"></use></svg>Annuler\n                </button>\n            </div>\n            <div class='resume'></div>\n        </div>\n    </div>\n</form>"},useData:!0})},47800:(e,t,i)=>{var n=i(93633);e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var l,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<section id="work_form" class="size_middle">\n    <form name="current">\n        <div role="dialog" id="work-forms" aria-modal="true" aria-labelledby="work-forms_title">\n            <div class=\'modal_layout\'>\n                <header>\n                    <button class="icon only unstyled close" title="Fermer cette fenêtre"\n                        aria-label="Fermer cette fenêtre" type=\'button\'>\n                        <svg>\n                            <use href="/static/icons/icones.svg#times"></use>\n                        </svg>\n                    </button>\n                    <h2>'+e.escapeExpression("function"==typeof(l=null!=(l=s(i,"title")||(null!=t?s(t,"title"):t))?l:e.hooks.helperMissing)?l.call(null!=t?t:e.nullContext||{},{name:"title",hash:{},data:o,loc:{start:{line:12,column:24},end:{line:12,column:33}}}):l)+"</h2>\n                </header>\n                <div class=\"modal_content_layout\">\n                    <div class='modal_content'>\n                        <div class='message-container'></div>\n                        <div class='errors'></div>\n                        <fieldset>\n                            <div class='field-sheets'></div>\n                        </fieldset>\n                    </div>\n                    <footer>\n                        <button class='btn btn-primary icon' type='submit' value='submit'>\n                            <svg>\n                                <use href=\"/static/icons/icones.svg#save\"></use>\n                            </svg>Dupliquer\n                        </button>\n                        <button class='icon' type='reset' value='submit' title=\"Annuler et revenir en arrière\"\n                            aria-label=\"Annuler et revenir en arrière\">\n                            <svg>\n                                <use href=\"/static/icons/icones.svg#times\"></use>\n                            </svg>Annuler\n                        </button>\n                    </footer>\n                </div>\n            </div>\n        </div>\n    </form>\n</section>\n"},useData:!0})},98395:(e,t,i)=>{var n=i(93633);e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return"<div>Aucune entrée statistiques n'a été saisie</div>"},useData:!0})},45652:(e,t,i)=>{var n=i(93633);e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<h3>Entrées statistiques</h3>\n<div class="table_container">\n    <table class=\'top_align_table hover_table\'>\n        <thead>\n            <tr>\n                <th scope="col" class="col_text"><span class="screen-reader-text">Intitulé</span></th>\n                <th scope="col" class="col_actions" title="Actions"><span class="screen-reader-text">Actions</span></th>\n            </tr>\n        </thead>\n        <tbody></tbody>\n    </table>\n</div>'},useData:!0})},83200:(e,t,i)=>{var n=i(93633);e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var l,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<td class='col_text'>"+e.escapeExpression("function"==typeof(l=null!=(l=s(i,"title")||(null!=t?s(t,"title"):t))?l:e.hooks.helperMissing)?l.call(null!=t?t:e.nullContext||{},{name:"title",hash:{},data:o,loc:{start:{line:1,column:21},end:{line:1,column:30}}}):l)+"</td>\n<td class='col_actions width_four'>\n    <button class='btn icon only edit'>\n        <svg><use href=\"/static/icons/icones.svg#pen\"></use></svg>\n    </button>\n    <button class='btn icon only duplicate'>\n        <svg><use href=\"/static/icons/icones.svg#copy\"></use></svg>\n    </button>\n    <button class='btn icon only csv_export'>\n        <svg><use href=\"/static/icons/icones.svg#file-csv\"></use></svg>\n    </button>\n    <button class='btn icon only negative delete'>\n        <svg><use href=\"/static/icons/icones.svg#trash-alt\"></use></svg>\n    </button>\n\n</td>"},useData:!0})},28998:(e,t,i)=>{var n=i(93633);e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return"<div class=\"main_toolbar\" id=\"toolbar\"></div>\n<div class=\"content_vertical_padding\" id='main'>\n    <div id='entries' class='content_vertical_padding'></div>\n</div>\n<div class='entry-popup'></div>"},useData:!0})}},i={};function n(e){var o=i[e];if(void 0!==o)return o.exports;var l=i[e]={id:e,loaded:!1,exports:{}};return t[e].call(l.exports,l,l.exports,n),l.loaded=!0,l.exports}n.m=t,e=[],n.O=(t,i,o,l)=>{if(!i){var s=1/0;for(d=0;d<e.length;d++){for(var[i,o,l]=e[d],r=!0,a=0;a<i.length;a++)(!1&l||s>=l)&&Object.keys(n.O).every((e=>n.O[e](i[a])))?i.splice(a--,1):(r=!1,l<s&&(s=l));if(r){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[i,o,l]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.j=766,(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");if(i.length)for(var o=i.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=i[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{var e={766:0};n.O.j=t=>0===e[t];var t=(t,i)=>{var o,l,[s,r,a]=i,c=0;if(s.some((t=>0!==e[t]))){for(o in r)n.o(r,o)&&(n.m[o]=r[o]);if(a)var d=a(n)}for(t&&t(i);c<s.length;c++)l=s[c],n.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return n.O(d)},i=self.webpackChunkenDI=self.webpackChunkenDI||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var o=n.O(void 0,[121],(()=>n(29963)));o=n.O(o),statistics=o})();