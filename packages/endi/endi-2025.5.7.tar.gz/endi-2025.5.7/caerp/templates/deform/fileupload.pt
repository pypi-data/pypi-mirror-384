<div class="deformFileupload file-upload"
     tal:define="oid oid|field.oid;
                 css_class css_class|field.widget.css_class;
                 style style|field.widget.style">

    ${field.start_mapping()}

    <div class="deformReplaces layout flex" tal:condition="cstruct.get('uid')">
        <input type="hidden" name="uid" value="${cstruct['uid']}"
            id="${oid}-uid"/>
        <span class="file-preview" tal:condition="cstruct.get('preview_url')">
            <a href="${cstruct['preview_url']}" title="Cliquer pour télécharger le fichier" aria-label="Cliquer pour télécharger le fichier" target="_blank"><img src="${cstruct['preview_url']}" alt="Image téléversée" onerror="this.style.display='none';" /></a>
        </span>
        <div>
            <span tal:condition="cstruct.get('preview_url')">
                <a href="${cstruct['preview_url']}" title="Cliquer pour télécharger le fichier" aria-label="Cliquer pour télécharger le fichier" target="_blank">${cstruct.get('filename')}</a>
            </span>
            <span tal:condition="not cstruct.get('preview_url')"
                id="${oid}-filename">
               ${cstruct.get('filename')}
            </span>
            <div class="checkbox" tal:condition="field.widget.show_delete_control">
                <label title="Sélectionner pour supprimer le fichier quand ce formulaire sera validé">
                    <input type="checkbox" name="delete" id="${oid}-delete"/>
                    <span>Supprimer</span>
                    <span class="screen-reader-text"> Sélectionner pour supprimer le fichier quand ce formulaire sera validé</span>
                </label>
            </div>
        </div>
    </div>

    <input type="file" name="upload"
        tal:attributes="class css_class;
                         style style;"
        id="${oid}"/>

    ${field.end_mapping()}

</div>
