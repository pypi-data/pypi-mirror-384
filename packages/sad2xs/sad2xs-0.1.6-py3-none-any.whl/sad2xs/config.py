"""
(Unofficial) SAD to XSuite Converter: Configuration Defaults
=============================================
Author(s):  John P T Salvesen
Email:      john.salvesen@cern.ch
Date:       09-10-2025
"""

################################################################################
# Required Modules
################################################################################
from dataclasses import dataclass, field

################################################################################
# Config Dataclass
################################################################################
@dataclass
class Config:
    """
    Default configuration settings for the SAD to XSuite converter.
    """

    ############################################################################
    # Hidden Flags
    ############################################################################
    _verbose:                       bool            = True
    _test_mode:                     bool            = False
    _replace_repeated_elements:     bool            = True
    _install_offset_markers:        bool            = True

    ############################################################################
    # Constants
    ############################################################################
    
    ########################################
    # ASCII Art
    ########################################
    ASCII_LOGO:                     str             = """
################################################################################
················································································
········###############···············###············##################·········
·····###···············###·········###···###·········###···············###······
·····###························###·········###······###···············###······
········###############······###···············###···###···············###······
·······················###···#####################···###···············###······
·····###···············###···###···············###···###···············###······
········###############······###···············###···##################·········
················································································
································###############·································
·····························###···············###······························
···············································###······························
································###############·································
·····························###················································
·····························###················································
·····························#####################······························
················································································
··················###···············###······###############····················
·····················###·········###······###···············###·················
························###···###·········###···································
···························###···············###############····················
························###···###···························###·················
·····················###·········###······###···············###·················
··················###···············###······###############····················
················································································
################################################################################
# SAD2XS: The Unnofficial Sad to Xsuite Converter
################################################################################
"""

    ########################################
    # Allowed SAD element Types
    ########################################
    SAD_ALLOWED_ELEMENTS:           set[str]        = field(
        default_factory = lambda: {
            'drift',
            'bend', 'quad', 'sext', 'oct', 'mult', 'sol',
            'cavi', 'apert', 'coord',
            'mark', 'moni', 'beambeam'})

    ########################################
    # Reference Particle Defaults
    ########################################
    ref_particle_mass0:             float | None    = None
    ref_particle_q0:                float | None    = None
    ref_particle_p0c:               float | None    = None

    ########################################
    # Coordinate Transform Conventions
    ########################################
    COORD_SIGNS:                    dict[str, int]  = field(
        default_factory = lambda: {
        'dx':         +1,
        'dy':         +1,
        'chi1':       -1,
        'chi2':       +1,
        'chi3':       -1})

    ########################################
    # Coordinate Transformation Tolerances
    ########################################
    TRANSFORM_SHIFT_TOL:            float           = 1E-12
    TRANSFORM_ROT_TOL:              float           = 1E-12

    ########################################
    # KNL, KSL array order
    ########################################
    MAX_KNL_ORDER:                  int             = 21
    KNL_ZERO_TOL:                   float           = 1E-12

    ########################################
    # Simplify Multipoles to relevant elements (quad, sext, oct)
    ########################################
    SIMPLIFY_MULTIPOLES:            bool            = True

    ########################################
    # Element Modelling Constants
    ########################################
    MODEL_DRIFT:                    str             = 'exact'
    MODEL_BEND:                     str             = 'mat-kick-mat'
    MODEL_QUAD:                     str             = 'mat-kick-mat'
    MODEL_SEXT:                     str             = 'mat-kick-mat'
    MODEL_OCT:                      str             = 'mat-kick-mat'
    MODEL_CAVI:                     str             = 'drift-kick-drift-exact'

    INTEGRATOR_BEND:                str             = 'uniform'
    INTEGRATOR_QUAD:                str             = 'uniform'
    INTEGRATOR_SEXT:                str             = 'yoshida4'
    INTEGRATOR_OCT:                 str             = 'yoshida4'
    INTEGRATOR_CAVI:                str             = 'yoshida4'

    N_INTEGRATOR_KICKS_BEND:        int             = 3
    N_INTEGRATOR_KICKS_QUAD:        int             = 3
    N_INTEGRATOR_KICKS_SEXT:        int             = 1
    N_INTEGRATOR_KICKS_OCT:         int             = 1
    N_INTEGRATOR_KICKS_MULT:        int             = 3
    N_INTEGRATOR_KICKS_SOL:         int             = 3

    ABSOLUTE_TIME_CAVI:             bool            = False

    EDGE_MODEL_BEND:                str             = 'full'

    ########################################
    # Output Writer Constants
    ########################################
    OUTPUT_STRING_SEP:              int             = 24
    OUTPUT_STRING_LENGTH:           int             = 80
    ALLOWED_ELEMENTS:               set[str]        = field(
        default_factory = lambda: {
        "Marker", "Drift",
        "Bend", "Quadrupole", "Sextupole", "Octupole", "Multipole", "Solenoid",
        "Cavity", "XYShift", "ZetaShift", "XRotation", "YRotation", "SRotation"})

    ########################################
    # Marker Insertion Tolerance
    ########################################
    MARKER_INSERTION_TOLERANCE:     float           = 1E-9
