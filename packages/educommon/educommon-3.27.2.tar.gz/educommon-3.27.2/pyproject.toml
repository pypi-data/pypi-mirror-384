[build-system]
requires = [
    'packaging>=24,<25',
    'wheel>=0.45,<0.46',
    'setuptools>=77,<78',
    'setuptools-git-versioning>=2,<3',
]
build-backend = 'setuptools.build_meta'

[project]
name = 'educommon'
description = 'Общая кодовая база для проектов БЦ Образование'
authors = [
    { name = 'BARS Group', email = 'education_dev@bars-open.ru' },
]
readme = 'README.md'
requires-python = '>=3.9'
dependencies = [
    'packaging>=21,<25',
    'Django>=3.1,<5.0',
    'django-mptt',
    'python-dateutil',
    'termcolor',
    'django-sendfile',
    'requests',
    'celery',
    'spyne',
    'xlsxwriter>=0.9.3,<1',
    'python-magic==0.4.15',
    'pygost==3.15',

    'm3-db-utils>=0.3.13',
    'm3-django-compatibility>=1.12.0,<2',
    'm3-core>=2.2.16,<3',
    'm3-ui>=2.2.116,<3',
    'm3-objectpack>=2.2.49,<3',
    'm3-simple-report>=1.4.1,<2',
    'm3-spyne-smev>=0.2.4,<2',

    'distro>=1.3.0,<2; sys_platform == "linux"',
]
classifiers = [
    'Intended Audience :: Developers',
    'Environment :: Web Environment',
    'Natural Language :: Russian',
    'Natural Language :: English',
    'Operating System :: OS Independent',
    'Development Status :: 5 - Production/Stable',
    'Programming Language :: Python',
    'Programming Language :: Python :: 3.9',
    'Framework :: Django :: 2.2',
    'Framework :: Django :: 3.0',
    'Framework :: Django :: 3.1',
    'Framework :: Django :: 3.2',
    'Framework :: Django :: 4.0',
    'Framework :: Django :: 4.1',
]
dynamic = ['version']

[project.urls]
Homepage = 'https://stash.bars-open.ru/projects/EDUBASE/repos/educommon/browse'
Repository = 'https://stash.bars-open.ru/scm/edubase/educommon.git'

[project.optional-dependencies]
dev = [
    'isort==5.12.0',
    'ruff==0.12.1',
    'flake8>=4.0.1,<7',
    'pytest>=3.2.5,<8',
    'pytest-cov<5',
]
docs = [
    'sphinx>=7,<7.5',
    'sphinx-autodoc-typehints>=2,<2.5',
    'myst-parser>=3,<3.2',
    'sphinx_design>=0.6,<0.7',
]

[tool.setuptools.packages.find]
where = ['src']

[tool.setuptools.package-data]
educommon = ['*.js']

[tool.setuptools.exclude-package-data]
educommon = ['tests', 'tests.*']

[tool.setuptools-git-versioning]
enabled = true

[tool.ruff]
target-version = 'py39'
line-length = 120
indent-width = 4

[tool.ruff.lint]
select = ['F', 'E', 'D', 'W', 'S', 'N',]
ignore = [
    # Missing docstring in public module
    'D100',
    # Missing docstring in public package
    'D104',
    # Missing docstring in public nested class
    'D106',
    # Missing docstring in magic method
    'D105',
    # Missing docstring in __init__
    'D107',
    # 1 blank line required before class docstring
    'D203',
    # Multi-line docstring summary should start at the second line
    'D213',
    # Missing blank line after last section
    'D413',
    # Bad inline option
    'I001',
    # Use of assert detected (useless with pytest)
    'S101',
]
exclude = [
    '.bzr',
    '.direnv',
    '.eggs',
    '.git',
    '.git-rewrite',
    '.hg',
    '.idea',
    '.ipynb_checkpoints',
    '.mypy_cache',
    '.nox',
    '.pants.d',
    '.pyenv',
    '.pytest_cache',
    '.pytype',
    '.ruff_cache',
    '.svn',
    '.tox',
    '.venv',
    '.vscode',
    '__pypackages__',
    '_build',
    'buck-out',
    'build',
    'dist',
    'node_modules',
    'site-packages',
    'venv',
]

[tool.ruff.format]
quote-style = 'single'
indent-style = 'space'
docstring-code-format = true

[tool.ruff.lint.per-file-ignores]
'**/{tests}/*' = ['D']
'**/{migrations}/*' = ['D', 'E']

[tool.flake8]
max-line-length = 120
ignore = [
    # Missing docstring in public module
    'D100',
    # Missing docstring in public package
    'D104',
    # Missing docstring in public nested class
    'D106',
    # Missing docstring in __init__
    'D107',
    # One-line docstring should fit on one line with quotes
    'D200',
    # Line break before binary operator
    'W503',
    # use of assert detected (useless with pytest)
    'S101',
]
per-file-ignores = [
    # variable '...' in class scope should not be mixedCase
    # В SOAP моделях могут использоваться имена с различным написанием
    'wsmodel.py:N815',
    # function name '...' should be lowercase
    # SOAP методы могут именоваться разными способами
    'wsapi.py:N802,N815',
]
exclude = [
    'venv',
]
max-complexity = 10

[tool.pylint]
score = 'no'
msg-template = '{path}:{line} {msg} ({symbol})'
disable = 'all'
enable = [
    'import-error',
    'no-name-in-module',
    'undefined-variable',
    'undefined-all-variable',
]

extension-pkg-whitelist = [
    'lxml',
]