import"../chunks/DsnmJJEf.js";import{o as Ee}from"../chunks/CfPWzxx9.js";import{p as Ye,s as d,b as Z,u as ee,g as e,l,e as Me,d as r,t as Oe,h as m,i as P,f as x,a as o,j as qe,n as O,m as Ge,r as He,c as te}from"../chunks/XfyNEFST.js";import{i as h}from"../chunks/CyI3pj5p.js";import{F as Je,e as Ke,b as de,S as Qe,c as q,t as le,f as We,r as Xe,h as Ze}from"../chunks/Ds6lQle8.js";import{A as ge}from"../chunks/CNlXD7nS.js";import{R as Ne}from"../chunks/BpBF44Cg.js";import{B as et}from"../chunks/BMP9UOh8.js";import{D as ve}from"../chunks/BQVz1yab.js";import{T as tt}from"../chunks/Dsl-dlBH.js";import{u as rt,g as oe}from"../chunks/CXfFsfRJ.js";var at=m("<!> <!>",1),nt=m("<!> <!> <!>",1),lt=m("<!> <!> <!> <!>",1),ot=m("<!> <!>",1),st=m("<!> <!>",1),it=m('<div class="text-center"><div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div></div>'),ct=m('<div class="text-center">No technologies with this selection.</div>'),ut=m('<div class="text-center">No carriers with this selection.</div>'),dt=m('<div class="text-center">No solution selected.</div>'),gt=m('<div class="text-center">No locations with this selection.</div>'),vt=m('<div class="text-center">No data with this selection.</div>'),_t=m('<h1 class="mt-2 mb-4">The Transition Pathway &ndash; Capacity</h1> <!> <div class="plot mt-4"><!></div>',1);function St(Pe,Se){Ye(Se,!0);let w=d(null);const Te=["capacity","capacity_addition"],$e={capacity:"Capacity",capacity_addition:"Capacity Addition"},Ie=["conversion","storage","transport"],_e=["energy","power"],Ue=[{label:"Node",value:"node"},{label:"Technology",value:"technology"}];let G=d(Z([])),s=d(null),_=d("capacity"),i=d("conversion"),U=d("energy"),c=d(null),H=d("technology"),C=d(!1),D=d(Z([])),L=d(Z([])),E=d(Z([])),re=null,S=d(!1),F=d(!1),fe=d(Z({})),pe=l(()=>{const t=e(i)=="storage"?e(U):"power";return e(fe)[e(V)[0]+"_"+t]||""}),Ce=l(()=>e(E).map(t=>t.toString())),Fe=l(()=>({responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Year"}},y:{stacked:!0,title:{display:!0,text:`${$e[e(_)]}`+(e(C)?"":` [${e(pe)}]`)},min:e(C)?0:void 0,max:e(C)?1:void 0}},interaction:{intersect:!1,mode:"nearest",axis:"x"},plugins:{tooltip:{callbacks:{label:t=>`${t.dataset.label}: ${t.formattedValue}`+(e(C)?"":` ${e(pe)}`)}}}})),Re=l(()=>e(s)==null?"":[e(s).solution_name.split(".").pop(),e(s).scenario_name,e(_),e(i),e(c)].join("_")),R=l(()=>{if(e(w)===null||e(s)===null)return[];let t=[];return e(w).data.forEach(n=>{let A=n.technology,T=e(s).detail.reference_carrier[A];!t.includes(T)&&e(he).includes(n.technology)&&t.push(T)}),t}),he=l(()=>{if(!e(s)||!e(i))return[];const t={conversion:"set_conversion_technologies",storage:"set_storage_technologies",transport:"set_transport_technologies"}[e(i)];return e(s).detail.system[t]||[]}),V=l(()=>e(s)===null||e(i)===null?[]:e(he).filter(t=>e(s)?.detail.reference_carrier[t]==e(c))),J=l(()=>e(w)===null?[]:Ke(e(w).data.filter(t=>e(V).includes(t.technology)).map(t=>t.location)));ee(()=>{e(R),Me(()=>{(e(c)==null||!e(R).includes(e(c)))&&(re!=null&&e(R).includes(re)?r(c,re,!0):r(c,e(R).length>0?e(R)[0]:null,!0))})}),ee(()=>{e(c)!=null&&(re=e(c))}),ee(()=>{r(L,e(V),!0)}),ee(()=>{r(D,e(J),!0)}),Ee(()=>{r(_,oe("var")||e(_),!0),r(i,oe("tech")||e(i),!0),r(U,oe("stor")||e(U),!0),r(c,oe("car")||e(c),!0)}),ee(()=>{e(_),e(i),e(U),e(c),Oe().then(()=>{rt({var:e(_),tech:e(i),stor:e(U),car:e(c)})})});function ae(){r(H,"node"),r(C,!1),r(D,e(J),!0),r(L,e(V),!0),r(E,e(G),!0)}async function Ae(){ae(),await ye()}async function je(){ae(),await ye()}function me(){ae()}function Be(){ae()}async function ye(){if(e(_)===null||e(s)===null){r(w,null);return}r(F,!0),r(w,null);const t=await We(e(s).solution_name,[e(_)],e(s).scenario_name);r(w,t[e(_)],!0),t.unit?.data&&r(fe,Object.fromEntries(t.unit.data.map(n=>[n.technology+"_"+n.capacity_type,n[0]||n.units])),!0),r(F,!1)}let be=l(()=>{if(e(_)==null||e(D).length==0||e(E).length==0||e(L).length==0||e(w)===null)return[];let t={},n={};e(H)=="technology"?(t.location=e(D),n.technology=e(L)):(t.technology=e(L),n.location=e(D)),e(i)=="storage"?n.capacity_type=[e(U)]:n.capacity_type=_e;let A=e(G).filter(T=>!e(E).includes(T));return Xe(),Ze(e(w).data,t,n,A,e(C))});var xe=_t(),we=P(x(xe),2);Je(we,{children:(t,n)=>{var A=st(),T=x(A);de(T,{title:"Solution Selection",children:(k,K)=>{{let Y=l(()=>e(F)||e(S));Qe(k,{solution_selected:Ae,get disabled(){return e(Y)},get selected_solution(){return e(s)},set selected_solution($){r(s,$,!0)},get loading(){return e(S)},set loading($){r(S,$,!0)},get years(){return e(G)},set years($){r(G,$,!0)}})}}});var se=P(T,2);{var j=k=>{var K=ot(),Y=x(K);de(Y,{title:"Variable Selection",children:(N,ne)=>{var Q=nt(),z=x(Q);q(z,{label:"Variable",content:(g,a=O)=>{{let u=l(()=>le(Te)),y=l(()=>e(F)||e(S));ve(g,{get formId(){return a()},get options(){return e(u)},get disabled(){return e(y)},onUpdate:je,get value(){return e(_)},set value(v){r(_,v,!0)}})}}});var f=P(z,2);{var I=p=>{var g=at(),a=x(g);q(a,{label:"Technology Type",content:(b,X=O)=>{{let ie=l(()=>le(Ie)),ce=l(()=>e(F)||e(S));ve(b,{get formId(){return X()},get options(){return e(ie)},get disabled(){return e(ce)},onUpdate:me,get value(){return e(i)},set value(ue){r(i,ue,!0)}})}}});var u=P(a,2);{var y=v=>{q(v,{label:"",content:(X,ie=O)=>{{let ce=l(()=>le(_e)),ue=l(()=>e(F)||e(S));Ne(X,{get formId(){return ie()},get options(){return e(ce)},onUpdate:me,get disabled(){return e(ue)},get value(){return e(U)},set value(ze){r(U,ze,!0)}})}}})};h(u,v=>{e(i)=="storage"&&v(y)})}o(p,g)};h(f,p=>{e(_)!=null&&p(I)})}var M=P(f,2);{var W=p=>{q(p,{label:"Carrier",content:(a,u=O)=>{{let y=l(()=>le(e(R))),v=l(()=>e(F)||e(S));ve(a,{get formId(){return u()},get options(){return e(y)},get disabled(){return e(v)},onUpdate:Be,get value(){return e(c)},set value(b){r(c,b,!0)}})}}})};h(M,p=>{e(i)!=null&&e(R).length>0&&p(W)})}o(N,Q)}});var $=P(Y,2);{var B=N=>{de(N,{title:"Data Selection",children:(ne,Q)=>{var z=lt(),f=x(z);q(f,{label:"Aggregation",content:(u,y=O)=>{Ne(u,{get formId(){return y()},get options(){return Ue},get value(){return e(H)},set value(v){r(H,v,!0)}})}});var I=P(f,2);q(I,{label:"Normalization",content:(u,y=O)=>{tt(u,{get formId(){return y()},get value(){return e(C)},set value(v){r(C,v,!0)}})}});var M=P(I,2);{var W=a=>{ge(a,{label:"Technologies",get elements(){return e(V)},get value(){return e(L)},set value(u){r(L,u,!0)}})},p=a=>{ge(a,{label:"Nodes",get elements(){return e(J)},get value(){return e(D)},set value(u){r(D,u,!0)}})};h(M,a=>{e(H)=="technology"?a(W):a(p,!1)})}var g=P(M,2);ge(g,{label:"Years",get elements(){return e(G)},get value(){return e(E)},set value(a){r(E,a,!0)}}),o(ne,z)}})};h($,N=>{e(w)&&e(i)&&e(c)&&e(V).length>0&&e(J).length>0&&N(B)})}o(k,K)};h(se,k=>{!e(S)&&e(s)&&k(j)})}o(t,A)}});var ke=P(we,2),De=Ge(ke);{var Le=t=>{var n=it();o(t,n)},Ve=t=>{var n=te(),A=x(n);{var T=j=>{var k=ct();o(j,k)},se=j=>{var k=te(),K=x(k);{var Y=B=>{var N=ut();o(B,N)},$=B=>{var N=te(),ne=x(N);{var Q=f=>{var I=dt();o(f,I)},z=f=>{var I=te(),M=x(I);{var W=g=>{var a=gt();o(g,a)},p=g=>{var a=te(),u=x(a);{var y=b=>{var X=vt();o(b,X)},v=b=>{et(b,{type:"bar",get datasets(){return e(be)},get labels(){return e(Ce)},get options(){return e(Fe)},get plot_name(){return e(Re)}})};h(u,b=>{e(be).length==0?b(y):b(v,!1)},!0)}o(g,a)};h(M,g=>{e(J).length==0?g(W):g(p,!1)},!0)}o(f,I)};h(ne,f=>{e(s)==null?f(Q):f(z,!1)},!0)}o(B,N)};h(K,B=>{e(R).length==0?B(Y):B($,!1)},!0)}o(j,k)};h(A,j=>{e(V).length==0?j(T):j(se,!1)},!0)}o(t,n)};h(De,t=>{e(S)||e(F)?t(Le):t(Ve,!1)})}He(ke),o(Pe,xe),qe()}export{St as component};
