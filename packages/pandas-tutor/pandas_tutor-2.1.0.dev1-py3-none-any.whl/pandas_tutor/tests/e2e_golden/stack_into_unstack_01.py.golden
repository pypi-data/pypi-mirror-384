{
  "code": "# https://github.com/SamLau95/pandas_tutor/issues/86\n# adapted from Thinking in Pandas\nimport pandas as pd\n\nrestaurants = pd.MultiIndex.from_tuples(\n    ((\"Diner\", (4, 2)), (\"Pandas\", (5, 4))),\n    names=[\"restaurant\", \"location\"],\n)\ninspections = pd.MultiIndex.from_tuples(\n    ((0, \"score\"), (0, \"date\"), (1, \"score\"), (1, \"date\")),\n    names=[\"inspection\", None],\n)\n\nrestaurant_inspections = pd.DataFrame(\n    [[90, \"02/18\", 100, \"05/18\"], [55, \"04/18\", 76, \"01/18\"]],\n    index=restaurants,\n    columns=inspections,\n)\n\n(restaurant_inspections\n .stack(future_stack=True)\n .stack(future_stack=True)\n .unstack()\n .unstack()\n .unstack()\n .unstack()\n)\n",
  "explanation": [
    {
      "type": "StackCall",
      "code_step": "(restaurant_inspections\n .stack(future_stack=True)\n .stack(future_stack=True)\n .unstack()\n .unstack()\n .unstack()\n .unstack()\n)",
      "fragment": {
        "start": {
          "line": 1,
          "ch": 1
        },
        "end": {
          "line": 1,
          "ch": 26
        }
      },
      "marks": [
        {
          "type": "using",
          "pos": {
            "type": "index_level",
            "anchor": "lhs",
            "select": "column",
            "level": 1
          }
        },
        {
          "type": "using",
          "pos": {
            "type": "index_level",
            "anchor": "rhs",
            "select": "row",
            "level": 2
          }
        },
        {
          "type": "map",
          "from": {
            "type": "index_level",
            "anchor": "lhs",
            "select": "column",
            "level": 1
          },
          "to": {
            "type": "index_level",
            "anchor": "rhs",
            "select": "row",
            "level": 2
          }
        },
        {
          "type": "map_set",
          "maps": [
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ]
                ],
                "column": [
                  0,
                  "score"
                ]
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "score"
                ],
                "column": 0
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ]
                ],
                "column": [
                  0,
                  "date"
                ]
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "date"
                ],
                "column": 0
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ]
                ],
                "column": [
                  1,
                  "score"
                ]
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "score"
                ],
                "column": 1
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ]
                ],
                "column": [
                  1,
                  "date"
                ]
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "date"
                ],
                "column": 1
              }
            }
          ]
        },
        {
          "type": "map_set",
          "maps": [
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ]
                ],
                "column": [
                  0,
                  "score"
                ]
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "score"
                ],
                "column": 0
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ]
                ],
                "column": [
                  0,
                  "date"
                ]
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "date"
                ],
                "column": 0
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ]
                ],
                "column": [
                  1,
                  "score"
                ]
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "score"
                ],
                "column": 1
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ]
                ],
                "column": [
                  1,
                  "date"
                ]
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "date"
                ],
                "column": 1
              }
            }
          ]
        }
      ],
      "data": {
        "lhs": {
          "type": "DataFrame",
          "columns": {
            "names": [
              "inspection",
              null
            ],
            "labels": [
              [
                0,
                "score"
              ],
              [
                0,
                "date"
              ],
              [
                1,
                "score"
              ],
              [
                1,
                "date"
              ]
            ]
          },
          "index": {
            "names": [
              "restaurant",
              "location"
            ],
            "labels": [
              [
                "Diner",
                [
                  4,
                  2
                ]
              ],
              [
                "Pandas",
                [
                  5,
                  4
                ]
              ]
            ]
          },
          "data": [
            [
              90,
              "02/18",
              100,
              "05/18"
            ],
            [
              55,
              "04/18",
              76,
              "01/18"
            ]
          ]
        },
        "rhs": {
          "type": "DataFrame",
          "columns": {
            "names": [
              "inspection"
            ],
            "labels": [
              0,
              1
            ]
          },
          "index": {
            "names": [
              "restaurant",
              "location",
              null
            ],
            "labels": [
              [
                "Diner",
                [
                  4,
                  2
                ],
                "score"
              ],
              [
                "Diner",
                [
                  4,
                  2
                ],
                "date"
              ],
              [
                "Pandas",
                [
                  5,
                  4
                ],
                "score"
              ],
              [
                "Pandas",
                [
                  5,
                  4
                ],
                "date"
              ]
            ]
          },
          "data": [
            [
              90,
              100
            ],
            [
              "02/18",
              "05/18"
            ],
            [
              55,
              76
            ],
            [
              "04/18",
              "01/18"
            ]
          ]
        }
      }
    },
    {
      "type": "StackCall",
      "code_step": "(restaurant_inspections\n .stack(future_stack=True)\n .stack(future_stack=True)\n .unstack()\n .unstack()\n .unstack()\n .unstack()\n)",
      "fragment": {
        "start": {
          "line": 2,
          "ch": 1
        },
        "end": {
          "line": 2,
          "ch": 26
        }
      },
      "marks": [
        {
          "type": "using",
          "pos": {
            "type": "index_level",
            "anchor": "lhs",
            "select": "column",
            "level": 0
          }
        },
        {
          "type": "using",
          "pos": {
            "type": "index_level",
            "anchor": "rhs",
            "select": "row",
            "level": 3
          }
        },
        {
          "type": "map",
          "from": {
            "type": "index_level",
            "anchor": "lhs",
            "select": "column",
            "level": 0
          },
          "to": {
            "type": "index_level",
            "anchor": "rhs",
            "select": "row",
            "level": 3
          }
        },
        {
          "type": "map_set",
          "maps": [
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "date"
                ],
                "column": 0
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "date",
                  0
                ],
                "column": "pandas.Series"
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "date"
                ],
                "column": 1
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "date",
                  1
                ],
                "column": "pandas.Series"
              }
            }
          ]
        },
        {
          "type": "map_set",
          "maps": [
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "score"
                ],
                "column": 0
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "score",
                  0
                ],
                "column": "pandas.Series"
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "score"
                ],
                "column": 1
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "score",
                  1
                ],
                "column": "pandas.Series"
              }
            }
          ]
        },
        {
          "type": "map_set",
          "maps": [
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "date"
                ],
                "column": 0
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "date",
                  0
                ],
                "column": "pandas.Series"
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "date"
                ],
                "column": 1
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "date",
                  1
                ],
                "column": "pandas.Series"
              }
            }
          ]
        },
        {
          "type": "map_set",
          "maps": [
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "score"
                ],
                "column": 0
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "score",
                  0
                ],
                "column": "pandas.Series"
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "score"
                ],
                "column": 1
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "score",
                  1
                ],
                "column": "pandas.Series"
              }
            }
          ]
        }
      ],
      "data": {
        "lhs": "prev_rhs",
        "rhs": {
          "type": "Series",
          "index": {
            "names": [
              "restaurant",
              "location",
              null,
              "inspection"
            ],
            "labels": [
              [
                "Diner",
                [
                  4,
                  2
                ],
                "score",
                0
              ],
              [
                "Diner",
                [
                  4,
                  2
                ],
                "score",
                1
              ],
              [
                "Diner",
                [
                  4,
                  2
                ],
                "date",
                0
              ],
              [
                "Diner",
                [
                  4,
                  2
                ],
                "date",
                1
              ],
              [
                "Pandas",
                [
                  5,
                  4
                ],
                "score",
                0
              ],
              [
                "Pandas",
                [
                  5,
                  4
                ],
                "score",
                1
              ],
              [
                "Pandas",
                [
                  5,
                  4
                ],
                "date",
                0
              ],
              [
                "Pandas",
                [
                  5,
                  4
                ],
                "date",
                1
              ]
            ]
          },
          "data": [
            90,
            100,
            "02/18",
            "05/18",
            55,
            76,
            "04/18",
            "01/18"
          ]
        }
      }
    },
    {
      "type": "UnstackCall",
      "code_step": "(restaurant_inspections\n .stack(future_stack=True)\n .stack(future_stack=True)\n .unstack()\n .unstack()\n .unstack()\n .unstack()\n)",
      "fragment": {
        "start": {
          "line": 3,
          "ch": 1
        },
        "end": {
          "line": 3,
          "ch": 11
        }
      },
      "marks": [
        {
          "type": "using",
          "pos": {
            "type": "index_level",
            "anchor": "lhs",
            "select": "row",
            "level": 3
          }
        },
        {
          "type": "using",
          "pos": {
            "type": "index_level",
            "anchor": "rhs",
            "select": "column",
            "level": 0
          }
        },
        {
          "type": "map",
          "from": {
            "type": "index_level",
            "anchor": "lhs",
            "select": "row",
            "level": 3
          },
          "to": {
            "type": "index_level",
            "anchor": "rhs",
            "select": "column",
            "level": 0
          }
        },
        {
          "type": "map_set",
          "maps": [
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "score",
                  0
                ],
                "column": "pandas.Series"
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "score"
                ],
                "column": 0
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "score",
                  1
                ],
                "column": "pandas.Series"
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "score"
                ],
                "column": 1
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "date",
                  0
                ],
                "column": "pandas.Series"
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "date"
                ],
                "column": 0
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "date",
                  1
                ],
                "column": "pandas.Series"
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "date"
                ],
                "column": 1
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "score",
                  0
                ],
                "column": "pandas.Series"
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "score"
                ],
                "column": 0
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "score",
                  1
                ],
                "column": "pandas.Series"
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "score"
                ],
                "column": 1
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "date",
                  0
                ],
                "column": "pandas.Series"
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "date"
                ],
                "column": 0
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "date",
                  1
                ],
                "column": "pandas.Series"
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "date"
                ],
                "column": 1
              }
            }
          ]
        }
      ],
      "data": {
        "lhs": "prev_rhs",
        "rhs": {
          "type": "DataFrame",
          "columns": {
            "names": [
              "inspection"
            ],
            "labels": [
              0,
              1
            ]
          },
          "index": {
            "names": [
              "restaurant",
              "location",
              null
            ],
            "labels": [
              [
                "Diner",
                [
                  4,
                  2
                ],
                "score"
              ],
              [
                "Diner",
                [
                  4,
                  2
                ],
                "date"
              ],
              [
                "Pandas",
                [
                  5,
                  4
                ],
                "score"
              ],
              [
                "Pandas",
                [
                  5,
                  4
                ],
                "date"
              ]
            ]
          },
          "data": [
            [
              90,
              100
            ],
            [
              "02/18",
              "05/18"
            ],
            [
              55,
              76
            ],
            [
              "04/18",
              "01/18"
            ]
          ]
        }
      }
    },
    {
      "type": "UnstackCall",
      "code_step": "(restaurant_inspections\n .stack(future_stack=True)\n .stack(future_stack=True)\n .unstack()\n .unstack()\n .unstack()\n .unstack()\n)",
      "fragment": {
        "start": {
          "line": 4,
          "ch": 1
        },
        "end": {
          "line": 4,
          "ch": 11
        }
      },
      "marks": [
        {
          "type": "using",
          "pos": {
            "type": "index_level",
            "anchor": "lhs",
            "select": "row",
            "level": 2
          }
        },
        {
          "type": "using",
          "pos": {
            "type": "index_level",
            "anchor": "rhs",
            "select": "column",
            "level": 1
          }
        },
        {
          "type": "map",
          "from": {
            "type": "index_level",
            "anchor": "lhs",
            "select": "row",
            "level": 2
          },
          "to": {
            "type": "index_level",
            "anchor": "rhs",
            "select": "column",
            "level": 1
          }
        },
        {
          "type": "map_set",
          "maps": [
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "score"
                ],
                "column": 0
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ]
                ],
                "column": [
                  0,
                  "score"
                ]
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "date"
                ],
                "column": 0
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ]
                ],
                "column": [
                  0,
                  "date"
                ]
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "score"
                ],
                "column": 0
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ]
                ],
                "column": [
                  0,
                  "score"
                ]
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "date"
                ],
                "column": 0
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ]
                ],
                "column": [
                  0,
                  "date"
                ]
              }
            }
          ]
        },
        {
          "type": "map_set",
          "maps": [
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "score"
                ],
                "column": 1
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ]
                ],
                "column": [
                  1,
                  "score"
                ]
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ],
                  "date"
                ],
                "column": 1
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ]
                ],
                "column": [
                  1,
                  "date"
                ]
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "score"
                ],
                "column": 1
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ]
                ],
                "column": [
                  1,
                  "score"
                ]
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ],
                  "date"
                ],
                "column": 1
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ]
                ],
                "column": [
                  1,
                  "date"
                ]
              }
            }
          ]
        }
      ],
      "data": {
        "lhs": "prev_rhs",
        "rhs": {
          "type": "DataFrame",
          "columns": {
            "names": [
              "inspection",
              null
            ],
            "labels": [
              [
                0,
                "score"
              ],
              [
                0,
                "date"
              ],
              [
                1,
                "score"
              ],
              [
                1,
                "date"
              ]
            ]
          },
          "index": {
            "names": [
              "restaurant",
              "location"
            ],
            "labels": [
              [
                "Diner",
                [
                  4,
                  2
                ]
              ],
              [
                "Pandas",
                [
                  5,
                  4
                ]
              ]
            ]
          },
          "data": [
            [
              90,
              "02/18",
              100,
              "05/18"
            ],
            [
              55,
              "04/18",
              76,
              "01/18"
            ]
          ]
        }
      }
    },
    {
      "type": "UnstackCall",
      "code_step": "(restaurant_inspections\n .stack(future_stack=True)\n .stack(future_stack=True)\n .unstack()\n .unstack()\n .unstack()\n .unstack()\n)",
      "fragment": {
        "start": {
          "line": 5,
          "ch": 1
        },
        "end": {
          "line": 5,
          "ch": 11
        }
      },
      "marks": [
        {
          "type": "using",
          "pos": {
            "type": "index_level",
            "anchor": "lhs",
            "select": "row",
            "level": 1
          }
        },
        {
          "type": "using",
          "pos": {
            "type": "index_level",
            "anchor": "rhs",
            "select": "column",
            "level": 2
          }
        },
        {
          "type": "map",
          "from": {
            "type": "index_level",
            "anchor": "lhs",
            "select": "row",
            "level": 1
          },
          "to": {
            "type": "index_level",
            "anchor": "rhs",
            "select": "column",
            "level": 2
          }
        },
        {
          "type": "map_set",
          "maps": [
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ]
                ],
                "column": [
                  0,
                  "date"
                ]
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": "Diner",
                "column": [
                  0,
                  "date",
                  [
                    4,
                    2
                  ]
                ]
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ]
                ],
                "column": [
                  0,
                  "date"
                ]
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": "Pandas",
                "column": [
                  0,
                  "date",
                  [
                    5,
                    4
                  ]
                ]
              }
            }
          ]
        },
        {
          "type": "map_set",
          "maps": [
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ]
                ],
                "column": [
                  0,
                  "score"
                ]
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": "Diner",
                "column": [
                  0,
                  "score",
                  [
                    4,
                    2
                  ]
                ]
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ]
                ],
                "column": [
                  0,
                  "score"
                ]
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": "Pandas",
                "column": [
                  0,
                  "score",
                  [
                    5,
                    4
                  ]
                ]
              }
            }
          ]
        },
        {
          "type": "map_set",
          "maps": [
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ]
                ],
                "column": [
                  1,
                  "date"
                ]
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": "Diner",
                "column": [
                  1,
                  "date",
                  [
                    4,
                    2
                  ]
                ]
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ]
                ],
                "column": [
                  1,
                  "date"
                ]
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": "Pandas",
                "column": [
                  1,
                  "date",
                  [
                    5,
                    4
                  ]
                ]
              }
            }
          ]
        },
        {
          "type": "map_set",
          "maps": [
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Diner",
                  [
                    4,
                    2
                  ]
                ],
                "column": [
                  1,
                  "score"
                ]
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": "Diner",
                "column": [
                  1,
                  "score",
                  [
                    4,
                    2
                  ]
                ]
              }
            },
            {
              "type": "map",
              "from": {
                "type": "cell",
                "anchor": "lhs",
                "row": [
                  "Pandas",
                  [
                    5,
                    4
                  ]
                ],
                "column": [
                  1,
                  "score"
                ]
              },
              "to": {
                "type": "cell",
                "anchor": "rhs",
                "row": "Pandas",
                "column": [
                  1,
                  "score",
                  [
                    5,
                    4
                  ]
                ]
              }
            }
          ]
        }
      ],
      "data": {
        "lhs": "prev_rhs",
        "rhs": {
          "type": "DataFrame",
          "columns": {
            "names": [
              "inspection",
              null,
              "location"
            ],
            "labels": [
              [
                0,
                "score",
                [
                  4,
                  2
                ]
              ],
              [
                0,
                "score",
                [
                  5,
                  4
                ]
              ],
              [
                0,
                "date",
                [
                  4,
                  2
                ]
              ],
              [
                0,
                "date",
                [
                  5,
                  4
                ]
              ],
              [
                1,
                "score",
                [
                  4,
                  2
                ]
              ],
              [
                1,
                "score",
                [
                  5,
                  4
                ]
              ],
              [
                1,
                "date",
                [
                  4,
                  2
                ]
              ],
              [
                1,
                "date",
                [
                  5,
                  4
                ]
              ]
            ]
          },
          "index": {
            "names": [
              "restaurant"
            ],
            "labels": [
              "Diner",
              "Pandas"
            ]
          },
          "data": [
            [
              90,
              null,
              "02/18",
              null,
              100,
              null,
              "05/18",
              null
            ],
            [
              null,
              55,
              null,
              "04/18",
              null,
              76,
              null,
              "01/18"
            ]
          ]
        }
      }
    },
    {
      "type": "UnstackCall",
      "code_step": "(restaurant_inspections\n .stack(future_stack=True)\n .stack(future_stack=True)\n .unstack()\n .unstack()\n .unstack()\n .unstack()\n)",
      "fragment": {
        "start": {
          "line": 6,
          "ch": 1
        },
        "end": {
          "line": 6,
          "ch": 11
        }
      },
      "marks": [],
      "data": {
        "lhs": "prev_rhs",
        "rhs": {
          "type": "Series",
          "index": {
            "names": [
              "inspection",
              null,
              "location",
              "restaurant"
            ],
            "labels": [
              [
                0,
                "score",
                [
                  4,
                  2
                ],
                "Diner"
              ],
              [
                0,
                "score",
                [
                  4,
                  2
                ],
                "Pandas"
              ],
              [
                0,
                "score",
                [
                  5,
                  4
                ],
                "Diner"
              ],
              [
                0,
                "score",
                [
                  5,
                  4
                ],
                "Pandas"
              ],
              [
                0,
                "date",
                [
                  4,
                  2
                ],
                "Diner"
              ],
              [
                0,
                "date",
                [
                  4,
                  2
                ],
                "Pandas"
              ],
              [
                0,
                "date",
                [
                  5,
                  4
                ],
                "Diner"
              ],
              [
                0,
                "date",
                [
                  5,
                  4
                ],
                "Pandas"
              ],
              [
                1,
                "score",
                [
                  4,
                  2
                ],
                "Diner"
              ],
              [
                1,
                "score",
                [
                  4,
                  2
                ],
                "Pandas"
              ],
              [
                1,
                "score",
                [
                  5,
                  4
                ],
                "Diner"
              ],
              [
                1,
                "score",
                [
                  5,
                  4
                ],
                "Pandas"
              ],
              [
                1,
                "date",
                [
                  4,
                  2
                ],
                "Diner"
              ],
              [
                1,
                "date",
                [
                  4,
                  2
                ],
                "Pandas"
              ],
              [
                1,
                "date",
                [
                  5,
                  4
                ],
                "Diner"
              ],
              [
                1,
                "date",
                [
                  5,
                  4
                ],
                "Pandas"
              ]
            ]
          },
          "data": [
            90,
            null,
            null,
            55,
            "02/18",
            null,
            null,
            "04/18",
            100,
            null,
            null,
            76,
            "05/18",
            null,
            null,
            "01/18"
          ]
        }
      }
    }
  ]
}