{
  "code": "# https://github.com/SamLau95/pandas_tutor/issues/72\n# https://pandas.pydata.org/pandas-docs/stable/user_guide/groupby.html\nimport pandas as pd\nimport numpy as np\nnp.random.seed(0)\n\narrays = [\n    [\"bar\", \"bar\", \"baz\", \"baz\", \"foo\", \"foo\", \"qux\", \"qux\"],\n    [\"one\", \"two\", \"one\", \"two\", \"one\", \"two\", \"one\", \"two\"],\n]\nindex = pd.MultiIndex.from_arrays(arrays, names=[\"first\", \"second\"])\n\ndf = pd.DataFrame({\"A\": [1, 1, 1, 1, 2, 2, 3, 3], \"B\": np.arange(8)}, index=index)\n\ndf.groupby([pd.Grouper(level=1), \"A\"]).mean()\n",
  "explanation": [
    {
      "type": "GroupByCall",
      "code_step": "df.groupby([pd.Grouper(level=1), \"A\"]).mean()",
      "fragment": {
        "start": {
          "line": 0,
          "ch": 2
        },
        "end": {
          "line": 0,
          "ch": 38
        }
      },
      "marks": [
        {
          "type": "using",
          "pos": {
            "type": "axis",
            "anchor": "lhs",
            "select": "column",
            "label": "A"
          }
        }
      ],
      "data": {
        "lhs": {
          "type": "DataFrame",
          "columns": {
            "names": [
              null
            ],
            "labels": [
              "A",
              "B"
            ]
          },
          "index": {
            "names": [
              "first",
              "second"
            ],
            "labels": [
              [
                "bar",
                "one"
              ],
              [
                "bar",
                "two"
              ],
              [
                "baz",
                "one"
              ],
              [
                "baz",
                "two"
              ],
              [
                "foo",
                "one"
              ],
              [
                "foo",
                "two"
              ],
              [
                "qux",
                "one"
              ],
              [
                "qux",
                "two"
              ]
            ]
          },
          "data": [
            [
              1,
              0
            ],
            [
              1,
              1
            ],
            [
              1,
              2
            ],
            [
              1,
              3
            ],
            [
              2,
              4
            ],
            [
              2,
              5
            ],
            [
              3,
              6
            ],
            [
              3,
              7
            ]
          ]
        },
        "rhs": {
          "type": "DataFrameGroupBy",
          "columns": {
            "names": [
              null
            ],
            "labels": [
              "A",
              "B"
            ]
          },
          "index": {
            "names": [
              "first",
              "second"
            ],
            "labels": [
              [
                "bar",
                "one"
              ],
              [
                "bar",
                "two"
              ],
              [
                "baz",
                "one"
              ],
              [
                "baz",
                "two"
              ],
              [
                "foo",
                "one"
              ],
              [
                "foo",
                "two"
              ],
              [
                "qux",
                "one"
              ],
              [
                "qux",
                "two"
              ]
            ]
          },
          "data": [
            [
              1,
              0
            ],
            [
              1,
              1
            ],
            [
              1,
              2
            ],
            [
              1,
              3
            ],
            [
              2,
              4
            ],
            [
              2,
              5
            ],
            [
              3,
              6
            ],
            [
              3,
              7
            ]
          ],
          "group_data": {
            "columns": [
              "second",
              "A"
            ],
            "groups": [
              {
                "name": [
                  "one",
                  1
                ],
                "labels": [
                  [
                    "bar",
                    "one"
                  ],
                  [
                    "baz",
                    "one"
                  ]
                ]
              },
              {
                "name": [
                  "one",
                  2
                ],
                "labels": [
                  [
                    "foo",
                    "one"
                  ]
                ]
              },
              {
                "name": [
                  "one",
                  3
                ],
                "labels": [
                  [
                    "qux",
                    "one"
                  ]
                ]
              },
              {
                "name": [
                  "two",
                  1
                ],
                "labels": [
                  [
                    "bar",
                    "two"
                  ],
                  [
                    "baz",
                    "two"
                  ]
                ]
              },
              {
                "name": [
                  "two",
                  2
                ],
                "labels": [
                  [
                    "foo",
                    "two"
                  ]
                ]
              },
              {
                "name": [
                  "two",
                  3
                ],
                "labels": [
                  [
                    "qux",
                    "two"
                  ]
                ]
              }
            ]
          }
        }
      }
    },
    {
      "type": "GroupByAggCall",
      "code_step": "df.groupby([pd.Grouper(level=1), \"A\"]).mean()",
      "fragment": {
        "start": {
          "line": 0,
          "ch": 38
        },
        "end": {
          "line": 0,
          "ch": 45
        }
      },
      "marks": [
        {
          "type": "map",
          "from": {
            "type": "axis",
            "anchor": "lhs",
            "select": "row",
            "label": [
              "bar",
              "one"
            ]
          },
          "to": {
            "type": "axis",
            "anchor": "rhs",
            "select": "row",
            "label": [
              "one",
              1
            ]
          }
        },
        {
          "type": "map",
          "from": {
            "type": "axis",
            "anchor": "lhs",
            "select": "row",
            "label": [
              "baz",
              "one"
            ]
          },
          "to": {
            "type": "axis",
            "anchor": "rhs",
            "select": "row",
            "label": [
              "one",
              1
            ]
          }
        },
        {
          "type": "map",
          "from": {
            "type": "axis",
            "anchor": "lhs",
            "select": "row",
            "label": [
              "foo",
              "one"
            ]
          },
          "to": {
            "type": "axis",
            "anchor": "rhs",
            "select": "row",
            "label": [
              "one",
              2
            ]
          }
        },
        {
          "type": "map",
          "from": {
            "type": "axis",
            "anchor": "lhs",
            "select": "row",
            "label": [
              "qux",
              "one"
            ]
          },
          "to": {
            "type": "axis",
            "anchor": "rhs",
            "select": "row",
            "label": [
              "one",
              3
            ]
          }
        },
        {
          "type": "map",
          "from": {
            "type": "axis",
            "anchor": "lhs",
            "select": "row",
            "label": [
              "bar",
              "two"
            ]
          },
          "to": {
            "type": "axis",
            "anchor": "rhs",
            "select": "row",
            "label": [
              "two",
              1
            ]
          }
        },
        {
          "type": "map",
          "from": {
            "type": "axis",
            "anchor": "lhs",
            "select": "row",
            "label": [
              "baz",
              "two"
            ]
          },
          "to": {
            "type": "axis",
            "anchor": "rhs",
            "select": "row",
            "label": [
              "two",
              1
            ]
          }
        },
        {
          "type": "map",
          "from": {
            "type": "axis",
            "anchor": "lhs",
            "select": "row",
            "label": [
              "foo",
              "two"
            ]
          },
          "to": {
            "type": "axis",
            "anchor": "rhs",
            "select": "row",
            "label": [
              "two",
              2
            ]
          }
        },
        {
          "type": "map",
          "from": {
            "type": "axis",
            "anchor": "lhs",
            "select": "row",
            "label": [
              "qux",
              "two"
            ]
          },
          "to": {
            "type": "axis",
            "anchor": "rhs",
            "select": "row",
            "label": [
              "two",
              3
            ]
          }
        }
      ],
      "data": {
        "lhs": "prev_rhs",
        "rhs": {
          "type": "DataFrame",
          "columns": {
            "names": [
              null
            ],
            "labels": [
              "B"
            ]
          },
          "index": {
            "names": [
              "second",
              "A"
            ],
            "labels": [
              [
                "one",
                1
              ],
              [
                "one",
                2
              ],
              [
                "one",
                3
              ],
              [
                "two",
                1
              ],
              [
                "two",
                2
              ],
              [
                "two",
                3
              ]
            ]
          },
          "data": [
            [
              1.0
            ],
            [
              4.0
            ],
            [
              6.0
            ],
            [
              2.0
            ],
            [
              5.0
            ],
            [
              7.0
            ]
          ]
        }
      }
    }
  ]
}