{
  "code": "# https://pandas.pydata.org/pandas-docs/stable/user_guide/groupby.html\nimport pandas as pd\nimport numpy as np\nnp.random.seed(0)\n\ndf = pd.DataFrame(\n    {\n        \"A\": [\"foo\", \"bar\", \"foo\", \"bar\", \"foo\", \"bar\", \"foo\", \"foo\"],\n        \"B\": [\"one\", \"one\", \"two\", \"three\", \"two\", \"two\", \"one\", \"three\"],\n        \"C\": np.random.randn(8),\n        \"D\": np.random.randn(8),\n    }\n)\n\ndf2 = df.set_index([\"A\", \"B\"])\ndf2.groupby(level=df2.index.names.difference([\"B\"])).mean()",
  "explanation": [
    {
      "type": "GroupByCall",
      "code_step": "df2.groupby(level=df2.index.names.difference([\"B\"])).mean()",
      "fragment": {
        "start": {
          "line": 0,
          "ch": 3
        },
        "end": {
          "line": 0,
          "ch": 52
        }
      },
      "marks": [],
      "data": {
        "lhs": {
          "type": "DataFrame",
          "columns": {
            "names": [
              null
            ],
            "labels": [
              "C",
              "D"
            ]
          },
          "index": {
            "names": [
              "A",
              "B"
            ],
            "labels": [
              [
                "foo",
                "one"
              ],
              [
                "bar",
                "one"
              ],
              [
                "foo",
                "two"
              ],
              [
                "bar",
                "three"
              ],
              [
                "foo",
                "two"
              ],
              [
                "bar",
                "two"
              ],
              [
                "foo",
                "one"
              ],
              [
                "foo",
                "three"
              ]
            ]
          },
          "data": [
            [
              1.764052345967664,
              -0.10321885179355784
            ],
            [
              0.4001572083672233,
              0.41059850193837233
            ],
            [
              0.9787379841057392,
              0.144043571160878
            ],
            [
              2.240893199201458,
              1.454273506962975
            ],
            [
              1.8675579901499675,
              0.7610377251469934
            ],
            [
              -0.977277879876411,
              0.12167501649282841
            ],
            [
              0.9500884175255894,
              0.44386323274542566
            ],
            [
              -0.1513572082976979,
              0.33367432737426683
            ]
          ]
        },
        "rhs": {
          "type": "DataFrameGroupBy",
          "columns": {
            "names": [
              null
            ],
            "labels": [
              "C",
              "D"
            ]
          },
          "index": {
            "names": [
              "A",
              "B"
            ],
            "labels": [
              [
                "foo",
                "one"
              ],
              [
                "bar",
                "one"
              ],
              [
                "foo",
                "two"
              ],
              [
                "bar",
                "three"
              ],
              [
                "foo",
                "two"
              ],
              [
                "bar",
                "two"
              ],
              [
                "foo",
                "one"
              ],
              [
                "foo",
                "three"
              ]
            ]
          },
          "data": [
            [
              1.764052345967664,
              -0.10321885179355784
            ],
            [
              0.4001572083672233,
              0.41059850193837233
            ],
            [
              0.9787379841057392,
              0.144043571160878
            ],
            [
              2.240893199201458,
              1.454273506962975
            ],
            [
              1.8675579901499675,
              0.7610377251469934
            ],
            [
              -0.977277879876411,
              0.12167501649282841
            ],
            [
              0.9500884175255894,
              0.44386323274542566
            ],
            [
              -0.1513572082976979,
              0.33367432737426683
            ]
          ],
          "group_data": {
            "columns": [
              "A"
            ],
            "groups": [
              {
                "name": [
                  "bar"
                ],
                "labels": [
                  [
                    "bar",
                    "one"
                  ],
                  [
                    "bar",
                    "three"
                  ],
                  [
                    "bar",
                    "two"
                  ]
                ]
              },
              {
                "name": [
                  "foo"
                ],
                "labels": [
                  [
                    "foo",
                    "one"
                  ],
                  [
                    "foo",
                    "two"
                  ],
                  [
                    "foo",
                    "two"
                  ],
                  [
                    "foo",
                    "one"
                  ],
                  [
                    "foo",
                    "three"
                  ]
                ]
              }
            ]
          }
        }
      }
    },
    {
      "type": "GroupByAggCall",
      "code_step": "df2.groupby(level=df2.index.names.difference([\"B\"])).mean()",
      "fragment": {
        "start": {
          "line": 0,
          "ch": 52
        },
        "end": {
          "line": 0,
          "ch": 59
        }
      },
      "marks": [
        {
          "type": "map",
          "from": {
            "type": "axis",
            "anchor": "lhs",
            "select": "row",
            "label": [
              "bar",
              "one"
            ]
          },
          "to": {
            "type": "axis",
            "anchor": "rhs",
            "select": "row",
            "label": "bar"
          }
        },
        {
          "type": "map",
          "from": {
            "type": "axis",
            "anchor": "lhs",
            "select": "row",
            "label": [
              "bar",
              "three"
            ]
          },
          "to": {
            "type": "axis",
            "anchor": "rhs",
            "select": "row",
            "label": "bar"
          }
        },
        {
          "type": "map",
          "from": {
            "type": "axis",
            "anchor": "lhs",
            "select": "row",
            "label": [
              "bar",
              "two"
            ]
          },
          "to": {
            "type": "axis",
            "anchor": "rhs",
            "select": "row",
            "label": "bar"
          }
        },
        {
          "type": "map",
          "from": {
            "type": "axis",
            "anchor": "lhs",
            "select": "row",
            "label": [
              "foo",
              "one"
            ]
          },
          "to": {
            "type": "axis",
            "anchor": "rhs",
            "select": "row",
            "label": "foo"
          }
        },
        {
          "type": "map",
          "from": {
            "type": "axis",
            "anchor": "lhs",
            "select": "row",
            "label": [
              "foo",
              "two"
            ]
          },
          "to": {
            "type": "axis",
            "anchor": "rhs",
            "select": "row",
            "label": "foo"
          }
        },
        {
          "type": "map",
          "from": {
            "type": "axis",
            "anchor": "lhs",
            "select": "row",
            "label": [
              "foo",
              "two"
            ]
          },
          "to": {
            "type": "axis",
            "anchor": "rhs",
            "select": "row",
            "label": "foo"
          }
        },
        {
          "type": "map",
          "from": {
            "type": "axis",
            "anchor": "lhs",
            "select": "row",
            "label": [
              "foo",
              "one"
            ]
          },
          "to": {
            "type": "axis",
            "anchor": "rhs",
            "select": "row",
            "label": "foo"
          }
        },
        {
          "type": "map",
          "from": {
            "type": "axis",
            "anchor": "lhs",
            "select": "row",
            "label": [
              "foo",
              "three"
            ]
          },
          "to": {
            "type": "axis",
            "anchor": "rhs",
            "select": "row",
            "label": "foo"
          }
        }
      ],
      "data": {
        "lhs": "prev_rhs",
        "rhs": {
          "type": "DataFrame",
          "columns": {
            "names": [
              null
            ],
            "labels": [
              "C",
              "D"
            ]
          },
          "index": {
            "names": [
              "A"
            ],
            "labels": [
              "bar",
              "foo"
            ]
          },
          "data": [
            [
              0.55459084256409,
              0.6621823417980587
            ],
            [
              1.0818159058902523,
              0.3158800009268012
            ]
          ]
        }
      }
    }
  ]
}