- test:
    timeout:
      minutes: {{ timeout }}
    definitions:
    - repository: {{ test_definitions }}
{%if device.redirect_to_kmsg %}
      lava-signal: kmsg
{% endif %}
      from: url
      compression: zstd
      path: automated/linux/modules/modules.yaml
      name: modules
      parameters:
{% if parameters.get("MODULES_LIST") %}
        MODULES_LIST: '{{ parameters["MODULES_LIST"] }}'
{% endif %}
{% if parameters.get("MODULES_SUBDIRS") %}
        MODULES_SUBDIRS: '{{ parameters["MODULES_SUBDIRS"] }}'
{% endif %}
        MODULE_MODPROBE_NUMBER: '{{ parameters.get("MODULE_MODPROBE_NUMBER", "1") }}'
        SHARD_NUMBER: {{ parameters.get("SHARD_NUMBER", 1) }}
        SHARD_INDEX: {{ parameters.get("SHARD_INDEX", 1) }}
        MEMORY_TOLERANCE: {{ parameters.get("MEMORY_TOLERANCE", 2048) }}
{% if parameters.get("SKIPLIST") %}
        SKIPLIST: '{{ parameters["SKIPLIST"] }}'
{% endif %}

