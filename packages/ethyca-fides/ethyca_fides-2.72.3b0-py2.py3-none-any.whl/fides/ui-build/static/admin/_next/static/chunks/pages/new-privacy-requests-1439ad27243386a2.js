(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9609],{89987:function(e,r,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/new-privacy-requests",function(){return l(72806)}])},45259:function(e,r,l){"use strict";var s=l(24246),t=l(20595);let a={approved:{color:"success",label:"Approved"},complete:{color:"success",label:"Completed"},awaiting_email_send:{color:"marble",label:"Awaiting Email Send"},denied:{color:"warning",label:"Denied"},canceled:{color:"marble",label:"Canceled"},error:{color:"error",label:"Error"},in_processing:{color:"caution",label:"In Progress"},paused:{color:"marble",label:"Paused"},pending:{color:"info",label:"New"},identity_unverified:{color:"marble",label:"Unverified"},requires_input:{color:"minos",label:"Requires Input"},requires_manual_finalization:{color:"minos",label:"Requires Finalization"}};r.Z=e=>{let{status:r}=e;return(0,s.jsx)(t.j8w,{color:a[r].color,className:"justify-center","data-testid":"request-status-badge",children:a[r].label})}},72806:function(e,r,l){"use strict";l.r(r),l.d(r,{default:function(){return J}});var s=l(24246),t=l(20595),a=l(27378),n=l(25980),i=l(35287),c=l(58754),d=l(19904),o=l(84764),u=l(59676),j=l(40431),p=l(16125),x=l(14048),h=l(47935),m=l(90867),v=l(36942),y=l(9270),g=l(49529),b=l(98855),w=l(27693),f=l.n(w),q=l(39449),_=l(16394);let E=[q.q2.COMPLETE,q.q2.CANCELED,q.q2.DENIED,q.q2.IDENTITY_UNVERIFIED],I=e=>{let{status:r,daysLeft:l,timeframe:a=45}=e;if(!E.includes(r)&&void 0!==l){let e=100*l/a,r="error";return r=e<25?"error":e>=75?"success":"warning",(0,s.jsx)("div",{children:(0,s.jsx)(t.j8w,{color:r,bordered:!1,children:(0,s.jsx)(t.esZ,{title:(0,_.p6)(f()().add(l,"day").toDate()),children:(0,s.jsxs)(s.Fragment,{children:[l," days left"]})})})})}return null};var C=l(86677),N=l(77830),k=l(45259);let R=e=>{let{privacyRequest:r}=e,l=(0,C.useRouter)();return(0,s.jsxs)(t.jqI,{gap:16,wrap:!0,align:"center",children:[(0,s.jsx)("div",{className:"flex min-w-[100px] gap-2",children:(0,s.jsx)(t.AntTypography.Title,{level:3,children:(0,s.jsx)(t.AntTypography.Link,{href:"/privacy-requests/".concat(r.id),variant:"primary",onClick:e=>{e.preventDefault(),l.push({pathname:N.ld,query:{id:r.id}})},copyable:{text:r.id,icon:(0,s.jsx)(t.esZ,{title:"Copy request ID",children:(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(t.PJP.CKM,{})})}),tooltips:null},children:r.policy.name})})}),(0,s.jsx)(k.Z,{status:r.status})]})},A=e=>{let{children:r}=e;return(0,s.jsx)(t.lKn,{type:"secondary",children:r})},P=e=>{let{label:r,children:l}=e;return(0,s.jsxs)(t.jqI,{gap:8,wrap:!0,children:[(0,s.jsxs)(A,{children:[r,":"]}),(0,s.jsx)(t.j8w,{children:l})]})},T=e=>{let{label:r,children:l}=e;return(0,s.jsxs)(t.jqI,{gap:4,wrap:!0,children:[(0,s.jsxs)(A,{children:[r,":"]}),(0,s.jsx)(t.lKn,{children:l})]})},D=e=>{let{value:r}=e;return(null!=r?r:"").length>0?(0,s.jsx)(T,{label:"Email",children:r}):null},S=e=>{let{identities:r}=e;return(0,s.jsx)(s.Fragment,{children:Object.entries(r).filter(e=>{let[r,l]=e;return l.value&&"email"!==r}).map(e=>{let[r,l]=e;return(0,s.jsx)(P,{label:l.label,children:l.value},r)})})};var Z=l(79894),F=l.n(Z);let M=e=>{let{id:r}=e;return(0,s.jsx)(F(),{legacyBehavior:!0,href:"/privacy-requests/".concat(encodeURIComponent(r)),children:(0,s.jsx)(t.esZ,{title:"View privacy request",children:(0,s.jsx)(t.wpx,{icon:(0,s.jsx)(t.PJP.G7x,{}),"aria-label":"View Request",size:"small",href:"/privacy-requests/".concat(encodeURIComponent(r))},"view")})},"view")};var O=l(71784);let U=e=>Array.from(new Set(e.filter(e=>Object.values(q.Us).includes(e.action_type)).map(e=>e.action_type))),z=e=>{let{rules:r}=e;return(0,s.jsx)(s.Fragment,{children:U(r).map(e=>O.rE.get(e)).map(e=>(0,s.jsx)(t.j8w,{children:e},e))})};var K=l(51980);let L=e=>{let{createdAt:r}=e;return(0,s.jsx)(T,{label:"Received",children:(0,s.jsx)(t.lKn,{type:"secondary",children:(0,_.G8)((0,K.B)(new Date(r),new Date,{addSuffix:!0}))})})},G=e=>{var r;let{item:l}=e;return(0,s.jsxs)(t.krs.Item,{children:[(0,s.jsxs)("div",{className:"grow",children:[(0,s.jsx)(R,{privacyRequest:l}),(0,s.jsxs)(t.jqI,{vertical:!0,gap:16,wrap:!0,className:"pt-1",children:[(0,s.jsxs)(t.jqI,{gap:8,wrap:!0,children:[(0,s.jsx)(D,{value:null===(r=l.identity.email)||void 0===r?void 0:r.value}),(0,s.jsx)(z,{rules:l.policy.rules}),(0,s.jsx)(t.j8w,{children:l.source})]}),(0,s.jsx)(t.jqI,{wrap:!0,gap:16,children:(0,s.jsx)(S,{identities:l.identity})})]})]}),(0,s.jsxs)(t.jqI,{gap:16,wrap:!0,className:"pr-2",children:[(0,s.jsx)(L,{createdAt:l.created_at}),(0,s.jsx)(I,{daysLeft:l.days_left,status:l.status,timeframe:l.policy.execution_timeframe})]}),(0,s.jsxs)(t.jqI,{className:"min-w-[125px]",align:"center",justify:"end",gap:8,children:[(0,s.jsx)(M,{id:l.id},"view"),(0,s.jsx)(b.q,{subjectRequest:l},"other-actions")]})]})},Q=()=>{let[e,r]=(0,j.v1)("search",j.Oi.withDefault("").withOptions({throttleMs:100})),l=(0,p.v9)(m.dp),[n,i]=t.Pg3.useMessage(),c=(0,y.S)(),{pageIndex:d,pageSize:o,resetPagination:u}=c,{isOpen:b,onOpen:w,onClose:f}=(0,t.qY0)(),{data:q,isLoading:_,isFetching:E}=(0,m.QA)({...l,page:d,size:o,fuzzy_search_str:e}),{items:I,total:C}=(0,a.useMemo)(()=>q||{items:[],total:0,pages:0},[q]),{downloadReport:N}=(0,g.Z)(),k=(0,a.useCallback)(e=>{r(null!=e?e:""),u()},[u,r]),R=async()=>{let e;try{await N(l)}catch(r){e=r instanceof Error?r.message:"Unknown error occurred"}e&&n.error(e,5e3)};return(0,s.jsxs)("div",{children:[(0,s.jsxs)(h.Q$,{children:[(0,s.jsx)(h.HO,{globalFilter:e,setGlobalFilter:k,placeholder:"Search by request ID or identity value"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(t.wpx,{"data-testid":"filter-btn",onClick:w,children:"Filter"}),(0,s.jsx)(t.wpx,{"aria-label":"Export report","data-testid":"export-btn",icon:(0,s.jsx)(x.nM,{ml:"1.5px"}),onClick:R})]}),(0,s.jsx)(t.h_i,{children:(0,s.jsx)(v.S,{isOpen:b,onClose:f,onFilterChange:u})})]}),_?(0,s.jsx)("div",{className:"border p-2",children:(0,s.jsx)(t.krs,{dataSource:Array(25).fill({}),renderItem:()=>(0,s.jsx)(t.krs.Item,{children:(0,s.jsx)(t.N_L,{})})})}):(0,s.jsxs)(t.jqI,{vertical:!0,gap:"middle",children:[(0,s.jsx)(t.ZJQ,{spinning:E,children:(0,s.jsx)(t.krs,{bordered:!0,dataSource:I,renderItem:e=>(0,s.jsx)(G,{item:e})})}),(0,s.jsx)(t.B7X,{...c.paginationProps,showTotal:(e,r)=>"".concat(r[0],"-").concat(r[1]," of ").concat(e," items"),total:null!=C?C:0,align:"end"})]}),i]})};var V=l(88152),Y=l(72281),B=l(86291),J=()=>{let{processing:e}=(0,V.Y)(),{plus:r}=(0,n.hz)(),{activeTab:l,handleTabChange:j,availableTabs:p}=(0,Y.d)();(0,a.useEffect)(()=>{e()},[e]);let x=(0,a.useMemo)(()=>{let e=[];return p.request&&e.push({key:Y.G.REQUEST,label:"Request",children:(0,s.jsx)(Q,{})}),p.manualTask&&e.push({key:Y.G.MANUAL_TASK,label:"Manual tasks",children:(0,s.jsx)(o.m,{})}),e},[p.manualTask,p.request]);return(0,s.jsxs)(i.Z,{title:"Privacy Requests",children:[(0,s.jsx)(c.Z,{heading:"Privacy Requests",breadcrumbItems:[{title:"All requests"}],rightContent:(0,s.jsxs)(t.vyj,{children:[r&&(0,s.jsx)(d.ZP,{scopes:[q.Sh.PRIVACY_REQUEST_CREATE],children:(0,s.jsx)(B.Z,{})}),(0,s.jsx)(u.default,{})]}),"data-testid":"privacy-requests"}),(0,s.jsx)(t.A5g,{activeKey:l,onChange:j,items:x})]})}}},function(e){e.O(0,[431,8765,2962,7245,8373,6468,9676,2888,9774,179],function(){return e(e.s=89987)}),_N_E=e.O()}]);