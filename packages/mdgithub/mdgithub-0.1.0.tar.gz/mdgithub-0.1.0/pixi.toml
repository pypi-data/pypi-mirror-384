[project]
name = "mdgithub"
version = "0.1.0"
description = "Flatten GitHub repositories into beautiful single HTML pages"
authors = ["llango <724261350@qq.com>"]
channels = ["conda-forge"]
platforms = ["linux-64", "osx-64", "win-64"]
readme = "README.md"
license = "0BSD"
homepage = "https://github.com/llango/mdgithub"
repository = "https://github.com/llango/mdgithub"

[dependencies]
python = ">=3.10"
markdown = ">=3.9,<4"
pygments = ">=2.19.2,<3"

[tasks]
# 运行工具
flatten = "python -m mdgithub"

# 测试
test = "pytest tests/ -v"

# 代码格式化
format = "black mdgithub/ tests/"
lint = "ruff check mdgithub/ tests/"

# 构建包
build = "python -m pip install build && python -m build"
clean = "rm -rf dist/ build/ *.egg-info __pycache__ .pytest_cache mdgithub/__pycache__"

# 发布到 PyPI
publish-test = "python -m twine upload --repository testpypi dist/*"
publish-pypi = "python -m twine upload dist/*"

# 发布到 prefix.dev (conda)
publish-conda = "rattler-build build --recipe recipe/recipe.yaml"

# 完整发布流程（不包含测试，因为还没有测试文件）
release = { cmd = "pixi run clean && pixi run build && pixi run publish-pypi" }

[feature.dev.dependencies]
python = ">=3.10"
pip = "*"
pytest = ">=8.0"
black = ">=24.0"
ruff = ">=0.1.0"
twine = ">=5.0"
setuptools = ">=70.0"
wheel = "*"

[feature.conda.dependencies]
rattler-build = ">=0.13.0"

[environments]
default = []
dev = ["dev"]
conda = ["conda"]