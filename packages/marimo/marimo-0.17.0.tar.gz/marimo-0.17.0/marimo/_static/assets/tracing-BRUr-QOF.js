const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./esm-D8TEQuHf.js","./precisionRound-BLxyDkD7.js","./defaultLocale-DEWTIUVh.js","./linear-Oq5kiZf9.js","./timer-DL6F-lux.js","./chunk-DZLz74EQ.js","./init-F9jkgvKE.js","./src-tKqUT5a0.js","./time-DIhXWsZe.js","./defaultLocale-B9-NA0ur.js","./range-BT9bu4c7.js","./vega-loader.browser.module-B3yPAbRZ.js","./treemap-Bw2ef0_x.js","./path-C9KI-dzZ.js","./colors-vEZNI1u9.js","./ordinal-BpSm2d04.js","./arc-b6bpmWtg.js","./math-C9UoZaXa.js","./array-DAkwBc1M.js","./step-DgNh0Im1.js","./line-BCUKzinT.js","./fast-deep-equal-COY6BKFU.js","./esm-CLNcq-Bu.js","./prop-types-ShpF60yB.js","./react-BcIddLXZ.js","./tslib.es6-C9vXkBtU.js"])))=>i.map(i=>d[i]);
import{s as E}from"./chunk-DZLz74EQ.js";import{i as Q,o as Z,r as D}from"./react-7g8sREeT.js";import{t as ee}from"./react-BcIddLXZ.js";import{G as H,M as te,__tla as re}from"./cells-BEhFXxEH.js";import"./react-dom-D6bRRS5R.js";import"./zod-U2NFpcFA.js";import{n as ie,t as se}from"./jsx-runtime-DvsdsEjx.js";import"./_Uint8Array-D5Z9rM2X.js";import"./isSymbol-xTSywenE.js";import"./_arrayMap-DQI2GUNb.js";import"./toNumber-CTOPJrpu.js";import"./toInteger-Bor4StOs.js";import"./isArrayLikeObject-DKyJYtr8.js";import"./_getTag-CVRrQL_Q.js";import"./_baseIsEqual-BF8660ot.js";import"./merge-BgA7kxZb.js";import"./_baseProperty-CIKnF2iY.js";import"./now-B6JN1xKT.js";import"./debounce-70y9MzDK.js";import"./invariant-B43sqCFA.js";import"./Logger-BkkOJyg0.js";import"./hotkeys-ZAWHeY7d.js";import"./utils-DLuqCLqV.js";import"./constants-Cv7-oioA.js";import"./config-BeIk_wvs.js";import"./dist-CLazWf1X.js";import{t as le}from"./cn-CwmWKpZ_.js";import"./dist-BiHHvE7B.js";import"./useEventListener-g9rPKvBX.js";import"./events-BGfCi1Xy.js";import"./button-g1jf7cM6.js";import"./dist-BNtnpgX8.js";import"./dist-Ct0a8Isf.js";import"./once-4nUTgcVU.js";import"./documentation-B7z6bB-t.js";import"./createReducer-CFr1RdS2.js";import"./requests-BW3DqHQI.js";import{t as oe}from"./preload-helper-DImqtvgl.js";import"./dist-B8v7AWk6.js";import"./dist-D80s9YgJ.js";import"./dist-BFifaB39.js";import"./dist-AWYmVWdt.js";import"./dist-Q2QzNScK.js";import"./dist-Nl79A0iO.js";import"./stex-w1KpyykF.js";import"./Deferred-Mppm0cvJ.js";import"./uuid-4lb_EYpq.js";import"./key-Pb6bybhb.js";import"./use-toast-BKA5A0CC.js";import"./main-CCaZmKLi.js";import"./marked.esm-BB_RKOA5.js";import"./connection-UyRAkvTk.js";import"./dist-CtJ8WONl.js";import{r as ae}from"./useTheme-BWXNjHkw.js";import{t as me}from"./createLucideIcon-Dz-D6iuz.js";import{t as ne}from"./activity-B4sZzt32.js";import{i as pe,n as ce,r as O}from"./CellStatus-Bl5EJmuD.js";import"./type-CYsuWFDa.js";import"./check-CmOWIaur.js";import{_ as de}from"./select-DIqNYEaz.js";import{t as ue}from"./chevron-right-kGH9aJGk.js";import{t as he}from"./circle-play-CV8TLbx8.js";import"./toDate-BNd9AHNi.js";import{t as xe}from"./circle-x-CPCvpiTN.js";import"./ellipsis-i2i-p8XW.js";import"./refresh-cw-CmHE3eNl.js";import"./input-DGY-1Oes.js";import"./workflow-BM8m_XXa.js";import"./useNonce-DvpkYOW9.js";import"./badge-Cbb7s63B.js";import"./namespace-Cw55ynVb.js";import"./dist-DT6vyuIM.js";import{t as q}from"./tooltip-CW-4dtRh.js";import"./useLifecycle-DmdhGVVs.js";import"./menu-items-CE6I2UvI.js";import"./fullscreen-DoREeXhW.js";import"./tslib.es6-C9vXkBtU.js";import"./en-US-D7J6fBFv.js";import"./alert-dialog-DiIW1jDy.js";import"./dialog-gSaRWBIN.js";import"./context-BwP_-Md9.js";import"./useDateFormatter-BapFytxP.js";import"./useNumberFormatter-BQOmTFFk.js";import"./numbers-P4hvbAnW.js";import"./useEvent-itkPNnCe.js";import"./useDebounce-BZnPO5jA.js";import"./ImperativeModal-DSAh6fUR.js";import"./vega-loader.browser.module-B3yPAbRZ.js";import"./precisionRound-BLxyDkD7.js";import"./linear-Oq5kiZf9.js";import{n as fe}from"./src-tKqUT5a0.js";import"./ordinal-BpSm2d04.js";import"./time-DIhXWsZe.js";import"./range-BT9bu4c7.js";import"./defaultLocale-DEWTIUVh.js";import"./defaultLocale-B9-NA0ur.js";import"./filename-dpoTdlj9.js";import{t as ge}from"./cell-link-D8x9Ez3U.js";import{t as ve}from"./bundle.esm-BoludFkg.js";import{t as je}from"./empty-state-DCXB-9l3.js";import"./timer-DL6F-lux.js";import"./multi-icon-Bc23tsjq.js";import{t as ye}from"./clear-button-eoR2rq5r.js";import{n as Ie,t as Se}from"./runs-HEUZUOqh.js";import"./path-C9KI-dzZ.js";import"./math-C9UoZaXa.js";import"./arc-b6bpmWtg.js";import"./array-DAkwBc1M.js";import"./step-DgNh0Im1.js";import"./line-BCUKzinT.js";import"./init-F9jkgvKE.js";import"./colors-vEZNI1u9.js";import"./treemap-Bw2ef0_x.js";let F,w,be=Promise.all([(()=>{try{return re}catch{}})()]).then(async()=>{var V=me("circle-ellipsis",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M17 12h.01",key:"1m0b6t"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M7 12h.01",key:"eqddd0"}]]),T=E(ie()),_=E(ee());const M="hoveredCellId",$="cellHover";var U="cellNum",P="cell",R="startTimestamp",C="endTimestamp",L="status";function A(t,e,r,a){let s="hoursminutessecondsmilliseconds";return{$schema:"https://vega.github.io/schema/vega-lite/v5.json",background:a==="dark"?"black":void 0,mark:{type:"bar",cornerRadius:2},params:[{name:M,bind:{element:`#${e}`}},{name:$,select:{type:"point",on:"mouseover",fields:[P],clear:"mouseout"}}],height:{step:r==="sideBySide"?26:21},encoding:{y:{field:U,scale:{paddingInner:.2},sort:{field:"sortPriority"},title:"cell",axis:r==="sideBySide"?null:void 0},x:{field:R,type:"temporal",axis:{orient:"top",title:null}},x2:{field:C,type:"temporal"},tooltip:[{field:R,type:"temporal",timeUnit:s,title:"Start"},{field:C,type:"temporal",timeUnit:s,title:"End"}],size:{value:{expr:`${M} == toString(datum.${P}) ? 19.5 : 18`}},color:{field:L,scale:{domain:["success","error"],range:["#37BE5F","red"]},legend:null}},data:{values:t},transform:[{calculate:`datum.${L} === 'queued' ? 9999999999999 : datum.${R}`,as:"sortPriority"}],config:{view:{stroke:"transparent"}}}}var i=E(se()),z=Z(new Map);F=()=>{let t=(0,T.c)(28),{runIds:e,runMap:r}=D(Se),a=D(z),{clearRuns:s}=Ie(),{theme:o}=ae(),[l,v]=(0,_.useState)("above"),m;t[0]===l?m=t[1]:(m=()=>{v(l==="above"?"sideBySide":"above")},t[0]=l,t[1]=m);let h=m;if(e.length===0){let u;return t[2]===Symbol.for("react.memo_cache_sentinel")?(u=(0,i.jsx)(je,{title:"No traces",description:(0,i.jsx)("span",{children:"Cells that have ran will appear here."}),icon:(0,i.jsx)(ne,{})}),t[2]=u):u=t[2],u}let d;t[3]===Symbol.for("react.memo_cache_sentinel")?(d=(0,i.jsx)("label",{htmlFor:"chartPosition",className:"text-xs",children:"Inline chart"}),t[3]=d):d=t[3];let p=l==="sideBySide",x;t[4]!==p||t[5]!==h?(x=(0,i.jsxs)("div",{className:"flex flex-row gap-1 items-center",children:[d,(0,i.jsx)("input",{type:"checkbox",name:"chartPosition","data-testid":"chartPosition",onClick:h,defaultChecked:p,className:"h-3 cursor-pointer"})]}),t[4]=p,t[5]=h,t[6]=x):x=t[6];let c;t[7]===s?c=t[8]:(c=(0,i.jsx)(ye,{dataTestId:"clear-traces-button",onClick:s}),t[7]=s,t[8]=c);let j;t[9]!==x||t[10]!==c?(j=(0,i.jsxs)("div",{className:"flex flex-row justify-end gap-3",children:[x,c]}),t[9]=x,t[10]=c,t[11]=j):j=t[11];let f;if(t[12]!==l||t[13]!==a||t[14]!==e||t[15]!==r||t[16]!==o){let u;t[18]!==l||t[19]!==a||t[20]!==r||t[21]!==o?(u=(I,n)=>{let S=r.get(I);if(S)return(0,i.jsx)(Y,{run:S,isExpanded:a.get(S.runId),isMostRecentRun:n===0,chartPosition:l,theme:o},S.runId)},t[18]=l,t[19]=a,t[20]=r,t[21]=o,t[22]=u):u=t[22],f=e.map(u),t[12]=l,t[13]=a,t[14]=e,t[15]=r,t[16]=o,t[17]=f}else f=t[17];let g;t[23]===f?g=t[24]:(g=(0,i.jsx)("div",{className:"flex flex-col gap-3",children:f}),t[23]=f,t[24]=g);let y;return t[25]!==j||t[26]!==g?(y=(0,i.jsxs)("div",{className:"py-1 px-2 overflow-y-scroll",children:[j,g]}),t[25]=j,t[26]=g,t[27]=y):y=t[27],y};var G=_.lazy(()=>oe(()=>import("./esm-D8TEQuHf.js").then(async t=>(await t.__tla,t)),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]),import.meta.url).then(t=>({default:t.Vega}))),B=t=>{let e=(0,T.c)(10),{ref:r,width:a}=ve(),s=a===void 0?300:a,o=t.theme==="dark"?"dark":void 0,l=s-50,v;e[0]!==t.height||e[1]!==t.signalListeners||e[2]!==t.vegaSpec||e[3]!==o||e[4]!==l?(v=(0,i.jsx)(_.Suspense,{children:(0,i.jsx)(G,{spec:t.vegaSpec,theme:o,width:l,height:t.height,signalListeners:t.signalListeners,actions:!1})}),e[0]=t.height,e[1]=t.signalListeners,e[2]=t.vegaSpec,e[3]=o,e[4]=l,e[5]=v):v=e[5];let m;return e[6]!==t.className||e[7]!==r||e[8]!==v?(m=(0,i.jsx)("div",{className:t.className,ref:r,children:v}),e[6]=t.className,e[7]=r,e[8]=v,e[9]=m):m=e[9],m},Y=({run:t,isMostRecentRun:e,chartPosition:r,isExpanded:a,theme:s})=>{let o=Q(z);a??(a=e);let l=()=>{o(h=>{let d=new Map(h);return d.set(t.runId,!a),d})},v=(0,i.jsx)(a?de:ue,{height:16,className:"inline"}),m=(0,i.jsxs)("span",{className:"text-sm cursor-pointer",onClick:l,children:["Run - ",H(t.runStartTime),v]});return a?(0,i.jsx)(J,{run:t,chartPosition:r,theme:s,title:m},t.runId):(0,i.jsx)("div",{className:"flex flex-col",children:(0,i.jsx)("pre",{className:"font-mono font-semibold",children:m})},t.runId)},J=t=>{let e=(0,T.c)(32),{run:r,chartPosition:a,theme:s,title:o}=t,[l,v]=(0,_.useState)(),m;e[0]===Symbol.for("react.memo_cache_sentinel")?(m={[$]:(I,n)=>{var b;let S=(b=n.cell)==null?void 0:b[0];v(S??null)}},e[0]=m):m=e[0];let h=m,d=te(),p,x;if(e[1]!==d||e[2]!==a||e[3]!==r.cellRuns||e[4]!==r.runId||e[5]!==s){let I=[...r.cellRuns.values()].map(n=>{let S=n.elapsedTime??0;return{cell:n.cellId,cellNum:d.inOrderIds.indexOf(n.cellId),startTimestamp:w(n.startTime),endTimestamp:w(n.startTime+S),elapsedTime:O(S*1e3),status:n.status}});p=`hiddenInputElement-${r.runId}`,x=fe(A(I,p,a,s)),e[1]=d,e[2]=a,e[3]=r.cellRuns,e[4]=r.runId,e[5]=s,e[6]=p,e[7]=x}else p=e[6],x=e[7];let c=x.spec,j;e[8]!==p||e[9]!==l||e[10]!==r?(j=(0,i.jsx)(K,{run:r,hoveredCellId:l,hiddenInputElementId:p}),e[8]=p,e[9]=l,e[10]=r,e[11]=j):j=e[11];let f=j;if(a==="above"){let I;e[12]!==s||e[13]!==c?(I=(0,i.jsx)(B,{vegaSpec:c,height:120,signalListeners:h,theme:s}),e[12]=s,e[13]=c,e[14]=I):I=e[14];let n;e[15]!==I||e[16]!==o||e[17]!==f?(n=(0,i.jsxs)("pre",{className:"font-mono font-semibold",children:[o,I,f]}),e[15]=I,e[16]=o,e[17]=f,e[18]=n):n=e[18];let S;return e[19]!==r.runId||e[20]!==n?(S=(0,i.jsx)("div",{className:"flex flex-col",children:n},r.runId),e[19]=r.runId,e[20]=n,e[21]=S):S=e[21],S}let g;e[22]!==o||e[23]!==f?(g=(0,i.jsxs)("pre",{className:"font-mono font-semibold",children:[o,f]}),e[22]=o,e[23]=f,e[24]=g):g=e[24];let y;e[25]!==s||e[26]!==c?(y=(0,i.jsx)(B,{className:"-mt-0.5 flex-1",vegaSpec:c,height:100,signalListeners:h,theme:s}),e[25]=s,e[26]=c,e[27]=y):y=e[27];let u;return e[28]!==r.runId||e[29]!==g||e[30]!==y?(u=(0,i.jsxs)("div",{className:"flex flex-row",children:[g,y]},r.runId),e[28]=r.runId,e[29]=g,e[30]=y,e[31]=u):u=e[31],u},K=t=>{let e=(0,T.c)(12),{run:r,hoveredCellId:a,hiddenInputElementId:s}=t,o=(0,_.useRef)(null),l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=c=>{o.current&&(o.current.value=String(c),o.current.dispatchEvent(new Event("input",{bubbles:!0})))},e[0]=l):l=e[0];let v=l,m=a||"",h;e[1]!==s||e[2]!==m?(h=(0,i.jsx)("input",{type:"text",id:s,defaultValue:m,hidden:!0,ref:o}),e[1]=s,e[2]=m,e[3]=h):h=e[3];let d;e[4]===r.cellRuns?d=e[5]:(d=[...r.cellRuns.values()],e[4]=r.cellRuns,e[5]=d);let p;e[6]!==a||e[7]!==d?(p=d.map(c=>(0,i.jsx)(X,{cellRun:c,hovered:c.cellId===a,dispatchHoverEvent:v},c.cellId)),e[6]=a,e[7]=d,e[8]=p):p=e[8];let x;return e[9]!==h||e[10]!==p?(x=(0,i.jsxs)("div",{className:"text-xs mt-0.5 ml-3 flex flex-col gap-0.5",children:[h,p]}),e[9]=h,e[10]=p,e[11]=x):x=e[11],x},W={success:(0,i.jsx)(pe,{color:"green",size:14}),running:(0,i.jsx)(he,{color:"var(--blue-10)",size:14}),error:(0,i.jsx)(xe,{color:"red",size:14}),queued:(0,i.jsx)(V,{color:"grey",size:14})},X=t=>{let e=(0,T.c)(39),{cellRun:r,hovered:a,dispatchHoverEvent:s}=t,o;e[0]===r.elapsedTime?o=e[1]:(o=r.elapsedTime?O(r.elapsedTime*1e3):"-",e[0]=r.elapsedTime,e[1]=o);let l=o,v;e[2]!==r.elapsedTime||e[3]!==l?(v=r.elapsedTime?(0,i.jsxs)("span",{children:["This cell took ",(0,i.jsx)(ce,{elapsedTime:l})," to run"]}):(0,i.jsx)("span",{children:"This cell has not been run"}),e[2]=r.elapsedTime,e[3]=l,e[4]=v):v=e[4];let m=v,h;e[5]!==r.cellId||e[6]!==s?(h=()=>{s(r.cellId)},e[5]=r.cellId,e[6]=s,e[7]=h):h=e[7];let d=h,p;e[8]===s?p=e[9]:(p=()=>{s(null)},e[8]=s,e[9]=p);let x=p,c=a&&"bg-(--gray-3) opacity-100",j;e[10]===c?j=e[11]:(j=le("flex flex-row gap-2 py-1 px-1 opacity-70 hover:bg-(--gray-3) hover:opacity-100",c),e[10]=c,e[11]=j);let f;e[12]===r.startTime?f=e[13]:(f=H(r.startTime),e[12]=r.startTime,e[13]=f);let g;e[14]===f?g=e[15]:(g=(0,i.jsxs)("span",{className:"text-(--gray-10) dark:text-(--gray-11)",children:["[",f,"]"]}),e[14]=f,e[15]=g);let y;e[16]===r.cellId?y=e[17]:(y=(0,i.jsxs)("span",{className:"text-(--gray-10) w-16",children:["(",(0,i.jsx)(ge,{cellId:r.cellId}),")"]}),e[16]=r.cellId,e[17]=y);let u;e[18]===r.code?u=e[19]:(u=(0,i.jsx)("span",{className:"w-40 truncate -ml-1",children:r.code}),e[18]=r.code,e[19]=u);let I;e[20]===l?I=e[21]:(I=(0,i.jsx)("span",{className:"text-(--gray-10) dark:text-(--gray-11)",children:l}),e[20]=l,e[21]=I);let n;e[22]!==m||e[23]!==I?(n=(0,i.jsx)(q,{content:m,children:I}),e[22]=m,e[23]=I,e[24]=n):n=e[24];let S=W[r.status],b;e[25]!==r.status||e[26]!==S?(b=(0,i.jsx)(q,{content:r.status,children:S}),e[25]=r.status,e[26]=S,e[27]=b):b=e[27];let N;e[28]!==n||e[29]!==b?(N=(0,i.jsxs)("div",{className:"flex flex-row gap-1 w-16 justify-end -ml-2",children:[n,b]}),e[28]=n,e[29]=b,e[30]=N):N=e[30];let k;return e[31]!==d||e[32]!==x||e[33]!==u||e[34]!==N||e[35]!==j||e[36]!==g||e[37]!==y?(k=(0,i.jsxs)("div",{className:j,onMouseEnter:d,onMouseLeave:x,children:[g,y,u,N]}),e[31]=d,e[32]=x,e[33]=u,e[34]=N,e[35]=j,e[36]=g,e[37]=y,e[38]=k):k=e[38],k};w=function(t){try{let e=new Date(t*1e3);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}.${String(e.getMilliseconds()).padStart(3,"0")}`}catch{return""}}});export{F as Tracing,be as __tla,w as formatChartTime};
