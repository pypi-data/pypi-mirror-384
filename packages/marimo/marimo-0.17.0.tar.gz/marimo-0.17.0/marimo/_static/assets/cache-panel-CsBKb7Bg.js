import{s as P}from"./chunk-DZLz74EQ.js";import{r as O}from"./react-7g8sREeT.js";import{t as A}from"./react-BcIddLXZ.js";import"./react-dom-D6bRRS5R.js";import{n as B,t as R}from"./jsx-runtime-DvsdsEjx.js";import"./_Uint8Array-D5Z9rM2X.js";import"./_getTag-CVRrQL_Q.js";import"./_baseIsEqual-BF8660ot.js";import"./invariant-B43sqCFA.js";import"./Logger-BkkOJyg0.js";import"./hotkeys-ZAWHeY7d.js";import"./dist-CLazWf1X.js";import{t as G}from"./cn-CwmWKpZ_.js";import"./dist-BiHHvE7B.js";import"./useEventListener-g9rPKvBX.js";import"./events-BGfCi1Xy.js";import{t as S}from"./button-g1jf7cM6.js";import"./once-4nUTgcVU.js";import{r as H}from"./requests-BW3DqHQI.js";import{t as _}from"./use-toast-BKA5A0CC.js";import"./createLucideIcon-Dz-D6iuz.js";import{t as F}from"./database-zap-CI8EPzsS.js";import{t as z}from"./spinner-fS9J74Ro.js";import{t as D}from"./refresh-cw-CmHE3eNl.js";import{t as K}from"./trash-2-Cex53SxB.js";import"./namespace-Cw55ynVb.js";import"./fullscreen-DoREeXhW.js";import"./tslib.es6-C9vXkBtU.js";import{a as q,c as J,i as Q,l as U,n as V,o as W,r as X,s as Y,t as Z,u as ee}from"./alert-dialog-DiIW1jDy.js";import{t as se}from"./context-BwP_-Md9.js";import{r as d}from"./numbers-P4hvbAnW.js";import"./useEvent-itkPNnCe.js";import{n as te}from"./useAsyncData-BB0ZlY9B.js";import{t as E}from"./empty-state-DCXB-9l3.js";import{t as ie}from"./requests-B9bjL3qq.js";var re=P(B()),I=P(A()),s=P(R());const ae=r=>{let e=(0,re.c)(27),{children:t,title:l,description:a,onConfirm:i,confirmText:n,cancelText:o,destructive:c}=r,y=n===void 0?"Continue":n,f=o===void 0?"Cancel":o,u=c===void 0?!1:c,[j,k]=I.useState(!1),p;e[0]===i?p=e[1]:(p=()=>{i(),k(!1)},e[0]=i,e[1]=p);let v=p,h=u?W:V,x;e[2]===t?x=e[3]:(x=(0,s.jsx)(ee,{asChild:!0,children:t}),e[2]=t,e[3]=x);let m;e[4]===l?m=e[5]:(m=(0,s.jsx)(U,{children:l}),e[4]=l,e[5]=m);let g;e[6]===a?g=e[7]:(g=(0,s.jsx)(q,{children:a}),e[6]=a,e[7]=g);let N;e[8]!==m||e[9]!==g?(N=(0,s.jsxs)(J,{children:[m,g]}),e[8]=m,e[9]=g,e[10]=N):N=e[10];let b;e[11]===f?b=e[12]:(b=(0,s.jsx)(X,{children:f}),e[11]=f,e[12]=b);let C;e[13]!==h||e[14]!==y||e[15]!==v?(C=(0,s.jsx)(h,{onClick:v,children:y}),e[13]=h,e[14]=y,e[15]=v,e[16]=C):C=e[16];let w;e[17]!==C||e[18]!==b?(w=(0,s.jsxs)(Y,{children:[b,C]}),e[17]=C,e[18]=b,e[19]=w):w=e[19];let $;e[20]!==w||e[21]!==N?($=(0,s.jsxs)(Q,{children:[N,w]}),e[20]=w,e[21]=N,e[22]=$):$=e[22];let M;return e[23]!==j||e[24]!==$||e[25]!==x?(M=(0,s.jsxs)(Z,{open:j,onOpenChange:k,children:[x,$]}),e[23]=j,e[24]=$,e[25]=x,e[26]=M):M=e[26],M};function L(r,e){if(r===0||r===-1)return"0 B";let t=1024,l=["B","KB","MB","GB","TB"],a=Math.floor(Math.log(r)/Math.log(t));return`${d(r/t**a,e)} ${l[a]}`}function le(r,e){if(r===0)return"0s";if(r<.001)return`${d(r*1e6,e)}\xB5s`;if(r<1)return`${d(r*1e3,e)}ms`;if(r<60)return`${d(r,e)}s`;let t=Math.floor(r/60),l=r%60;if(t<60)return l>0?`${t}m ${d(l,e)}s`:`${t}m`;let a=Math.floor(t/60),i=t%60;return i>0?`${a}h ${i}m`:`${a}h`}var oe=P(B()),ne=()=>{let{clearCache:r,getCacheInfo:e}=H(),t=O(ie),[l,a]=(0,I.useState)(!1),{locale:i}=se(),{isPending:n,isFetching:o,refetch:c}=te(async()=>{await e(),await new Promise(m=>setTimeout(m,500))},[]),y=async()=>{try{a(!0),await r(),_({title:"Cache purged",description:"All cached data has been cleared"}),c()}catch(m){_({title:"Error",description:m instanceof Error?m.message:"Failed to purge cache",variant:"danger"})}finally{a(!1)}};if(n&&!t)return(0,s.jsx)(z,{size:"medium",centered:!0});let f=(0,s.jsxs)(S,{variant:"outline",size:"sm",onClick:c,disabled:o,children:[o?(0,s.jsx)(z,{size:"small",className:"w-4 h-4 mr-2"}):(0,s.jsx)(D,{className:"w-4 h-4 mr-2"}),"Refresh"]});if(!t)return(0,s.jsx)(E,{title:"No cache data",description:"Cache information is not available.",icon:(0,s.jsx)(F,{}),action:f});let u=t.hits,j=t.misses,k=t.time,p=t.disk_total,v=t.disk_to_free,h=u+j,x=h>0?u/h*100:0;return h===0?(0,s.jsx)(E,{title:"No cache activity",description:"The cache has not been used yet. Cached functions will appear here once they are executed.",icon:(0,s.jsx)(F,{}),action:f}):(0,s.jsx)("div",{className:"flex flex-col h-full overflow-auto",children:(0,s.jsxs)("div",{className:"flex flex-col gap-4 p-4 h-full",children:[(0,s.jsx)("div",{className:"flex items-center justify-end",children:(0,s.jsx)(S,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:c,disabled:o,children:(0,s.jsx)(D,{className:G("h-4 w-4 text-muted-foreground hover:text-foreground",o&&"animate-[spin_0.5s]")})})}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-foreground",children:"Statistics"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsx)(T,{label:"Time saved",value:le(k,i),description:"Total execution time saved"}),(0,s.jsx)(T,{label:"Hit rate",value:h>0?`${d(x,i)}%`:"\u2014",description:`${d(u,i)} hits / ${d(h,i)} total`}),(0,s.jsx)(T,{label:"Cache hits",value:d(u,i),description:"Successful cache retrievals"}),(0,s.jsx)(T,{label:"Cache misses",value:d(j,i),description:"Cache not found"})]})]}),p>0&&(0,s.jsxs)("div",{className:"space-y-3 pt-2 border-t",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-foreground",children:"Storage"}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-3",children:(0,s.jsx)(T,{label:"Disk usage",value:L(p,i),description:v>0?`${L(v,i)} can be freed`:"Cache storage on disk"})})]}),(0,s.jsx)("div",{className:"my-auto"}),(0,s.jsx)("div",{className:"pt-2 border-t",children:(0,s.jsx)(ae,{title:"Purge cache?",description:"This will permanently delete all cached data. This action cannot be undone.",confirmText:"Purge",destructive:!0,onConfirm:y,children:(0,s.jsxs)(S,{variant:"outlineDestructive",size:"xs",disabled:l,className:"w-full",children:[l?(0,s.jsx)(z,{size:"small",className:"w-3 h-3 mr-2"}):(0,s.jsx)(K,{className:"w-3 h-3 mr-2"}),"Purge Cache"]})})})]})})},T=r=>{let e=(0,oe.c)(10),{label:t,value:l,description:a}=r,i;e[0]===t?i=e[1]:(i=(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:t}),e[0]=t,e[1]=i);let n;e[2]===l?n=e[3]:(n=(0,s.jsx)("span",{className:"text-lg font-semibold",children:l}),e[2]=l,e[3]=n);let o;e[4]===a?o=e[5]:(o=a&&(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:a}),e[4]=a,e[5]=o);let c;return e[6]!==i||e[7]!==n||e[8]!==o?(c=(0,s.jsxs)("div",{className:"flex flex-col gap-1 p-3 rounded-lg border bg-card",children:[i,n,o]}),e[6]=i,e[7]=n,e[8]=o,e[9]=c):c=e[9],c},ce=ne;export{ce as default};
